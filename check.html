<!DOCTYPE HTML SYSTEM>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Brakeman Report</title>
  <script>
    function toggle(context) {
      var elem = document.getElementById(context);

      if (elem.style.display != "block")
        elem.style.display = "block";
      else
        elem.style.display = "none";
        
      elem.parentNode.scrollIntoView();
    }
  </script>
  <style>
    /* CSS style used for HTML reports */

body {
  font-family: sans-serif;
  color: #161616;
}

a {
  color: #161616;
}

p {
  font-weight: bold;
  font-size: 11pt;
  color: #2D0200;
 }

 th {
   background-color: #980905;
   border-bottom: 5px solid #530200;
   color: white;
   font-size: 11pt;
   padding: 1px 8px 1px 8px;
 }

 td {
   border-bottom: 2px solid white;
   font-family: monospace;
   padding: 5px 8px 1px 8px;
 }

 table {
   background-color: #FCF4D4;
   border-collapse: collapse;
 }

 h1 {
   color: #2D0200;
   font-size: 14pt;
 }

 h2 {
   color: #2D0200;
   font-size: 12pt;
 }

 span.high-confidence {
   font-weight:bold;
   color: red;
 }

 span.med-confidence {
 }

 span.weak-confidence {
   color:gray;
 }

 div.warning_message {
   cursor: pointer;
 }

 div.warning_message:hover {
   background-color: white;
 }

 table caption {
   background-color: #FFE;
   padding: 2px;
 }

 table.context {
   margin-top: 5px;
   margin-bottom: 5px;
   border-left: 1px solid #90e960;
   color: #212121;
 }

 tr.context {
   background-color: white;
 }

 tr.first {
   border-top: 1px solid #7ecc54;
   padding-top: 2px;
 }

 tr.error {
  background-color: #f4c1c1 !important
 }

 tr.near_error {
  background-color: #f4d4d4 !important
 }

 tr.alt {
   background-color: #e8f4d4;
 }

 td.context {
   padding: 2px 10px 0px 6px;
   border-bottom: none;
 }

 td.context_line {
   padding: 2px 8px 0px 7px;
   border-right: 1px solid #b3bda4;
   border-bottom: none;
   color: #6e7465;
 }

 pre.context {
   margin-bottom: 1px;
 }

 .user_input {
   background-color: #fcecab;
 }

 div.render_path {
   display: none;
   background-color: #ffe;
   padding: 5px;
   margin: 2px 0px 2px 0px;
 }

 div.template_name {
   cursor: pointer;
 }

 div.template_name:hover {
   background-color: white;
 }

  </style>
</head>
<body>

<h1>Brakeman Report</h1>
<table>
  <tr>
    <th>Application Path</th>
    <th>Rails Version</th>
    <th>Brakeman Version</th>
    <th>Report Time</th>
    <th>Checks Performed</th>
  </tr>
  <tr>
    <td>/Users/raymond/Sites/vdiamond</td>
    <td>1.2.2</td>
    <td>1.9.1
    <td>
      2013-02-10 02:01:13 +0800<br><br>
      151.620725 seconds
    </td>
    <td>BasicAuth, ContentTag, CrossSiteScripting, DefaultRoutes, DigestDoS, EscapeFunction, Evaluation, Execute, FileAccess, FilterSkipping, ForgerySetting, LinkTo, LinkToHref, MailTo, MassAssignment, ModelAttributes, NestedAttributes, QuoteTableName, Redirect, Render, ResponseSplitting, SQL, SafeBufferManipulation, SelectTag, SelectVulnerability, Send, SendFile, SessionSettings, SingleQuotes, SkipBeforeFilter, StripTags, TranslateBug, ValidationRegex, WithoutProtection, YAMLLoad, YAMLParsing</td>
  </tr>
</table>
<br>
<h2 id='summary'>Summary</h2> 
<table>
  <tr>
    <th>Scanned/Reported</th>
    <th>Total</th>
  </tr>
  <tr>
    <td>Controllers</td>
    <td>60</td>
  </tr>
  <tr>
    <td>Models</td>
    <td>72</td>
  </tr>
  <tr>
    <td>Templates</td>
    <td>529</td>
  </tr>
  <tr>
    <td>Errors</td>
    <td>7</td>
  </tr>
  <tr>
    <td>Security Warnings</td>
    <td>493 <span class='high-confidence'>(235)</span></td>
  </tr>
</table>
<br>
<table>
  <tr>
    <th>Warning Type</th>
    <th>Total</th>
  </tr>
  
  <tr>
    <td>Attribute Restriction</td>
    <td>1</td>
  </tr>
  
  <tr>
    <td>Cross Site Scripting</td>
    <td>245</td>
  </tr>
  
  <tr>
    <td>Cross-Site Request Forgery</td>
    <td>1</td>
  </tr>
  
  <tr>
    <td>Dangerous Eval</td>
    <td>5</td>
  </tr>
  
  <tr>
    <td>Default Routes</td>
    <td>1</td>
  </tr>
  
  <tr>
    <td>Dynamic Render Path</td>
    <td>2</td>
  </tr>
  
  <tr>
    <td>File Access</td>
    <td>3</td>
  </tr>
  
  <tr>
    <td>Format Validation</td>
    <td>1</td>
  </tr>
  
  <tr>
    <td>Mass Assignment</td>
    <td>165</td>
  </tr>
  
  <tr>
    <td>Redirect</td>
    <td>40</td>
  </tr>
  
  <tr>
    <td>Remote Code Execution</td>
    <td>1</td>
  </tr>
  
  <tr>
    <td>SQL Injection</td>
    <td>28</td>
  </tr>
  
</table>
<br>
<div onClick="toggle('errors_table');">  <h2>Exceptions raised during the analysis (click to see them)</h2 ></div> <div id='errors_table' style='display:none'> 
<table>
  <tr>
    <th>Error</th>
    <th>Location</th>
  </tr>

  <tr>
    <td>(string):651 :: parse error on value [&quot;__ENCODING__&quot;, 651] (error)</td>
    <td>
      
        could not parse /Users/raymond/Sites/vdiamond/app/views/fixedprice_jobs/show.rhtml
      
    </td>
  </tr>

  <tr>
    <td>(string):22 :: parse error on value [&quot;__ENCODING__&quot;, 22] (error)</td>
    <td>
      
        could not parse /Users/raymond/Sites/vdiamond/app/views/job_custom_services/_fields.rhtml
      
    </td>
  </tr>

  <tr>
    <td>(string):26 :: parse error on value [&quot;__ENCODING__&quot;, 26] (error)</td>
    <td>
      
        could not parse /Users/raymond/Sites/vdiamond/app/views/job_custom_services/_fields_template.rhtml
      
    </td>
  </tr>

  <tr>
    <td>(string):675 :: parse error on value [&quot;__ENCODING__&quot;, 675] (error)</td>
    <td>
      
        could not parse /Users/raymond/Sites/vdiamond/app/views/jobs/show.rhtml
      
    </td>
  </tr>

  <tr>
    <td>(string):5 :: parse error on value &quot;)&quot; (tRPAREN)</td>
    <td>
      
        could not parse /Users/raymond/Sites/vdiamond/app/views/leads/close_window.rhtml
      
    </td>
  </tr>

  <tr>
    <td>(string):671 :: parse error on value [&quot;__ENCODING__&quot;, 671] (error)</td>
    <td>
      
        could not parse /Users/raymond/Sites/vdiamond/app/views/misc_jobs/show.rhtml
      
    </td>
  </tr>

  <tr>
    <td>(string):8 :: parse error on value [&quot;else&quot;, 8] (kELSE)</td>
    <td>
      
        could not parse /Users/raymond/Sites/vdiamond/app/views/tasks/_task_form_for_SendemailTask.rhtml
      
    </td>
  </tr>

</table>
</div>
<h2>Security Warnings</h2>  
<table>

  <tr>
    <th>Confidence</th>
    <th>Class</th>
    <th>Method</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ConfigurablesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/dangerous_eval/">Dangerous Eval</a></td>
    <td><div class='warning_message' onClick="toggle('context2');toggle('message2');toggle('full_message2')" >User input in eval near line 95: eval(<span class="user_input">params[&quot;stringified_hash&quot;]</span>)<table id='context2' class='context' style='display:none'><caption>app/controllers/configurables_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>90</pre>
          </td>
          <td class='context'>
            <pre class='context'>      #breakpoint &quot;check @configurable&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #raise &quot;stop&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #raise &quot;should be in the else&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>      begin</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>        result = eval(params['stringified_hash'])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rescue Exception =&gt; e</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'check your syntax'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to :action =&gt; 'edit', :id =&gt; params[:id], :hashstring =&gt; params['configurable']['stringified_hash'] and return</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @configurable.stringified_hash = params['stringified_hash']</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ImportJob</td>
    <td>validate_my_csv_file</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/dangerous_eval/">Dangerous Eval</a></td>
    <td><div class='warning_message' onClick="toggle('context5');toggle('message5');toggle('full_message5')" ><span id='message5' style='display:block' >User input in eval near line 179: eval(((&quot;(&quot; + ImportJob.condition_from_required_fields(ImportJob.req...</span><span id='full_message5' style='display:none'>User input in eval near line 179: eval(((&quot;(&quot; + <span class="user_input">ImportJob.condition_from_required_fields(ImportJob.required_csv_fields(target_class), &quot;header&quot;)</span>) + &quot;)&quot;))</span><table id='context5' class='context' style='display:none'><caption>app/models/import_job.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>174</pre>
          </td>
          <td class='context'>
            <pre class='context'>    puts &quot;header.class = &quot;+header.class.to_s</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>175</pre>
            </td>
            <td class='context'>
              <pre class='context'>    conditionstring = ImportJob.condition_from_required_fields(reqs, 'header' )</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>177</pre>
            </td>
            <td class='context'>
              <pre class='context'>    puts &quot;conditionstring = &quot;+conditionstring</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>179</pre>
            </td>
            <td class='context'>
              <pre class='context'>    valid = eval(&quot;(&quot;+conditionstring+&quot;)&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>181</pre>
            </td>
            <td class='context'>
              <pre class='context'>    return valid</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ImportJob</td>
    <td>validate_my_csv_file</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/dangerous_eval/">Dangerous Eval</a></td>
    <td><div class='warning_message' onClick="toggle('context6');toggle('message6');toggle('full_message6')" ><span id='message6' style='display:block' >User input in eval near line 181: eval(((&quot;(&quot; + ImportJob.condition_from_required_fields(ImportJob.req...</span><span id='full_message6' style='display:none'>User input in eval near line 181: eval(((&quot;(&quot; + <span class="user_input">ImportJob.condition_from_required_fields(ImportJob.required_csv_fields(target_class), &quot;header&quot;)</span>) + &quot;)&quot;))</span><table id='context6' class='context' style='display:none'><caption>app/models/import_job.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>177</pre>
          </td>
          <td class='context'>
            <pre class='context'>    puts &quot;conditionstring = &quot;+conditionstring</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>179</pre>
            </td>
            <td class='context'>
              <pre class='context'>    valid = eval(&quot;(&quot;+conditionstring+&quot;)&quot;)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>181</pre>
            </td>
            <td class='context'>
              <pre class='context'>    return valid</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def self.get_csv_header(path)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>    file = File.open(path, 'r+')</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>revert_lead_attributes</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/dangerous_eval/">Dangerous Eval</a></td>
    <td><div class='warning_message' onClick="toggle('context3');toggle('message3');toggle('full_message3')" >User input in eval near line 284: eval(<span class="user_input">params[:old_attributes_stringified]</span>)<table id='context3' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>279</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>281</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def revert_lead_attributes</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>283</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead = Lead.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>284</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead.update_attributes(eval(params[:old_attributes_stringified]))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>285</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>287</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to :action =&gt; 'show', :id =&gt; @lead.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>289</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/dangerous_eval/">Dangerous Eval</a></td>
    <td><div class='warning_message' onClick="toggle('context4');toggle('message4');toggle('full_message4')" >User input in eval near line 306: eval(<span class="user_input">params[:new_values_stringified]</span>)<table id='context4' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>301</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @event_for_form = session[:pending_event] if session[:pending_event]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>303</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @old_attributes_stringified = Configurable.hash_to_string(@lead.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>305</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if params[:new_values_stringified]</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>306</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(eval(params[:new_values_stringified]))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>307</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>309</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @unable_to_quote = false</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>310</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @quotes = @lead.quotes</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>311</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @quote = @quotes.first</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td></td>
    <td></td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/default_routes/">Default Routes</a></td>
    <td><div class='warning_message' onClick="toggle('context1');toggle('message1');toggle('full_message1')" >All public methods in controllers are available as actions in routes.rb near line 199<table id='context1' class='context' style='display:none'><caption>config/routes.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>194</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # added by LG on 4-8-07</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>195</pre>
            </td>
            <td class='context'>
              <pre class='context'>#  map.connect 'extractors/:extractor_id/extractor_elements/:action'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>197</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # Install the default route as the lowest priority.</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>198</pre>
            </td>
            <td class='context'>
              <pre class='context'>  map.connect ':controller/:action/:id.:format'</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>199</pre>
            </td>
            <td class='context'>
              <pre class='context'>  map.connect ':controller/:action/:id'</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>200</pre>
            </td>
            <td class='context'>
              <pre class='context'>  map.connect 'job_descriptions', :controller =&gt; 'job_descriptions', :action =&gt; 'index'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>203</pre>
            </td>
            <td class='context'>
              <pre class='context'>end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>EmailAttachmentsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
    <td><div class='warning_message' onClick="toggle('context7');toggle('message7');toggle('full_message7')" ><span id='message7' style='display:block' >Model attribute value used in file name near line 44: File.new(((RAILS_ROOT + &quot;/public/attachment_fil...</span><span id='full_message7' style='display:none'>Model attribute value used in file name near line 44: File.new(((RAILS_ROOT + &quot;/public/attachment_files/&quot;) + <span class="user_input">EmailAttachment.new(params[:email_attachment]).smart_filename(params[:attachment_file])</span>), &quot;wb&quot;)</span><table id='context7' class='context' style='display:none'><caption>app/controllers/email_attachments_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def create</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email_attachment = EmailAttachment.new(params[:email_attachment])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ## save file and assign filepath, filename</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    full_filepath = RAILS_ROOT + &quot;/public/attachment_files/&quot;+ @email_attachment.smart_filename(params[:attachment_file])</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @actual_file = File.new(full_filepath, 'wb')</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @actual_file.write params[:attachment_file].read</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @actual_file.close</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email_attachment.original_filename = params[:attachment_file].original_filename</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email_attachment.filepath = full_filepath</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ImportJobsController</td>
    <td>handle_csv_import</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
    <td><div class='warning_message' onClick="toggle('context8');toggle('message8');toggle('full_message8')" ><span id='message8' style='display:block' >Model attribute value used in file name near line 20: File.open((&quot;#{RAILS_ROOT}/public/import_files/&quot;...</span><span id='full_message8' style='display:none'>Model attribute value used in file name near line 20: File.open((&quot;#{RAILS_ROOT}/public/import_files/&quot; + <span class="user_input">ImportJob.new(params[:import_job])</span>.id.to_s), &quot;wb&quot;)</span><table id='context8' class='context' style='display:none'><caption>app/controllers/import_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>15</pre>
          </td>
          <td class='context'>
            <pre class='context'>#    raise &quot;@import_job = &quot;+Configurable.hash_to_string(@import_job.attributes)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @import_job.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>      filepath = &quot;#{RAILS_ROOT}/public/import_files/&quot;+ @import_job.id.to_s</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #raise &quot;filepath = &quot;+filepath</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>      File.open(filepath, 'wb') do |f|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>        f.write(@params[:csv_file].read)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @import_job.update_attributes(:filepath =&gt; filepath)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @import_job.update_attributes(:target_class =&gt; &quot;Lead&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>AutoEmailMappingsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context10');toggle('message10');toggle('full_message10')" >Unprotected mass assignment near line 52: AutoEmailMapping.new(<span class="user_input">params[:auto_email_mapping]</span>)<table id='context10' class='context' style='display:none'><caption>app/controllers/auto_email_mappings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>47</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def new</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @auto_email_mapping = AutoEmailMapping.new</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @auto_email_mapping = AutoEmailMapping.new(params[:auto_email_mapping])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @auto_email_mapping.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash[:notice] = 'AutoEmailMapping was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to :action =&gt; 'list'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; 'new'</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ConfirmationLetterTemplatesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context12');toggle('message12');toggle('full_message12')" >Unprotected mass assignment near line 75: ConfirmationLetterTemplate.new(<span class="user_input">params[:email_template]</span>)<table id='context12' class='context' style='display:none'><caption>app/controllers/confirmation_letter_templates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>71</pre>
          </td>
          <td class='context'>
            <pre class='context'>    debug = true</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>    MyLogger.logthis('entered EmailJobTemplatesController.create') if debug</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>    MyLogger.logthis('params = '+Configurable.hash_to_string(params)) if debug</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email_template = ConfirmationLetterTemplate.new(params[:email_template])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless params[:email_attachments].nil?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @email_template.default_attachments = params[:email_attachments].keys.join(',')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless params[:outcomes_checklist].nil?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ConfirmationLetterTemplatesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context94');toggle('message94');toggle('full_message94')" ><span id='message94' style='display:block' >Unprotected mass assignment near line 149: ConfirmationLetterTemplate.find(params[:id]).update_attrib...</span><span id='full_message94' style='display:none'>Unprotected mass assignment near line 149: ConfirmationLetterTemplate.find(params[:id]).update_attributes(<span class="user_input">params[:email_template]</span>)</span><table id='context94' class='context' style='display:none'><caption>app/controllers/confirmation_letter_templates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>144</pre>
          </td>
          <td class='context'>
            <pre class='context'>    else</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>145</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @email_template.include_est = 0</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>146</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>149</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @email_template.update_attributes(params[:email_template])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'ConfirmationLetterTemplate was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>151</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to :action =&gt; 'index' }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>153</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context13');toggle('message13');toggle('full_message13')" >Unprotected mass assignment near line 47: CreditCard.new(<span class="user_input">params[:credit_card]</span>)<table id='context13' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>42</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /credit_cards</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /credit_cards.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @credit_card = CreditCard.new(params[:credit_card])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @credit_card.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'CreditCard was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>        case @credit_card.job_type</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context95');toggle('message95');toggle('full_message95')" ><span id='message95' style='display:block' >Unprotected mass assignment near line 79: CreditCard.find(params[:id]).update_attributes(params[:cred...</span><span id='full_message95' style='display:none'>Unprotected mass assignment near line 79: CreditCard.find(params[:id]).update_attributes(<span class="user_input">params[:credit_card]</span>)</span><table id='context95' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>74</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /credit_cards/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @credit_card = CreditCard.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @credit_card.update_attributes(params[:credit_card])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'CreditCard was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>        case @credit_card.job_type</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context171');toggle('message171');toggle('full_message171')" ><span id='message171' style='display:block' >Unprotected mass assignment near line 54: Job.update(CreditCard.new(params[:credit_card]).job_id, :cr...</span><span id='full_message171' style='display:none'>Unprotected mass assignment near line 54: Job.update(CreditCard.new(params[:credit_card]).job_id, :credit_card_id =&gt; (<span class="user_input">CreditCard.new(params[:credit_card]).id</span>))</span><table id='context171' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>49</pre>
          </td>
          <td class='context'>
            <pre class='context'>    respond_to do |format|</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @credit_card.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'CreditCard was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>        case @credit_card.job_type</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>          Job.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>          FixedpriceJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context172');toggle('message172');toggle('full_message172')" ><span id='message172' style='display:block' >Unprotected mass assignment near line 57: FixedpriceJob.update(CreditCard.new(params[:credit_card]).j...</span><span id='full_message172' style='display:none'>Unprotected mass assignment near line 57: FixedpriceJob.update(CreditCard.new(params[:credit_card]).job_id, :credit_card_id =&gt; (<span class="user_input">CreditCard.new(params[:credit_card]).id</span>))</span><table id='context172' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>        case @credit_card.job_type</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>          Job.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>          FixedpriceJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>          MiscJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/misc_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context173');toggle('message173');toggle('full_message173')" ><span id='message173' style='display:block' >Unprotected mass assignment near line 60: MiscJob.update(CreditCard.new(params[:credit_card]).job_id,...</span><span id='full_message173' style='display:none'>Unprotected mass assignment near line 60: MiscJob.update(CreditCard.new(params[:credit_card]).job_id, :credit_card_id =&gt; (<span class="user_input">CreditCard.new(params[:credit_card]).id</span>))</span><table id='context173' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>55</pre>
          </td>
          <td class='context'>
            <pre class='context'>          format.html { redirect_to &quot;/jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>          FixedpriceJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>          MiscJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/misc_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>        #format.html { redirect_to &quot;/leads/#{@credit_card.lead_id};show&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :created, :location =&gt; credit_card_url(@credit_card) }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CustomServicesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context14');toggle('message14');toggle('full_message14')" >Unprotected mass assignment near line 37: CustomService.new(<span class="user_input">params[:custom_service]</span>)<table id='context14' class='context' style='display:none'><caption>app/controllers/custom_services_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /custom_services</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /custom_services.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @custom_service = CustomService.new(params[:custom_service])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @custom_service.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'CustomService was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to custom_service_url(@custom_service) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CustomServicesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context96');toggle('message96');toggle('full_message96')" ><span id='message96' style='display:block' >Unprotected mass assignment near line 57: CustomService.find(params[:id]).update_attributes(params[:c...</span><span id='full_message96' style='display:none'>Unprotected mass assignment near line 57: CustomService.find(params[:id]).update_attributes(<span class="user_input">params[:custom_service]</span>)</span><table id='context96' class='context' style='display:none'><caption>app/controllers/custom_services_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /custom_services/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @custom_service = CustomService.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @custom_service.update_attributes(params[:custom_service])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'CustomService was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to custom_service_url(@custom_service) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnConfirmationLettersController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context97');toggle('message97');toggle('full_message97')" ><span id='message97' style='display:block' >Unprotected mass assignment near line 248: DnConfirmationLetter.find(params[:id]).update_attributes(p...</span><span id='full_message97' style='display:none'>Unprotected mass assignment near line 248: DnConfirmationLetter.find(params[:id]).update_attributes(<span class="user_input">params[:dn_email]</span>)</span><table id='context97' class='context' style='display:none'><caption>app/controllers/dn_confirmation_letters_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>243</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /dn_emails/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>244</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>245</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @dn_email = DnConfirmationLetter.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>247</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>248</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @dn_email.update_attributes(params[:dn_email])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>249</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'DnConfirmationLetter was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>250</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to dn_email_url(@dn_email) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>251</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>252</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>253</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnEmailsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context98');toggle('message98');toggle('full_message98')" ><span id='message98' style='display:block' >Unprotected mass assignment near line 238: DnEmail.find(params[:id]).update_attributes(params[:dn_ema...</span><span id='full_message98' style='display:none'>Unprotected mass assignment near line 238: DnEmail.find(params[:id]).update_attributes(<span class="user_input">params[:dn_email]</span>)</span><table id='context98' class='context' style='display:none'><caption>app/controllers/dn_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>233</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /dn_emails/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>234</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>235</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @dn_email = DnEmail.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>237</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>238</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @dn_email.update_attributes(params[:dn_email])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>239</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'DnEmail was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>240</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to dn_email_url(@dn_email) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>241</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>242</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>243</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DrivingTimesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context15');toggle('message15');toggle('full_message15')" >Unprotected mass assignment near line 133: DrivingTime.new(<span class="user_input">params[:driving_time]</span>)<table id='context15' class='context' style='display:none'><caption>app/controllers/driving_times_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>128</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /driving_times</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /driving_times.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @driving_time = DrivingTime.new(params[:driving_time])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @driving_time.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>137</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'DrivingTime was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>138</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to driving_time_url(@driving_time) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DrivingTimesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context99');toggle('message99');toggle('full_message99')" ><span id='message99' style='display:block' >Unprotected mass assignment near line 153: DrivingTime.find(params[:id]).update_attributes(params[:dr...</span><span id='full_message99' style='display:none'>Unprotected mass assignment near line 153: DrivingTime.find(params[:id]).update_attributes(<span class="user_input">params[:driving_time]</span>)</span><table id='context99' class='context' style='display:none'><caption>app/controllers/driving_times_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>148</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /driving_times/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>149</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @driving_time = DrivingTime.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>153</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @driving_time.update_attributes(params[:driving_time])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'DrivingTime was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>155</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to driving_time_url(@driving_time) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>156</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>157</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>158</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>Email</td>
    <td>to_lead</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context61');toggle('message61');toggle('full_message61')" ><span id='message61' style='display:block' >Unprotected mass assignment near line 78: Lead.new(VLeadCreator.extractor_hash_to_lead_hash(Microform...</span><span id='full_message61' style='display:none'>Unprotected mass assignment near line 78: Lead.new(VLeadCreator.extractor_hash_to_lead_hash(<span class="user_input">Microformat.find(microformat_id)</span>.extractor.extract_to_hash(self)))</span><table id='context61' class='context' style='display:none'><caption>app/models/email.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>73</pre>
          </td>
          <td class='context'>
            <pre class='context'>    extractor = Microformat.find(microformat_id).extractor</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>    extractor_hash = extractor.extract_to_hash(self)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>    postprocessor_hash= VLeadCreator.extractor_hash_to_lead_hash(extractor_hash)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>    postprocessor_hash.delete('inventory')</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>    lead = Lead.new(postprocessor_hash)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>    lead.email_id = id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>    lead.email_date = date</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>    lead</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>EmailAttachmentsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context16');toggle('message16');toggle('full_message16')" >Unprotected mass assignment near line 40: EmailAttachment.new(<span class="user_input">params[:email_attachment]</span>)<table id='context16' class='context' style='display:none'><caption>app/controllers/email_attachments_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>35</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /email_attachments</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /email_attachments.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email_attachment = EmailAttachment.new(params[:email_attachment])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ## save file and assign filepath, filename</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    full_filepath = RAILS_ROOT + &quot;/public/attachment_files/&quot;+ @email_attachment.smart_filename(params[:attachment_file])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @actual_file = File.new(full_filepath, 'wb')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @actual_file.write params[:attachment_file].read</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>EmailAttachmentsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context100');toggle('message100');toggle('full_message100')" ><span id='message100' style='display:block' >Unprotected mass assignment near line 69: EmailAttachment.find(params[:id]).update_attributes(params[...</span><span id='full_message100' style='display:none'>Unprotected mass assignment near line 69: EmailAttachment.find(params[:id]).update_attributes(<span class="user_input">params[:email_attachment]</span>)</span><table id='context100' class='context' style='display:none'><caption>app/controllers/email_attachments_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>64</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /email_attachments/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email_attachment = EmailAttachment.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @email_attachment.update_attributes(params[:email_attachment])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'EmailAttachment was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to email_attachment_url(@email_attachment) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>EmailTemplatesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context19');toggle('message19');toggle('full_message19')" >Unprotected mass assignment near line 378: EmailTemplate.new(<span class="user_input">params[:email_template]</span>)<table id='context19' class='context' style='display:none'><caption>app/controllers/email_templates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>374</pre>
          </td>
          <td class='context'>
            <pre class='context'>    debug = true</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>375</pre>
            </td>
            <td class='context'>
              <pre class='context'>    MyLogger.logthis('entered EmailTemplatesController.create') if debug</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>376</pre>
            </td>
            <td class='context'>
              <pre class='context'>    MyLogger.logthis('params = '+Configurable.hash_to_string(params)) if debug</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>378</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email_template = EmailTemplate.new(params[:email_template])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>379</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless params[:email_attachments].nil?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>380</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @email_template.default_attachments = params[:email_attachments].keys.join(',')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>381</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>383</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless params[:outcomes_checklist].nil?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>EmailTemplatesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context101');toggle('message101');toggle('full_message101')" ><span id='message101' style='display:block' >Unprotected mass assignment near line 446: EmailTemplate.find(params[:id]).update_attributes(params[:...</span><span id='full_message101' style='display:none'>Unprotected mass assignment near line 446: EmailTemplate.find(params[:id]).update_attributes(<span class="user_input">params[:email_template]</span>)</span><table id='context101' class='context' style='display:none'><caption>app/controllers/email_templates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>441</pre>
          </td>
          <td class='context'>
            <pre class='context'>    else</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>442</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @email_template.include_est = 0</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>443</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>445</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>446</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @email_template.update_attributes(params[:email_template])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>447</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'EmailTemplate was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>448</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to :action =&gt; 'index' }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>449</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>450</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>451</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>EmailsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context21');toggle('message21');toggle('full_message21')" >Unprotected mass assignment near line 56: Email.new(<span class="user_input">params[:email][:fullemail]</span>)<table id='context21' class='context' style='display:none'><caption>app/controllers/emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # POST /emails</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /emails.xml</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>#    breakpoint</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email = Email.new(params[:email][:fullemail])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @email.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Email was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to email_url(@email) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>EmailsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context102');toggle('message102');toggle('full_message102')" >Unprotected mass assignment near line 76: Email.find(params[:id]).update_attributes(<span class="user_input">params[:email]</span>)<table id='context102' class='context' style='display:none'><caption>app/controllers/emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>71</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /emails/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email = Email.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @email.update_attributes(params[:email])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Email was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to email_url(@email) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>EventsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context22');toggle('message22');toggle('full_message22')" >Unprotected mass assignment near line 63: Event.new(<span class="user_input">params[:event]</span>)<table id='context22' class='context' style='display:none'><caption>app/controllers/events_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>58</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /events</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /events.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @event = Event.new(params[:event])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @event.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Event was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to event_url(@event) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>EventsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context103');toggle('message103');toggle('full_message103')" >Unprotected mass assignment near line 83: Event.find(params[:id]).update_attributes(<span class="user_input">params[:event]</span>)<table id='context103' class='context' style='display:none'><caption>app/controllers/events_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>78</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /events/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @event = Event.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @event.update_attributes(params[:event])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Event was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to event_url(@event) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ExtractorsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context23');toggle('message23');toggle('full_message23')" >Unprotected mass assignment near line 56: Extractor.new(<span class="user_input">params[:extractor]</span>)<table id='context23' class='context' style='display:none'><caption>app/controllers/extractors_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>51</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /extractors</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /extractors.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @extractor = Extractor.new(params[:extractor])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @extractor.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Extractor was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to edit_extractor_url(@extractor) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ExtractorsController</td>
    <td>add_multiple_extractor_elements</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context24');toggle('message24');toggle('full_message24')" ><span id='message24' style='display:block' >Unprotected mass assignment near line 108: ExtractorElement.new(params[&quot;extractor_elements&quot;][(local i...</span><span id='full_message24' style='display:none'>Unprotected mass assignment near line 108: ExtractorElement.new(<span class="user_input">params[&quot;extractor_elements&quot;][(local i).to_s]</span>)</span><table id='context24' class='context' style='display:none'><caption>app/controllers/extractors_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>104</pre>
          </td>
          <td class='context'>
            <pre class='context'>   # breakpoint</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>    for i in 0..14</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>      begin</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>        ee = ExtractorElement.new(ees[i.to_s])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if ee.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @added_count += 1</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rescue</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ExtractorsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context104');toggle('message104');toggle('full_message104')" ><span id='message104' style='display:block' >Unprotected mass assignment near line 76: Extractor.find(params[:id]).update_attributes(params[:extra...</span><span id='full_message104' style='display:none'>Unprotected mass assignment near line 76: Extractor.find(params[:id]).update_attributes(<span class="user_input">params[:extractor]</span>)</span><table id='context104' class='context' style='display:none'><caption>app/controllers/extractors_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>71</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /extractors/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @extractor = Extractor.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @extractor.update_attributes(params[:extractor])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Extractor was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to extractor_url(@extractor) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>FixedpriceJobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context105');toggle('message105');toggle('full_message105')" ><span id='message105' style='display:block' >Unprotected mass assignment near line 173: FixedpriceJob.find(<span class="user_input">params[:fixedprice_job]</span>[:id]).update_at...</span><span id='full_message105' style='display:none'>Unprotected mass assignment near line 173: FixedpriceJob.find(<span class="user_input">params[:fixedprice_job]</span>[:id]).update_attributes(<span class="user_input">params[:fixedprice_job]</span>)</span><table id='context105' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>169</pre>
          </td>
          <td class='context'>
            <pre class='context'>    #Update Job</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>170</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless params[:fixedprice_job][:status].blank?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>171</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @job_up.status = params[:fixedprice_job][:status]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>172</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>173</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_up.update_attributes(params[:fixedprice_job])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>174</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_up.cu_feet = (params[:cu_feet])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>175</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_up.total_cost = (params[:total_cost])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>176</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #Update Job's Extra Stops</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>FixedpriceJobsController</td>
    <td>Add_Day_FP</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context151');toggle('message151');toggle('full_message151')" ><span id='message151' style='display:block' >Unprotected mass assignment near line 268: FixedpriceJob.create(FixedpriceJob.find(params[:job_type_i...</span><span id='full_message151' style='display:none'>Unprotected mass assignment near line 268: FixedpriceJob.create(<span class="user_input">FixedpriceJob.find(params[:job_type_id])</span>.attributes.merge(:created_on =&gt; (DateTime.now), :created_by =&gt; (session[:user].fullname.split(&quot; &quot;)[0])))</span><table id='context151' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>263</pre>
          </td>
          <td class='context'>
            <pre class='context'>      current_inventory = Inventory.find(:first, :conditions =&gt; [&quot;purpose = ? and purpose_type = ?&quot;, params[:job_type_id], &quot;Job Fixed Price&quot;])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>264</pre>
            </td>
            <td class='context'>
              <pre class='context'>      total_jobs = FixedpriceJob.find(:all, :conditions =&gt; [&quot;job_project_id = ?&quot;, current_job.job_project_id], :order =&gt; &quot;day ASC&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>265</pre>
            </td>
            <td class='context'>
              <pre class='context'>      current_services = JobCustomService.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ?&quot;, params[:job_type_id], &quot;Job Fixed Price&quot;])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>266</pre>
            </td>
            <td class='context'>
              <pre class='context'>      job_count = total_jobs.size</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>267</pre>
            </td>
            <td class='context'>
              <pre class='context'>      all_creditcard = CreditCard.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ? and lead_id = ?&quot;, params[:job_type_id], &quot;Job Fixed Price&quot;, current_job.lead_id])</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>268</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day = FixedpriceJob.create(current_job.attributes.merge({:created_on =&gt; DateTime.now(), :created_by =&gt; session[:user].fullname.split(' ')[0]}))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>269</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day.day = total_jobs.last.day.to_i + 1</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>270</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @new_day.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>271</pre>
            </td>
            <td class='context'>
              <pre class='context'>        current_stops.each do |current_stop|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>272</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop = JobExtraStop.create(current_stop.attributes)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>273</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.job_id = @new_day.id</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>FixedpriceJobsController</td>
    <td>Add_Day_FP</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context153');toggle('message153');toggle('full_message153')" ><span id='message153' style='display:block' >Unprotected mass assignment near line 278: CreditCard.create((local cc).attributes.merge(:job_id =&gt; (...</span><span id='full_message153' style='display:none'>Unprotected mass assignment near line 278: CreditCard.create((local cc).attributes.merge(:job_id =&gt; (FixedpriceJob.create(FixedpriceJob.find(params[:job_type_id]).attributes.merge(:created_on =&gt; (DateTime.now), :created_by =&gt; (session[:user].fullname.split(&quot; &quot;)[0]))).id), :card_number =&gt; (<span class="user_input">CreditCard.decrypt_rsa((local cc).card_number, CreditCard::RSA_PASS)</span>)))</span><table id='context153' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>273</pre>
          </td>
          <td class='context'>
            <pre class='context'>          @new_stop.job_id = @new_day.id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>274</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>275</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>276</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless all_creditcard.blank?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>277</pre>
            </td>
            <td class='context'>
              <pre class='context'>          all_creditcard.each do |cc|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>278</pre>
            </td>
            <td class='context'>
              <pre class='context'>            CreditCard.create(cc.attributes.merge({:job_id =&gt; @new_day.id, :card_number =&gt; CreditCard.decrypt_rsa(cc.card_number, CreditCard::RSA_PASS)}))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>279</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>280</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>281</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_services.nil?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>282</pre>
            </td>
            <td class='context'>
              <pre class='context'>          current_services.each do |current_service|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>283</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service = JobCustomService.create(current_service.attributes)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>FixedpriceJobsController</td>
    <td>Add_Day_FP</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context155');toggle('message155');toggle('full_message155')" ><span id='message155' style='display:block' >Unprotected mass assignment near line 289: Inventory.create(Inventory.find(:first, :conditions =&gt; ([&quot;...</span><span id='full_message155' style='display:none'>Unprotected mass assignment near line 289: Inventory.create(<span class="user_input">Inventory.find(:first, :conditions =&gt; ([&quot;purpose = ? and purpose_type = ?&quot;, params[:job_type_id], &quot;Job Fixed Price&quot;])).attributes</span>)</span><table id='context155' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>284</pre>
          </td>
          <td class='context'>
            <pre class='context'>            @new_service.job_id = @new_day.id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>285</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>286</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>287</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>288</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_inventory.nil?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>289</pre>
            </td>
            <td class='context'>
              <pre class='context'>          new_inventory = Inventory.create(current_inventory.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>290</pre>
            </td>
            <td class='context'>
              <pre class='context'>          new_inventory.purpose = @new_day.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>291</pre>
            </td>
            <td class='context'>
              <pre class='context'>          new_inventory.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>292</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>293</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to :controller=&gt; &quot;fixedprice_jobs&quot;,:action =&gt; &quot;show&quot;, :job_type_id =&gt; @new_day.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>294</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>HotConditionsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context27');toggle('message27');toggle('full_message27')" >Unprotected mass assignment near line 47: HotCondition.new(<span class="user_input">params[:hot_condition]</span>)<table id='context27' class='context' style='display:none'><caption>app/controllers/hot_conditions_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>42</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /hot_conditions</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /hot_conditions.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @hot_condition = HotCondition.new(params[:hot_condition])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @hot_condition.test_hash=(params[:test_hash])</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>HourlyRatesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context28');toggle('message28');toggle('full_message28')" >Unprotected mass assignment near line 133: HourlyRate.new(<span class="user_input">params[:hourly_rate]</span>)<table id='context28' class='context' style='display:none'><caption>app/controllers/hourly_rates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>128</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /hourly_rates</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /hourly_rates.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @hourly_rate = HourlyRate.new(params[:hourly_rate])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @hourly_rate.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>137</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'HourlyRate was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>138</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to hourly_rate_url(@hourly_rate) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>HourlyRatesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context106');toggle('message106');toggle('full_message106')" ><span id='message106' style='display:block' >Unprotected mass assignment near line 153: HourlyRate.find(params[:id]).update_attributes(params[:hou...</span><span id='full_message106' style='display:none'>Unprotected mass assignment near line 153: HourlyRate.find(params[:id]).update_attributes(<span class="user_input">params[:hourly_rate]</span>)</span><table id='context106' class='context' style='display:none'><caption>app/controllers/hourly_rates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>148</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /hourly_rates/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>149</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @hourly_rate = HourlyRate.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>153</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @hourly_rate.update_attributes(params[:hourly_rate])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'HourlyRate was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>155</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to hourly_rate_url(@hourly_rate) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>156</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>157</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>158</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ImportJob</td>
    <td>ImportJob.csv_row_to_lead</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context70');toggle('message70');toggle('full_message70')" ><span id='message70' style='display:block' >Unprotected mass assignment near line 150: Lead.new(Postprocessor.validate({ &quot;FirstName&quot; =&gt; &quot;firstnam...</span><span id='full_message70' style='display:none'>Unprotected mass assignment near line 150: Lead.new(<span class="user_input">Postprocessor.validate({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_state&quot;])), &quot;used_default_orig_zip&quot; =&gt; 1, &quot;dest_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_state&quot;])), &quot;used_default_orig_zip&quot; =&gt; 1, &quot;dest_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_state&quot;])), &quot;used_default_orig_zip&quot; =&gt; 1 }[&quot;dest_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_state&quot;])), &quot;used_default_orig_zip&quot; =&gt; 1 }[&quot;dest_state&quot;])) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_state&quot;])), &quot;used_default_orig_zip&quot; =&gt; 1, &quot;dest_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_state&quot;])), &quot;used_default_orig_zip&quot; =&gt; 1 }[&quot;dest_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now), &quot;orig_zip&quot; =&gt; (Postprocessor.get_or_create_zipcode_or_pseudozipcode({ { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_city&quot;], { { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][0] =&gt; (ImportJob.method({ &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]][1]).call((local row)[(local i)])), { &quot;FirstName&quot; =&gt; &quot;firstname&quot;, &quot;LastName&quot; =&gt; &quot;lastname&quot;, &quot;PhoneNumber&quot; =&gt; &quot;phone1&quot;, &quot;Email&quot; =&gt; &quot;contact_email&quot;, &quot;OriginCity&quot; =&gt; &quot;orig_city&quot;, &quot;OriginState&quot; =&gt; &quot;orig_state&quot;, &quot;OriginZip&quot; =&gt; &quot;orig_zip&quot;, &quot;DestCity&quot; =&gt; &quot;dest_city&quot;, &quot;DestState&quot; =&gt; &quot;dest_state&quot;, &quot;DestZip&quot; =&gt; &quot;dest_zip&quot;, &quot;MoveDate&quot; =&gt; ([&quot;move_date&quot;, &quot;timeparse&quot;]), &quot;Notes&quot; =&gt; &quot;comments1&quot; }[(local header)[(local i)]] =&gt; ((local row)[(local i)]), &quot;lead_company_name&quot; =&gt; ((local lead_company_name)), &quot;email_date&quot; =&gt; (Time.now) }[&quot;orig_state&quot;])) }[&quot;orig_state&quot;])), &quot;used_default_orig_zip&quot; =&gt; 1 }[&quot;dest_state&quot;])) }[&quot;orig_state&quot;])), &quot;used_default_dest_zip&quot; =&gt; 1)</span>)</span><table id='context70' class='context' style='display:none'><caption>app/models/import_job.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>145</pre>
          </td>
          <td class='context'>
            <pre class='context'>#    raise &quot;validated_leadhash = &quot;+Configurable.hash_to_string(validated_leadhash)    </pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>146</pre>
            </td>
            <td class='context'>
              <pre class='context'>    validated_leadhash['phone1'] = Postprocessor.validate_phone(validated_leadhash['phone1'].to_s)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>#    raise &quot;validated_leadhash = &quot;+Configurable.hash_to_string(validated_leadhash)    </pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>    lead = Lead.new(validated_leadhash)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>    return lead</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ImportJobsController</td>
    <td>handle_csv_import</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context29');toggle('message29');toggle('full_message29')" >Unprotected mass assignment near line 13: ImportJob.new(<span class="user_input">params[:import_job]</span>)<table id='context29' class='context' style='display:none'><caption>app/controllers/import_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>8</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def handle_csv_import</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @import_job = ImportJob.new(params[:import_job])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>#    raise &quot;@import_job = &quot;+Configurable.hash_to_string(@import_job.attributes)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @import_job.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>      filepath = &quot;#{RAILS_ROOT}/public/import_files/&quot;+ @import_job.id.to_s</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ImportJobsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context30');toggle('message30');toggle('full_message30')" >Unprotected mass assignment near line 97: ImportJob.new(<span class="user_input">params[:import_job]</span>)<table id='context30' class='context' style='display:none'><caption>app/controllers/import_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>92</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /import_jobs</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /import_jobs.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @import_job = ImportJob.new(params[:import_job])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @import_job.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'ImportJob was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to import_job_url(@import_job) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ImportJobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context108');toggle('message108');toggle('full_message108')" ><span id='message108' style='display:block' >Unprotected mass assignment near line 117: ImportJob.find(params[:id]).update_attributes(params[:impo...</span><span id='full_message108' style='display:none'>Unprotected mass assignment near line 117: ImportJob.find(params[:id]).update_attributes(<span class="user_input">params[:import_job]</span>)</span><table id='context108' class='context' style='display:none'><caption>app/controllers/import_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>112</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /import_jobs/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @import_job = ImportJob.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>117</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @import_job.update_attributes(params[:import_job])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'ImportJob was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>119</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to import_job_url(@import_job) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>120</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>121</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>Importer</td>
    <td>Importer.email_to_lead</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context73');toggle('message73');toggle('full_message73')" ><span id='message73' style='display:block' >Unprotected mass assignment near line 342: Lead.new(Postprocessor.validate_and_transform(Microformat....</span><span id='full_message73' style='display:none'>Unprotected mass assignment near line 342: Lead.new(<span class="user_input">Postprocessor.validate_and_transform(Microformat.find((local email).microformat_id).extractor.extract_to_hash((local email)))</span>)</span><table id='context73' class='context' style='display:none'><caption>app/models/importer.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>338</pre>
          </td>
          <td class='context'>
            <pre class='context'>    hash = extractor.extract_to_hash(email)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>340</pre>
            </td>
            <td class='context'>
              <pre class='context'>    leadhash= Postprocessor.validate_and_transform(hash)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>342</pre>
            </td>
            <td class='context'>
              <pre class='context'>    lead = Lead.new(leadhash)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>343</pre>
            </td>
            <td class='context'>
              <pre class='context'>    lead.email_id = email.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>344</pre>
            </td>
            <td class='context'>
              <pre class='context'>    lead.email_date = email.date</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>346</pre>
            </td>
            <td class='context'>
              <pre class='context'>    return lead</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>InventoriesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context33');toggle('message33');toggle('full_message33')" >Unprotected mass assignment near line 66: Inventory.new(<span class="user_input">params[:inventory]</span>)<table id='context33' class='context' style='display:none'><caption>app/controllers/inventories_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>62</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # POST /inventories</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /inventories.xml</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise &quot;should never be entering this function&quot;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @inventory = Inventory.new(params[:inventory])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @inventory.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Inventory was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to inventory_url(@inventory) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>InventoryExtractorsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context34');toggle('message34');toggle('full_message34')" >Unprotected mass assignment near line 41: InventoryExtractor.new(<span class="user_input">params[:inventory_extractor]</span>)<table id='context34' class='context' style='display:none'><caption>app/controllers/inventory_extractors_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>37</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # POST /inventory_extractors</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /inventory_extractors.xml</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;entered create&quot;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @inventory_extractor = InventoryExtractor.new(params[:inventory_extractor])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @inventory_extractor.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'InventoryExtractor was successfully created, and saved with the following values:'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to edit_inventory_extractor_url(@inventory_extractor) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>InventoryLineItemsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context35');toggle('message35');toggle('full_message35')" >Unprotected mass assignment near line 56: InventoryLineItem.new(<span class="user_input">params[:inventory_line_item]</span>)<table id='context35' class='context' style='display:none'><caption>app/controllers/inventory_line_items_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>51</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /inventory_line_items</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /inventory_line_items.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @inventory_line_item = InventoryLineItem.new(params[:inventory_line_item])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @inventory_line_item.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'InventoryLineItem was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to inventory_line_item_url(@inventory_line_item) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>InventoryLineItemsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context109');toggle('message109');toggle('full_message109')" ><span id='message109' style='display:block' >Unprotected mass assignment near line 76: InventoryLineItem.find(params[:id]).update_attributes(param...</span><span id='full_message109' style='display:none'>Unprotected mass assignment near line 76: InventoryLineItem.find(params[:id]).update_attributes(<span class="user_input">params[:inventory_line_item]</span>)</span><table id='context109' class='context' style='display:none'><caption>app/controllers/inventory_line_items_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>71</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /inventory_line_items/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @inventory_line_item = InventoryLineItem.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @inventory_line_item.update_attributes(params[:inventory_line_item])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'InventoryLineItem was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to inventory_line_item_url(@inventory_line_item) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobReferencesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context36');toggle('message36');toggle('full_message36')" >Unprotected mass assignment near line 94: JobReference.new(<span class="user_input">params[:job_reference]</span>)<table id='context36' class='context' style='display:none'><caption>app/controllers/job_references_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>90</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # POST /job_references</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /job_references.xml</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise &quot;params&quot;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_reference = JobReference.new(params[:job_reference])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @job_reference.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'JobReference was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to job_reference_url(@job_reference) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>save_note</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context38');toggle('message38');toggle('full_message38')" >Unprotected mass assignment near line 85: Note.new(<span class="user_input">params[:note]</span>)<table id='context38' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>81</pre>
          </td>
          <td class='context'>
            <pre class='context'>  #Saving of notes for jobs are handled here</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def save_note</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>    params[&quot;note&quot;].merge!({&quot;note_type&quot; =&gt; true}) if params[&quot;note_type&quot;] == &quot;true&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>    note = Note.new(params[:note])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>    note.created_on = Time.now</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if note.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if note.job_type == &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/jobs/show?job_type_id=#{params[:note][:job_id]}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>      elsif note.job_type == &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context113');toggle('message113');toggle('full_message113')" ><span id='message113' style='display:block' >Unprotected mass assignment near line 328: Job.find(<span class="user_input">params[:job]</span>[:id]).update_attributes(<span class="user_input">params[:job]</span>...</span><span id='full_message113' style='display:none'>Unprotected mass assignment near line 328: Job.find(<span class="user_input">params[:job]</span>[:id]).update_attributes(<span class="user_input">params[:job]</span>)</span><table id='context113' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>323</pre>
          </td>
          <td class='context'>
            <pre class='context'>      params[:job][:email] = nil</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>324</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>327</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #Update Job</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>328</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_up.update_attributes(params[:job])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>329</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_up.cu_feet = (params[:cu_feet])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>330</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_up.total_cost = (params[:total_cost])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>332</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #Update Job's Extra Stops</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>Add_Day</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context159');toggle('message159');toggle('full_message159')" ><span id='message159' style='display:block' >Unprotected mass assignment near line 582: Job.create(<span class="user_input">Job.find(params[:job_type_id])</span>.attributes.merge...</span><span id='full_message159' style='display:none'>Unprotected mass assignment near line 582: Job.create(<span class="user_input">Job.find(params[:job_type_id])</span>.attributes.merge(:created_on =&gt; (DateTime.now), :created_by =&gt; (session[:user].fullname.split(&quot; &quot;)[0])))</span><table id='context159' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>577</pre>
          </td>
          <td class='context'>
            <pre class='context'>      current_inventory = Inventory.find(:first, :conditions =&gt; [&quot;purpose = ? and purpose_type = ?&quot;, params[:job_type_id], &quot;Job Hourly&quot;])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>578</pre>
            </td>
            <td class='context'>
              <pre class='context'>      total_jobs = Job.find(:all, :conditions =&gt; [&quot;job_project_id = ?&quot;, current_job.job_project_id], :order =&gt; &quot;day ASC&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>579</pre>
            </td>
            <td class='context'>
              <pre class='context'>      current_services = JobCustomService.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ?&quot;, params[:job_type_id], &quot;Job Hourly&quot;])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>580</pre>
            </td>
            <td class='context'>
              <pre class='context'>      job_count = total_jobs.size</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>581</pre>
            </td>
            <td class='context'>
              <pre class='context'>      all_creditcard = CreditCard.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ? and lead_id = ?&quot;, params[:job_type_id], &quot;Job Hourly&quot;, current_job.lead_id])</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>582</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day = Job.create(current_job.attributes.merge({:created_on =&gt; DateTime.now(), :created_by =&gt; session[:user].fullname.split(' ')[0]}))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>583</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day.day = total_jobs.last.day.to_i + 1</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>584</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @new_day.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>585</pre>
            </td>
            <td class='context'>
              <pre class='context'>        current_stops.each do |current_stop|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>586</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop = JobExtraStop.create(current_stop.attributes)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>587</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.job_id = @new_day.id</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>Add_Day</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context161');toggle('message161');toggle('full_message161')" ><span id='message161' style='display:block' >Unprotected mass assignment near line 592: CreditCard.create((local cc).attributes.merge(:job_id =&gt; (...</span><span id='full_message161' style='display:none'>Unprotected mass assignment near line 592: CreditCard.create((local cc).attributes.merge(:job_id =&gt; (Job.create(Job.find(params[:job_type_id]).attributes.merge(:created_on =&gt; (DateTime.now), :created_by =&gt; (session[:user].fullname.split(&quot; &quot;)[0]))).id), :card_number =&gt; (<span class="user_input">CreditCard.decrypt_rsa((local cc).card_number, CreditCard::RSA_PASS)</span>)))</span><table id='context161' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>587</pre>
          </td>
          <td class='context'>
            <pre class='context'>          @new_stop.job_id = @new_day.id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>588</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>589</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>590</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless all_creditcard.blank?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>591</pre>
            </td>
            <td class='context'>
              <pre class='context'>          all_creditcard.each do |cc|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>592</pre>
            </td>
            <td class='context'>
              <pre class='context'>            CreditCard.create(cc.attributes.merge({:job_id =&gt; @new_day.id, :card_number =&gt; CreditCard.decrypt_rsa(cc.card_number, CreditCard::RSA_PASS)}))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>593</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>594</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>595</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_services.nil?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>596</pre>
            </td>
            <td class='context'>
              <pre class='context'>          current_services.each do |current_service|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>597</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service = JobCustomService.create(current_service.attributes)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>Add_Day</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context163');toggle('message163');toggle('full_message163')" ><span id='message163' style='display:block' >Unprotected mass assignment near line 603: Inventory.create(Inventory.find(:first, :conditions =&gt; ([&quot;...</span><span id='full_message163' style='display:none'>Unprotected mass assignment near line 603: Inventory.create(<span class="user_input">Inventory.find(:first, :conditions =&gt; ([&quot;purpose = ? and purpose_type = ?&quot;, params[:job_type_id], &quot;Job Hourly&quot;])).attributes</span>)</span><table id='context163' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>598</pre>
          </td>
          <td class='context'>
            <pre class='context'>            @new_service.job_id = @new_day.id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>599</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>600</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>601</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>602</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_inventory.nil?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>603</pre>
            </td>
            <td class='context'>
              <pre class='context'>          new_inventory = Inventory.create(current_inventory.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>604</pre>
            </td>
            <td class='context'>
              <pre class='context'>          new_inventory.purpose = @new_day.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>605</pre>
            </td>
            <td class='context'>
              <pre class='context'>          new_inventory.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>606</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>607</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to :action =&gt; &quot;show&quot;, :job_type_id =&gt; @new_day.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>608</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadCompaniesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context39');toggle('message39');toggle('full_message39')" >Unprotected mass assignment near line 43: LeadCompany.new(<span class="user_input">params[:lead_company]</span>)<table id='context39' class='context' style='display:none'><caption>app/controllers/lead_companies_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /lead_companies</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /lead_companies.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead_company = LeadCompany.new(params[:lead_company])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @lead_company.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'LeadCompany was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to lead_company_url(@lead_company) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadCompaniesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context114');toggle('message114');toggle('full_message114')" ><span id='message114' style='display:block' >Unprotected mass assignment near line 63: LeadCompany.find(params[:id]).update_attributes(params[:lea...</span><span id='full_message114' style='display:none'>Unprotected mass assignment near line 63: LeadCompany.find(params[:id]).update_attributes(<span class="user_input">params[:lead_company]</span>)</span><table id='context114' class='context' style='display:none'><caption>app/controllers/lead_companies_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>58</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /lead_companies/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead_company = LeadCompany.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @lead_company.update_attributes(params[:lead_company])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'LeadCompany was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to :action =&gt; 'index' }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>create_old</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context40');toggle('message40');toggle('full_message40')" ><span id='message40' style='display:block' >Unprotected mass assignment near line 194: Lead.new(Lead.transform_and_validate_manual_input(Lead.wro...</span><span id='full_message40' style='display:none'>Unprotected mass assignment near line 194: Lead.new(<span class="user_input">Lead.transform_and_validate_manual_input(Lead.wrongformat_values_to_leadhash(params[:newlead_values]))[1]</span>)</span><table id='context40' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>190</pre>
          </td>
          <td class='context'>
            <pre class='context'>    #    raise &quot;valid_transformed_leadhash = &quot;+Configurable.hash_to_string(@valid_transformed_leadhash)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>192</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # breakpoint</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>194</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead = Lead.new(@valid_transformed_leadhash)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>195</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #breakpoint &quot;check @lead for lead_company_name and move_date&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>196</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;@lead.move_date = &quot;+@lead.move_date.to_s</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>198</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @problem_messages.concat(@result[0])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>199</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;@problem_messages = #{@problem_messages.join(', ')}&quot;  </pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>update_lead_attributes</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context115');toggle('message115');toggle('full_message115')" ><span id='message115' style='display:block' >Unprotected mass assignment near line 263: Lead.find(params[:id]).update_attributes(Lead.transform_an...</span><span id='full_message115' style='display:none'>Unprotected mass assignment near line 263: Lead.find(params[:id]).update_attributes(<span class="user_input">Lead.transform_and_validate_manual_input(params[:leadupdate])[1]</span>)</span><table id='context115' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>258</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @result[1][&quot;used_default_dest_state&quot;] = nil</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>260</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @result[0].size == 0</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>261</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead = Lead.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>262</pre>
            </td>
            <td class='context'>
              <pre class='context'>      begin</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>263</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if @lead.update_attributes(@result[1])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>264</pre>
            </td>
            <td class='context'>
              <pre class='context'>          add_to_general_messages('Lead successfully updated')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>265</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>266</pre>
            </td>
            <td class='context'>
              <pre class='context'>          add_to_general_messages('For some reason your changes were not saved, but no errors arose.  Contact Luke')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>267</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>268</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rescue Exception =&gt; e</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>revert_lead_attributes</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context116');toggle('message116');toggle('full_message116')" ><span id='message116' style='display:block' >Unprotected mass assignment near line 284: Lead.find(params[:id]).update_attributes(eval(params[:old_...</span><span id='full_message116' style='display:none'>Unprotected mass assignment near line 284: Lead.find(params[:id]).update_attributes(eval(<span class="user_input">params[:old_attributes_stringified]</span>))</span><table id='context116' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>279</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>281</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def revert_lead_attributes</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>283</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead = Lead.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>284</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead.update_attributes(eval(params[:old_attributes_stringified]))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>285</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>287</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to :action =&gt; 'show', :id =&gt; @lead.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>289</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context117');toggle('message117');toggle('full_message117')" ><span id='message117' style='display:block' >Unprotected mass assignment near line 306: Lead.find(params[:id]).update_attributes(eval(params[:new_...</span><span id='full_message117' style='display:none'>Unprotected mass assignment near line 306: Lead.find(params[:id]).update_attributes(eval(<span class="user_input">params[:new_values_stringified]</span>))</span><table id='context117' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>301</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @event_for_form = session[:pending_event] if session[:pending_event]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>303</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @old_attributes_stringified = Configurable.hash_to_string(@lead.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>305</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if params[:new_values_stringified]</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>306</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(eval(params[:new_values_stringified]))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>307</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>309</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @unable_to_quote = false</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>310</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @quotes = @lead.quotes</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>311</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @quote = @quotes.first</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ListCountsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context42');toggle('message42');toggle('full_message42')" >Unprotected mass assignment near line 37: ListCount.new(<span class="user_input">params[:list_count]</span>)<table id='context42' class='context' style='display:none'><caption>app/controllers/list_counts_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /list_counts</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /list_counts.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @list_count = ListCount.new(params[:list_count])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @list_count.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'ListCount was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to list_count_url(@list_count) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ListCountsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context119');toggle('message119');toggle('full_message119')" ><span id='message119' style='display:block' >Unprotected mass assignment near line 57: ListCount.find(params[:id]).update_attributes(params[:list_...</span><span id='full_message119' style='display:none'>Unprotected mass assignment near line 57: ListCount.find(params[:id]).update_attributes(<span class="user_input">params[:list_count]</span>)</span><table id='context119' class='context' style='display:none'><caption>app/controllers/list_counts_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /list_counts/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @list_count = ListCount.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @list_count.update_attributes(params[:list_count])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'ListCount was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to list_count_url(@list_count) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>MicroformatsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context43');toggle('message43');toggle('full_message43')" >Unprotected mass assignment near line 49: Microformat.new(<span class="user_input">params[:microformat]</span>)<table id='context43' class='context' style='display:none'><caption>app/controllers/microformats_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>44</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /microformats</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /microformats.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @microformat = Microformat.new(params[:microformat])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @microformat.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Microformat was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to lead_company_url(@microformat.lead_company) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>MicroformatsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context120');toggle('message120');toggle('full_message120')" ><span id='message120' style='display:block' >Unprotected mass assignment near line 69: Microformat.find(params[:id]).update_attributes(params[:mic...</span><span id='full_message120' style='display:none'>Unprotected mass assignment near line 69: Microformat.find(params[:id]).update_attributes(<span class="user_input">params[:microformat]</span>)</span><table id='context120' class='context' style='display:none'><caption>app/controllers/microformats_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>64</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /microformats/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @microformat = Microformat.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @microformat.update_attributes(params[:microformat])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Microformat was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to lead_company_url(@microformat.lead_company_id) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>MiscJobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context121');toggle('message121');toggle('full_message121')" ><span id='message121' style='display:block' >Unprotected mass assignment near line 173: MiscJob.find(<span class="user_input">params[:misc_job]</span>[:id]).update_attributes(par...</span><span id='full_message121' style='display:none'>Unprotected mass assignment near line 173: MiscJob.find(<span class="user_input">params[:misc_job]</span>[:id]).update_attributes(<span class="user_input">params[:misc_job]</span>)</span><table id='context121' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>169</pre>
          </td>
          <td class='context'>
            <pre class='context'>    #Update Job</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>170</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless params[:misc_job][:status].blank?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>171</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @job_up.status = params[:misc_job][:status]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>172</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>173</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_up.update_attributes(params[:misc_job])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>174</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_up.cu_feet = (params[:cu_feet])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>175</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_up.total_cost = (params[:total_cost])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>177</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #Update Job's Extra Stops</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>MiscJobsController</td>
    <td>Add_Day_MC</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context166');toggle('message166');toggle('full_message166')" ><span id='message166' style='display:block' >Unprotected mass assignment near line 270: MiscJob.create(<span class="user_input">MiscJob.find(params[:job_type_id])</span>.attribut...</span><span id='full_message166' style='display:none'>Unprotected mass assignment near line 270: MiscJob.create(<span class="user_input">MiscJob.find(params[:job_type_id])</span>.attributes.merge(:created_on =&gt; (DateTime.now), :created_by =&gt; (session[:user].fullname.split(&quot; &quot;)[0])))</span><table id='context166' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>265</pre>
          </td>
          <td class='context'>
            <pre class='context'>      total_jobs = MiscJob.find(:all, :conditions =&gt; [&quot;job_project_id = ?&quot;, current_job.job_project_id], :order =&gt; &quot;day ASC&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>266</pre>
            </td>
            <td class='context'>
              <pre class='context'>      current_services = JobCustomService.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ?&quot;, params[:job_type_id], &quot;Miscellaneous Jobs&quot;])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>268</pre>
            </td>
            <td class='context'>
              <pre class='context'>      job_count = total_jobs.size</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>269</pre>
            </td>
            <td class='context'>
              <pre class='context'>      all_creditcard = CreditCard.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ? and lead_id = ?&quot;, params[:job_type_id], &quot;Miscellaneous Jobs&quot;, current_job.lead_id])</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>270</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day = MiscJob.create(current_job.attributes.merge({:created_on =&gt; DateTime.now(), :created_by =&gt; session[:user].fullname.split(' ')[0]}))</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>271</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day.day = total_jobs.last.day.to_i + 1</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>272</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @new_day.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>273</pre>
            </td>
            <td class='context'>
              <pre class='context'>        current_stops.each do |current_stop|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>274</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop = JobExtraStop.create(current_stop.attributes)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>275</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.job_id = @new_day.id</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>MiscJobsController</td>
    <td>Add_Day_MC</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context168');toggle('message168');toggle('full_message168')" ><span id='message168' style='display:block' >Unprotected mass assignment near line 280: CreditCard.create((local cc).attributes.merge(:job_id =&gt; (...</span><span id='full_message168' style='display:none'>Unprotected mass assignment near line 280: CreditCard.create((local cc).attributes.merge(:job_id =&gt; (MiscJob.create(MiscJob.find(params[:job_type_id]).attributes.merge(:created_on =&gt; (DateTime.now), :created_by =&gt; (session[:user].fullname.split(&quot; &quot;)[0]))).id), :card_number =&gt; (<span class="user_input">CreditCard.decrypt_rsa((local cc).card_number, CreditCard::RSA_PASS)</span>)))</span><table id='context168' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>275</pre>
          </td>
          <td class='context'>
            <pre class='context'>          @new_stop.job_id = @new_day.id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>276</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>277</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>278</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless all_creditcard.blank?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>279</pre>
            </td>
            <td class='context'>
              <pre class='context'>          all_creditcard.each do |cc|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>280</pre>
            </td>
            <td class='context'>
              <pre class='context'>            CreditCard.create(cc.attributes.merge({:job_id =&gt; @new_day.id, :card_number =&gt; CreditCard.decrypt_rsa(cc.card_number, CreditCard::RSA_PASS)}))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>281</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>282</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>283</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_services.nil?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>284</pre>
            </td>
            <td class='context'>
              <pre class='context'>          current_services.each do |current_service|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>285</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service = JobCustomService.create(current_service.attributes)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>MiscJobsController</td>
    <td>Add_Day_MC</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context170');toggle('message170');toggle('full_message170')" ><span id='message170' style='display:block' >Unprotected mass assignment near line 292: Inventory.create(Inventory.find(:first, :conditions =&gt; ([&quot;...</span><span id='full_message170' style='display:none'>Unprotected mass assignment near line 292: Inventory.create(<span class="user_input">Inventory.find(:first, :conditions =&gt; ([&quot;purpose = ? and purpose_type = ?&quot;, params[:job_type_id], &quot;Miscellaneous Jobs&quot;])).attributes</span>)</span><table id='context170' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>287</pre>
          </td>
          <td class='context'>
            <pre class='context'>            @new_service.save</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>288</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>289</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>291</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_inventory.nil?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>292</pre>
            </td>
            <td class='context'>
              <pre class='context'>          new_inventory = Inventory.create(current_inventory.attributes)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>293</pre>
            </td>
            <td class='context'>
              <pre class='context'>          new_inventory.purpose = @new_day.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>294</pre>
            </td>
            <td class='context'>
              <pre class='context'>          new_inventory.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>295</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>297</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to :action =&gt; &quot;show&quot;, :job_type_id =&gt; @new_day.id</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>PreprocessorsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context45');toggle('message45');toggle('full_message45')" >Unprotected mass assignment near line 37: Preprocessor.new(<span class="user_input">params[:preprocessor]</span>)<table id='context45' class='context' style='display:none'><caption>app/controllers/preprocessors_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /preprocessors</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /preprocessors.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @preprocessor = Preprocessor.new(params[:preprocessor])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @preprocessor.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Preprocessor was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to preprocessor_url(@preprocessor) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>PreprocessorsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context122');toggle('message122');toggle('full_message122')" ><span id='message122' style='display:block' >Unprotected mass assignment near line 57: Preprocessor.find(params[:id]).update_attributes(params[:pr...</span><span id='full_message122' style='display:none'>Unprotected mass assignment near line 57: Preprocessor.find(params[:id]).update_attributes(<span class="user_input">params[:preprocessor]</span>)</span><table id='context122' class='context' style='display:none'><caption>app/controllers/preprocessors_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /preprocessors/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @preprocessor = Preprocessor.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @preprocessor.update_attributes(params[:preprocessor])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Preprocessor was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to preprocessor_url(@preprocessor) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>PseudoZipCodesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context46');toggle('message46');toggle('full_message46')" >Unprotected mass assignment near line 37: PseudoZipCode.new(<span class="user_input">params[:pseudo_zip_code]</span>)<table id='context46' class='context' style='display:none'><caption>app/controllers/pseudo_zip_codes_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /pseudo_zip_codes</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /pseudo_zip_codes.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @pseudo_zip_code = PseudoZipCode.new(params[:pseudo_zip_code])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @pseudo_zip_code.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'PseudoZipCode was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to pseudo_zip_code_url(@pseudo_zip_code) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>PseudoZipCodesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context123');toggle('message123');toggle('full_message123')" ><span id='message123' style='display:block' >Unprotected mass assignment near line 57: PseudoZipCode.find(params[:id]).update_attributes(params[:p...</span><span id='full_message123' style='display:none'>Unprotected mass assignment near line 57: PseudoZipCode.find(params[:id]).update_attributes(<span class="user_input">params[:pseudo_zip_code]</span>)</span><table id='context123' class='context' style='display:none'><caption>app/controllers/pseudo_zip_codes_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /pseudo_zip_codes/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @pseudo_zip_code = PseudoZipCode.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @pseudo_zip_code.update_attributes(params[:pseudo_zip_code])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'PseudoZipCode was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to pseudo_zip_code_url(@pseudo_zip_code) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>QuoteTemplateSelectorsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context47');toggle('message47');toggle('full_message47')" >Unprotected mass assignment near line 81: QuoteTemplateSelector.new(<span class="user_input">params[:new_qts]</span>)<table id='context47' class='context' style='display:none'><caption>app/controllers/quote_template_selectors_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>76</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /quote_template_selectors</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /quote_template_selectors.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @quote_template_selector = QuoteTemplateSelector.new(params[:new_qts])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @quote_template_selector.insert_in_hierarchy_before(params[:insert_before].to_i)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @quote_template_selector.save</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>QuotersController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context48');toggle('message48');toggle('full_message48')" >Unprotected mass assignment near line 37: Quoter.new(<span class="user_input">params[:quoter]</span>)<table id='context48' class='context' style='display:none'><caption>app/controllers/quoters_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /quoters</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /quoters.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @quoter = Quoter.new(params[:quoter])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @quoter.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Quoter was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to quoter_url(@quoter) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>QuotersController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context124');toggle('message124');toggle('full_message124')" ><span id='message124' style='display:block' >Unprotected mass assignment near line 57: Quoter.find(params[:id]).update_attributes(<span class="user_input">params[:quoter]</span>)...</span><span id='full_message124' style='display:none'>Unprotected mass assignment near line 57: Quoter.find(params[:id]).update_attributes(<span class="user_input">params[:quoter]</span>)</span><table id='context124' class='context' style='display:none'><caption>app/controllers/quoters_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /quoters/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @quoter = Quoter.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @quoter.update_attributes(params[:quoter])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Quoter was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to quoter_url(@quoter) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>QuotesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context125');toggle('message125');toggle('full_message125')" >Unprotected mass assignment near line 101: Quote.find(params[:id]).update_attributes(<span class="user_input">params[:quote]</span>)<table id='context125' class='context' style='display:none'><caption>app/controllers/quotes_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>96</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /quotes/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @quote = Quote.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @quote.update_attributes(params[:quote])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Quote was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to quote_url(@quote) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>Remindinator</td>
    <td>Remindinator.record_convo_2nd_followups_sent</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context141');toggle('message141');toggle('full_message141')" ><span id='message141' style='display:block' >Unprotected mass assignment near line 98: EventInterface.new_event(&quot;lead_id&quot; =&gt; ((local target)[0]), ...</span><span id='full_message141' style='display:none'>Unprotected mass assignment near line 98: EventInterface.new_event(&quot;lead_id&quot; =&gt; ((local target)[0]), &quot;filed_under&quot; =&gt; &quot;2nd conv followup email sent&quot;, &quot;notes&quot; =&gt; &quot;automatically sent second conversation followup email&quot;, &quot;quote_id&quot; =&gt; ((local target)[4]), &quot;user_id&quot; =&gt; 1).update_attributes(<span class="user_input">EventInterface.new_attributes_from_filed_under[&quot;2nd conv followup email sent&quot;]</span>)</span><table id='context141' class='context' style='display:none'><caption>app/models/remindinator.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>93</pre>
          </td>
          <td class='context'>
            <pre class='context'>        'filed_under' =&gt; '2nd conv followup email sent',</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'notes'       =&gt; 'automatically sent second conversation followup email',</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'quote_id'    =&gt; target[4],</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'user_id'     =&gt; 1})</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>      event.update_attributes(EventInterface.new_attributes_from_filed_under['2nd conv followup email sent'])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>      event.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>Remindinator</td>
    <td>Remindinator.record_quote_reminders_sent</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context142');toggle('message142');toggle('full_message142')" ><span id='message142' style='display:block' >Unprotected mass assignment near line 148: EventInterface.new_event(&quot;lead_id&quot; =&gt; ((local target)[0]),...</span><span id='full_message142' style='display:none'>Unprotected mass assignment near line 148: EventInterface.new_event(&quot;lead_id&quot; =&gt; ((local target)[0]), &quot;filed_under&quot; =&gt; &quot;2nd email quote sent&quot;, &quot;notes&quot; =&gt; ((&quot;automatic reminder sent via template reminder1 with values: &quot; + (local target)[2].to_yaml)), &quot;quote_id&quot; =&gt; ((local target)[4]), &quot;user_id&quot; =&gt; 1).update_attributes(<span class="user_input">EventInterface.new_attributes_from_filed_under[&quot;2nd conv followup email sent&quot;]</span>)</span><table id='context142' class='context' style='display:none'><caption>app/models/remindinator.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>143</pre>
          </td>
          <td class='context'>
            <pre class='context'>        'filed_under' =&gt; '2nd email quote sent',</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>144</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'notes'       =&gt; 'automatic reminder sent via template reminder1 with values: '+target[2].to_yaml,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>145</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'quote_id'    =&gt; target[4],</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>146</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'user_id'     =&gt; 1})</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>      event.update_attributes(EventInterface.new_attributes_from_filed_under['2nd conv followup email sent'])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>149</pre>
            </td>
            <td class='context'>
              <pre class='context'>      event.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>Remindinator</td>
    <td>Remindinator.record_convo_1st_followups_sent</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context143');toggle('message143');toggle('full_message143')" ><span id='message143' style='display:block' >Unprotected mass assignment near line 197: EventInterface.new_event(&quot;lead_id&quot; =&gt; ((local target)[0]),...</span><span id='full_message143' style='display:none'>Unprotected mass assignment near line 197: EventInterface.new_event(&quot;lead_id&quot; =&gt; ((local target)[0]), &quot;filed_under&quot; =&gt; &quot;1st conv followup email sent&quot;, &quot;notes&quot; =&gt; &quot;automatically sent first conversation followup email&quot;, &quot;quote_id&quot; =&gt; ((local target)[4]), &quot;user_id&quot; =&gt; 1).update_attributes(<span class="user_input">EventInterface.new_attributes_from_filed_under[&quot;2nd conv followup email sent&quot;]</span>)</span><table id='context143' class='context' style='display:none'><caption>app/models/remindinator.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>192</pre>
          </td>
          <td class='context'>
            <pre class='context'>        'filed_under' =&gt; '1st conv followup email sent',</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>193</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'notes'       =&gt; 'automatically sent first conversation followup email',</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>194</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'quote_id'    =&gt; target[4],</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>195</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'user_id'     =&gt; 1})</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>197</pre>
            </td>
            <td class='context'>
              <pre class='context'>      event.update_attributes(EventInterface.new_attributes_from_filed_under['2nd conv followup email sent'])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>198</pre>
            </td>
            <td class='context'>
              <pre class='context'>      event.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>199</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>201</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>RemindinatorsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context50');toggle('message50');toggle('full_message50')" >Unprotected mass assignment near line 37: Remindinator.new(<span class="user_input">params[:remindinator]</span>)<table id='context50' class='context' style='display:none'><caption>app/controllers/remindinators_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /remindinators</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /remindinators.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @remindinator = Remindinator.new(params[:remindinator])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @remindinator.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Remindinator was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to remindinator_url(@remindinator) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>RemindinatorsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context126');toggle('message126');toggle('full_message126')" ><span id='message126' style='display:block' >Unprotected mass assignment near line 57: Remindinator.find(params[:id]).update_attributes(params[:re...</span><span id='full_message126' style='display:none'>Unprotected mass assignment near line 57: Remindinator.find(params[:id]).update_attributes(<span class="user_input">params[:remindinator]</span>)</span><table id='context126' class='context' style='display:none'><caption>app/controllers/remindinators_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /remindinators/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @remindinator = Remindinator.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @remindinator.update_attributes(params[:remindinator])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Remindinator was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to remindinator_url(@remindinator) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ReportsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context51');toggle('message51');toggle('full_message51')" >Unprotected mass assignment near line 501: Report.new(<span class="user_input">params[:report]</span>)<table id='context51' class='context' style='display:none'><caption>app/controllers/reports_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>496</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>498</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /reports</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>499</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /reports.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>500</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>501</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @report = Report.new(params[:report])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>503</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>504</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @report.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>505</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Report was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>506</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to report_url(@report) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ReportsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context127');toggle('message127');toggle('full_message127')" ><span id='message127' style='display:block' >Unprotected mass assignment near line 521: Report.find(params[:id]).update_attributes(<span class="user_input">params[:report]</span>...</span><span id='full_message127' style='display:none'>Unprotected mass assignment near line 521: Report.find(params[:id]).update_attributes(<span class="user_input">params[:report]</span>)</span><table id='context127' class='context' style='display:none'><caption>app/controllers/reports_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>516</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /reports/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>517</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>518</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @report = Report.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>520</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>521</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @report.update_attributes(params[:report])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>522</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Report was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>523</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to report_url(@report) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>524</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>525</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>526</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>RoomsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context52');toggle('message52');toggle('full_message52')" >Unprotected mass assignment near line 39: Room.new(<span class="user_input">params[:room]</span>)<table id='context52' class='context' style='display:none'><caption>app/controllers/rooms_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>34</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /rooms</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /rooms.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @room = Room.new(params[:room])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @room.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = @room.name+' was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to new_room_url }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>RoomsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context128');toggle('message128');toggle('full_message128')" >Unprotected mass assignment near line 59: Room.find(params[:id]).update_attributes(<span class="user_input">params[:room]</span>)<table id='context128' class='context' style='display:none'><caption>app/controllers/rooms_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>54</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /rooms/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @room = Room.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @room.update_attributes(params[:room])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Room was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to room_url(@room) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SentEmailsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context53');toggle('message53');toggle('full_message53')" >Unprotected mass assignment near line 65: SentEmail.new(<span class="user_input">params[:sent_email]</span>)<table id='context53' class='context' style='display:none'><caption>app/controllers/sent_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>60</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /sent_emails</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /sent_emails.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sent_email = SentEmail.new(params[:sent_email])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @sent_email.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'SentEmail was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to sent_email_url(@sent_email) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SentEmailsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context129');toggle('message129');toggle('full_message129')" ><span id='message129' style='display:block' >Unprotected mass assignment near line 85: SentEmail.find(params[:id]).update_attributes(params[:sent_...</span><span id='full_message129' style='display:none'>Unprotected mass assignment near line 85: SentEmail.find(params[:id]).update_attributes(<span class="user_input">params[:sent_email]</span>)</span><table id='context129' class='context' style='display:none'><caption>app/controllers/sent_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>80</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /sent_emails/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sent_email = SentEmail.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @sent_email.update_attributes(params[:sent_email])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'SentEmail was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to sent_email_url(@sent_email) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SignaturesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context54');toggle('message54');toggle('full_message54')" >Unprotected mass assignment near line 48: Signature.new(<span class="user_input">params[:signature]</span>)<table id='context54' class='context' style='display:none'><caption>app/controllers/signatures_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>43</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /signatures</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /signatures.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @signature = Signature.new(params[:signature])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @signature.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Signature was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to signature_url(@signature) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SmsMessagesController</td>
    <td>send_sms</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context55');toggle('message55');toggle('full_message55')" >Unprotected mass assignment near line 10: SmsMessage.new(<span class="user_input">params[:sms_message]</span>)<table id='context55' class='context' style='display:none'><caption>app/controllers/sms_messages_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>8</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def send_sms</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sms_message = SmsMessage.new(params[:sms_message])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @sms_message.handle_and_record_send</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead = Lead.find(@sms_message.lead_id)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @quote = Quote.find(@sms_message.quote_id)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @user = User.find(@sms_message.user_id)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SmsMessagesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context56');toggle('message56');toggle('full_message56')" >Unprotected mass assignment near line 88: SmsMessage.new(<span class="user_input">params[:sms_message]</span>)<table id='context56' class='context' style='display:none'><caption>app/controllers/sms_messages_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>83</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /sms_messages</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /sms_messages.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sms_message = SmsMessage.new(params[:sms_message])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @sms_message.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'SmsMessage was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to sms_message_url(@sms_message) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SmsMessagesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context130');toggle('message130');toggle('full_message130')" ><span id='message130' style='display:block' >Unprotected mass assignment near line 108: SmsMessage.find(params[:id]).update_attributes(params[:sms...</span><span id='full_message130' style='display:none'>Unprotected mass assignment near line 108: SmsMessage.find(params[:id]).update_attributes(<span class="user_input">params[:sms_message]</span>)</span><table id='context130' class='context' style='display:none'><caption>app/controllers/sms_messages_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>103</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /sms_messages/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sms_message = SmsMessage.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @sms_message.update_attributes(params[:sms_message])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'SmsMessage was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to sms_message_url(@sms_message) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SmsTemplatesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context57');toggle('message57');toggle('full_message57')" >Unprotected mass assignment near line 58: SmsTemplate.new(<span class="user_input">params[:sms_template]</span>)<table id='context57' class='context' style='display:none'><caption>app/controllers/sms_templates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>53</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /sms_templates</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /sms_templates.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sms_template = SmsTemplate.new(params[:sms_template])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sms_template.quote_included = {'yes' =&gt; true, 'no' =&gt; false}[params[:quote_included]]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sms_template.outcomes = params[:outcomes].keys.join(', ') unless params[:outcomes].nil?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>#    breakpoint</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SmsTemplatesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context131');toggle('message131');toggle('full_message131')" ><span id='message131' style='display:block' >Unprotected mass assignment near line 85: SmsTemplate.find(params[:id]).update_attributes(params[:sms...</span><span id='full_message131' style='display:none'>Unprotected mass assignment near line 85: SmsTemplate.find(params[:id]).update_attributes(<span class="user_input">params[:sms_template]</span>)</span><table id='context131' class='context' style='display:none'><caption>app/controllers/sms_templates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>80</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @sms_template = SmsTemplate.find(params[:id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @sms_template.quote_included = {'yes' =&gt; true, 'no' =&gt; false}[params[:quote_included]]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @sms_template.outcomes = params[:outcomes].keys.join(', ') unless params[:outcomes].nil?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @sms_template.update_attributes(params[:sms_template])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'SmsTemplate was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to sms_templates_path }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SmtpSettingsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context132');toggle('message132');toggle('full_message132')" ><span id='message132' style='display:block' >Unprotected mass assignment near line 65: SmtpSetting.initialized_smtp_setting.update_attributes(para...</span><span id='full_message132' style='display:none'>Unprotected mass assignment near line 65: SmtpSetting.initialized_smtp_setting.update_attributes(<span class="user_input">params[:smtp_setting]</span>)</span><table id='context132' class='context' style='display:none'><caption>app/controllers/smtp_settings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>60</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # POST /smtp_settings.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @smtp_setting = SmtpSetting.initialized_smtp_setting</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @smtp_setting.update_attributes(params[:smtp_setting])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'SmtpSetting was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to smtp_settings_url }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :created, :location =&gt; smtp_setting_url(@smtp_setting) }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;new&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>SmtpSettingsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context133');toggle('message133');toggle('full_message133')" ><span id='message133' style='display:block' >Unprotected mass assignment near line 82: SmtpSetting.find(params[:id]).update_attributes(params[:smt...</span><span id='full_message133' style='display:none'>Unprotected mass assignment near line 82: SmtpSetting.find(params[:id]).update_attributes(<span class="user_input">params[:smtp_setting]</span>)</span><table id='context133' class='context' style='display:none'><caption>app/controllers/smtp_settings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>77</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /smtp_settings/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @smtp_setting = SmtpSetting.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @smtp_setting.update_attributes(params[:smtp_setting])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'SmtpSetting was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to smtp_settings_url }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>UndigestibleEmailsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context58');toggle('message58');toggle('full_message58')" >Unprotected mass assignment near line 85: UndigestibleEmail.new(<span class="user_input">params[:undigestible_email]</span>)<table id='context58' class='context' style='display:none'><caption>app/controllers/undigestible_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>80</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /undigestible_emails</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /undigestible_emails.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @undigestible_email = UndigestibleEmail.new(params[:undigestible_email])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @undigestible_email.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'UndigestibleEmail was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to undigestible_email_url(@undigestible_email) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>UndigestibleEmailsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context134');toggle('message134');toggle('full_message134')" ><span id='message134' style='display:block' >Unprotected mass assignment near line 105: UndigestibleEmail.find(params[:id]).update_attributes(para...</span><span id='full_message134' style='display:none'>Unprotected mass assignment near line 105: UndigestibleEmail.find(params[:id]).update_attributes(<span class="user_input">params[:undigestible_email]</span>)</span><table id='context134' class='context' style='display:none'><caption>app/controllers/undigestible_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>100</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /undigestible_emails/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @undigestible_email = UndigestibleEmail.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @undigestible_email.update_attributes(params[:undigestible_email])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'UndigestibleEmail was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to undigestible_email_url(@undigestible_email) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>UsersController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context135');toggle('message135');toggle('full_message135')" >Unprotected mass assignment near line 110: User.find(params[:id]).update_attributes(<span class="user_input">params[:user]</span>)<table id='context135' class='context' style='display:none'><caption>app/controllers/users_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>105</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /users/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @user = User.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @user.update_attributes(params[:user]) and @user.update_attributes({'signature' =&gt; params[:signature]})</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'User was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to '/users/show/'+@user.id.to_s }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ZipCodesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context60');toggle('message60');toggle('full_message60')" >Unprotected mass assignment near line 57: ZipCode.new(<span class="user_input">params[:zip_code]</span>)<table id='context60' class='context' style='display:none'><caption>app/controllers/zip_codes_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /zip_codes</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /zip_codes.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @zip_code = ZipCode.new(params[:zip_code])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @zip_code.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'ZipCode was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to zip_code_url(@zip_code) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ZipCodesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context136');toggle('message136');toggle('full_message136')" ><span id='message136' style='display:block' >Unprotected mass assignment near line 77: ZipCode.find(params[:id]).update_attributes(params[:zip_cod...</span><span id='full_message136' style='display:none'>Unprotected mass assignment near line 77: ZipCode.find(params[:id]).update_attributes(<span class="user_input">params[:zip_code]</span>)</span><table id='context136' class='context' style='display:none'><caption>app/controllers/zip_codes_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>72</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # PUT /zip_codes/1.xml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @zip_code = ZipCode.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @zip_code.update_attributes(params[:zip_code])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'ZipCode was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to zip_code_url(@zip_code) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context174');toggle('message174');toggle('full_message174')" ><span id='message174' style='display:block' >Possible unprotected redirect near line 55: redirect_to(&quot;/jobs/show?job_type_id=#{CreditCard.new(para...</span><span id='full_message174' style='display:none'>Possible unprotected redirect near line 55: redirect_to(&quot;/jobs/show?job_type_id=#{<span class="user_input">CreditCard.new(params[:credit_card])</span>.job_id}&quot;)</span><table id='context174' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>50</pre>
          </td>
          <td class='context'>
            <pre class='context'>      if @credit_card.save</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'CreditCard was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>        case @credit_card.job_type</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>          Job.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>          FixedpriceJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>          MiscJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context175');toggle('message175');toggle('full_message175')" ><span id='message175' style='display:block' >Possible unprotected redirect near line 58: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{CreditCa...</span><span id='full_message175' style='display:none'>Possible unprotected redirect near line 58: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{<span class="user_input">CreditCard.new(params[:credit_card])</span>.job_id}&quot;)</span><table id='context175' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>53</pre>
          </td>
          <td class='context'>
            <pre class='context'>        when &quot;Job Hourly&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>          Job.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>          FixedpriceJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>          MiscJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/misc_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>        #format.html { redirect_to &quot;/leads/#{@credit_card.lead_id};show&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context176');toggle('message176');toggle('full_message176')" ><span id='message176' style='display:block' >Possible unprotected redirect near line 61: redirect_to(&quot;/misc_jobs/show?job_type_id=#{CreditCard.new...</span><span id='full_message176' style='display:none'>Possible unprotected redirect near line 61: redirect_to(&quot;/misc_jobs/show?job_type_id=#{<span class="user_input">CreditCard.new(params[:credit_card])</span>.job_id}&quot;)</span><table id='context176' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>56</pre>
          </td>
          <td class='context'>
            <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>          FixedpriceJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>          MiscJob.update(@credit_card.job_id, :credit_card_id =&gt; @credit_card.id)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/misc_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>        #format.html { redirect_to &quot;/leads/#{@credit_card.lead_id};show&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :created, :location =&gt; credit_card_url(@credit_card) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @form_mode = 'encrypted'</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context177');toggle('message177');toggle('full_message177')" ><span id='message177' style='display:block' >Possible unprotected redirect near line 83: redirect_to(&quot;/jobs/show?job_type_id=#{CreditCard.find(par...</span><span id='full_message177' style='display:none'>Possible unprotected redirect near line 83: redirect_to(&quot;/jobs/show?job_type_id=#{<span class="user_input">CreditCard.find(params[:id])</span>.job_id}&quot;)</span><table id='context177' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>78</pre>
          </td>
          <td class='context'>
            <pre class='context'>    respond_to do |format|</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @credit_card.update_attributes(params[:credit_card])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'CreditCard was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>        case @credit_card.job_type</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/misc_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context178');toggle('message178');toggle('full_message178')" ><span id='message178' style='display:block' >Possible unprotected redirect near line 85: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{CreditCa...</span><span id='full_message178' style='display:none'>Possible unprotected redirect near line 85: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{<span class="user_input">CreditCard.find(params[:id])</span>.job_id}&quot;)</span><table id='context178' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>80</pre>
          </td>
          <td class='context'>
            <pre class='context'>        flash[:notice] = 'CreditCard was successfully updated.'</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>        case @credit_card.job_type</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/misc_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>CreditCardsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context179');toggle('message179');toggle('full_message179')" ><span id='message179' style='display:block' >Possible unprotected redirect near line 87: redirect_to(&quot;/misc_jobs/show?job_type_id=#{CreditCard.fin...</span><span id='full_message179' style='display:none'>Possible unprotected redirect near line 87: redirect_to(&quot;/misc_jobs/show?job_type_id=#{<span class="user_input">CreditCard.find(params[:id])</span>.job_id}&quot;)</span><table id='context179' class='context' style='display:none'><caption>app/controllers/credit_cards_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>82</pre>
          </td>
          <td class='context'>
            <pre class='context'>        when &quot;Job Hourly&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/misc_jobs/show?job_type_id=#{@credit_card.job_id}&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @form_mode = 'encrypted'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnConfirmationLettersController</td>
    <td>manual_email</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context180');toggle('message180');toggle('full_message180')" ><span id='message180' style='display:block' >Possible unprotected redirect near line 34: redirect_to(&quot;/leads/#{DnConfirmationLetter.create_from_co...</span><span id='full_message180' style='display:none'>Possible unprotected redirect near line 34: redirect_to(&quot;/leads/#{<span class="user_input">DnConfirmationLetter.create_from_confirmation_letter_template(ConfirmationLetterTemplate.find(params[:etid]), Lead.find(params[:lead_id]), MiscJob.find(params[:job_id]), User.find(params[:user_id]))</span>.lead_id};show&quot;)</span><table id='context180' class='context' style='display:none'><caption>app/controllers/dn_confirmation_letters_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>29</pre>
          </td>
          <td class='context'>
            <pre class='context'>        end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>        message +=  &quot;Email did not save updates; validation errors were: #{@dn_email.errors.full_messages.join(', ')}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash[:notice] = message</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to &quot;/leads/#{@dn_email.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @dn_email.set_status('created from email template')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @dn_email.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; 'manual_edit'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnConfirmationLettersController</td>
    <td>manual_update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context181');toggle('message181');toggle('full_message181')" ><span id='message181' style='display:block' >Possible unprotected redirect near line 71: redirect_to(&quot;/leads/#{DnConfirmationLetter.find(params[:d...</span><span id='full_message181' style='display:none'>Possible unprotected redirect near line 71: redirect_to(&quot;/leads/#{<span class="user_input">DnConfirmationLetter.find(params[:dn_email_id])</span>.lead_id};show&quot;)</span><table id='context181' class='context' style='display:none'><caption>app/controllers/dn_confirmation_letters_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>66</pre>
          </td>
          <td class='context'>
            <pre class='context'>      end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #      MailSender.deliver_send_mail(@dn_email)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash[:notice] = message</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to &quot;/leads/#{@dn_email.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @dn_email.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; &quot;manual_preview&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnConfirmationLettersController</td>
    <td>outbox_update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context182');toggle('message182');toggle('full_message182')" ><span id='message182' style='display:block' >Possible unprotected redirect near line 166: redirect_to(((&quot;&quot; or &quot;/dn_confirmation_letters/outbox_pre...</span><span id='full_message182' style='display:none'>Possible unprotected redirect near line 166: redirect_to(((&quot;&quot; or &quot;/dn_confirmation_letters/outbox_preview?dn_confirmation_letter_id=#{<span class="user_input">DnConfirmationLetter.find(params[:dn_confirmation_letter_id])</span>.id}&quot;) or &quot;/dn_confirmation_letters/outbox&quot;))</span><table id='context182' class='context' style='display:none'><caption>app/controllers/dn_confirmation_letters_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>161</pre>
          </td>
          <td class='context'>
            <pre class='context'>      elsif params[:commit] == &quot;Save and return to Outbox&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>162</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_url = &quot;/dn_confirmation_letters/outbox&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>163</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>164</pre>
            </td>
            <td class='context'>
              <pre class='context'>        raise &quot;unexpected commit received: #{params[:commit]}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>165</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>166</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to redirect_url</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>167</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>168</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; &quot;outbox_edit&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>169</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>170</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnEmailsController</td>
    <td>manual_email</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context183');toggle('message183');toggle('full_message183')" ><span id='message183' style='display:block' >Possible unprotected redirect near line 27: redirect_to(&quot;/leads/#{DnEmail.create_from_email_template(...</span><span id='full_message183' style='display:none'>Possible unprotected redirect near line 27: redirect_to(&quot;/leads/#{<span class="user_input">DnEmail.create_from_email_template(EmailTemplate.find((if (params[:etid_key] == &quot;all&quot;) then   params[:etid][:all] else   params[:etid][:status_based] end)), Lead.find(params[:lead_id]), Quote.find(params[:quote_id]), User.find(params[:user_id]))</span>.lead_id};show&quot;)</span><table id='context183' class='context' style='display:none'><caption>app/controllers/dn_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>22</pre>
          </td>
          <td class='context'>
            <pre class='context'>        end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>        message +=  &quot;Email did not save updates; validation errors were: #{@dn_email.errors.full_messages.join(', ')}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash[:notice] = message</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to &quot;/leads/#{@dn_email.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @dn_email.set_status('created from email template')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @dn_email.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; 'manual_edit'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnEmailsController</td>
    <td>manual_update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context184');toggle('message184');toggle('full_message184')" ><span id='message184' style='display:block' >Possible unprotected redirect near line 61: redirect_to(&quot;/leads/#{<span class="user_input">DnEmail.find(params[:dn_email_id])</span>....</span><span id='full_message184' style='display:none'>Possible unprotected redirect near line 61: redirect_to(&quot;/leads/#{<span class="user_input">DnEmail.find(params[:dn_email_id])</span>.lead_id};show&quot;)</span><table id='context184' class='context' style='display:none'><caption>app/controllers/dn_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>56</pre>
          </td>
          <td class='context'>
            <pre class='context'>        end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>        message +=  &quot;Email did not save updates; validation errors were: #{@dn_email.errors.full_messages.join(', ')}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash[:notice] = message</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to &quot;/leads/#{@dn_email.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @dn_email.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; &quot;manual_preview&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnEmailsController</td>
    <td>outbox_update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context185');toggle('message185');toggle('full_message185')" ><span id='message185' style='display:block' >Possible unprotected redirect near line 156: redirect_to(((&quot;&quot; or &quot;/dn_emails/outbox_preview?dn_email_...</span><span id='full_message185' style='display:none'>Possible unprotected redirect near line 156: redirect_to(((&quot;&quot; or &quot;/dn_emails/outbox_preview?dn_email_id=#{<span class="user_input">DnEmail.find(params[:dn_email_id])</span>.id}&quot;) or outbox_url))</span><table id='context185' class='context' style='display:none'><caption>app/controllers/dn_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>151</pre>
          </td>
          <td class='context'>
            <pre class='context'>      elsif params[:commit] == &quot;Save and return to Outbox&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_url = outbox_url</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>153</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>        raise &quot;unexpected commit received: #{params[:commit]}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>155</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>156</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to redirect_url</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>157</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>158</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; &quot;outbox_edit&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>159</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>160</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>FixedpriceJobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context186');toggle('message186');toggle('full_message186')" ><span id='message186' style='display:block' >Possible unprotected redirect near line 252: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{Fixedpr...</span><span id='full_message186' style='display:none'>Possible unprotected redirect near line 252: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{<span class="user_input">FixedpriceJob.find(params[:fixedprice_job][:id])</span>.id}&quot;)</span><table id='context186' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>247</pre>
          </td>
          <td class='context'>
            <pre class='context'>    end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>250</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @job_up.save</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>251</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash[:notice] = &quot;Edit Success&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>252</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{@job_up.id}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>253</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>254</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; 'edit'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>255</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>257</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>FixedpriceJobsController</td>
    <td>delete</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context187');toggle('message187');toggle('full_message187')" ><span id='message187' style='display:block' >Possible unprotected redirect near line 319: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{Fixedpr...</span><span id='full_message187' style='display:none'>Possible unprotected redirect near line 319: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{<span class="user_input">FixedpriceJob.find(:all, :conditions =&gt; ([&quot;job_project_id = ?&quot;, FixedpriceJob.find(params[:job_id]).job_project_id]))</span>.last.id}&quot;)</span><table id='context187' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>315</pre>
          </td>
          <td class='context'>
            <pre class='context'>      a_jobs = FixedpriceJob.find(:all, :conditions =&gt; [&quot;job_project_id = ?&quot;, p_id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>317</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if !a_jobs.blank? &amp;&amp; params[:from] != 'lead'</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>318</pre>
            </td>
            <td class='context'>
              <pre class='context'>        j_show = a_jobs.last.id</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>319</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{j_show}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>320</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>321</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/leads/#{l_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>322</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>FixedpriceJobsController</td>
    <td>delete</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context188');toggle('message188');toggle('full_message188')" ><span id='message188' style='display:block' >Possible unprotected redirect near line 321: redirect_to(&quot;/leads/#{FixedpriceJob.find(params[:job_id]...</span><span id='full_message188' style='display:none'>Possible unprotected redirect near line 321: redirect_to(&quot;/leads/#{<span class="user_input">FixedpriceJob.find(params[:job_id])</span>.lead_id};show&quot;)</span><table id='context188' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>317</pre>
          </td>
          <td class='context'>
            <pre class='context'>      if !a_jobs.blank? &amp;&amp; params[:from] != 'lead'</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>318</pre>
            </td>
            <td class='context'>
              <pre class='context'>        j_show = a_jobs.last.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>319</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{j_show}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>320</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>321</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/leads/#{l_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>322</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>325</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>326</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise &quot;Job ID not found!! &quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>InventoriesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context189');toggle('message189');toggle('full_message189')" ><span id='message189' style='display:block' >Possible unprotected redirect near line 94: redirect_to(&quot;/leads/#{Inventory.find(:first, :conditions ...</span><span id='full_message189' style='display:none'>Possible unprotected redirect near line 94: redirect_to(&quot;/leads/#{<span class="user_input">Inventory.find(:first, :conditions =&gt; ([&quot;lead_id = ? and purpose is null&quot;, params[:inventory][:lead_id]]))</span>.lead_id};show&quot;)</span><table id='context189' class='context' style='display:none'><caption>app/controllers/inventories_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>89</pre>
          </td>
          <td class='context'>
            <pre class='context'>      @inventory.update_by_form(params)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #breakpoint &quot;updated_by_form&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>      respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if @inventory.save</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>          add_to_general_messages 'Inventory was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/leads/#{@inventory.lead_id};show&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>          add_to_problem_messages 'There were some problems with you inventory'</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/leads/#{@inventory.lead_id};show&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.xml  { render :xml =&gt; @inventory.errors.to_xml }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>InventoriesController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context190');toggle('message190');toggle('full_message190')" ><span id='message190' style='display:block' >Possible unprotected redirect near line 98: redirect_to(&quot;/leads/#{Inventory.find(:first, :conditions ...</span><span id='full_message190' style='display:none'>Possible unprotected redirect near line 98: redirect_to(&quot;/leads/#{<span class="user_input">Inventory.find(:first, :conditions =&gt; ([&quot;lead_id = ? and purpose is null&quot;, params[:inventory][:lead_id]]))</span>.lead_id};show&quot;)</span><table id='context190' class='context' style='display:none'><caption>app/controllers/inventories_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>93</pre>
          </td>
          <td class='context'>
            <pre class='context'>          add_to_general_messages 'Inventory was successfully updated.'</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/leads/#{@inventory.lead_id};show&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>          add_to_problem_messages 'There were some problems with you inventory'</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.html { redirect_to &quot;/leads/#{@inventory.lead_id};show&quot; }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>          format.xml  { render :xml =&gt; @inventory.errors.to_xml }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>       @inventory = Inventory.find(:first, :conditions =&gt; [&quot;purpose = ? and purpose_type = ?&quot;, params[:job_type_id], params[:job_type]])</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobReferencesController</td>
    <td>set_references_for_lead</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context191');toggle('message191');toggle('full_message191')" ><span id='message191' style='display:block' >Possible unprotected redirect near line 17: redirect_to(&quot;/leads/#{<span class="user_input">Lead.find(params[:lead_id])</span>.id};sho...</span><span id='full_message191' style='display:none'>Possible unprotected redirect near line 17: redirect_to(&quot;/leads/#{<span class="user_input">Lead.find(params[:lead_id])</span>.id};show&quot;)</span><table id='context191' class='context' style='display:none'><caption>app/controllers/job_references_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>13</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def set_references_for_lead</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead = Lead.find(params[:lead_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead.autoset_references</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to &quot;/leads/#{@lead.id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def select_for_lead</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;entered select_for_lead&quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobReferencesController</td>
    <td>assign_for_lead</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context192');toggle('message192');toggle('full_message192')" ><span id='message192' style='display:block' >Possible unprotected redirect near line 37: redirect_to(&quot;/leads/#{<span class="user_input">Lead.find(params[:lead_id])</span>.id};sho...</span><span id='full_message192' style='display:none'>Possible unprotected redirect near line 37: redirect_to(&quot;/leads/#{<span class="user_input">Lead.find(params[:lead_id])</span>.id};show&quot;)</span><table id='context192' class='context' style='display:none'><caption>app/controllers/job_references_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>    when 2</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_2_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when 3</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_3_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to &quot;/leads/#{@lead.id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /job_references</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /job_references.xml</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def index</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>delete_note</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context193');toggle('message193');toggle('full_message193')" ><span id='message193' style='display:block' >Possible unprotected redirect near line 103: redirect_to(&quot;/jobs/show?job_type_id=#{Note.find(params[:...</span><span id='full_message193' style='display:none'>Possible unprotected redirect near line 103: redirect_to(&quot;/jobs/show?job_type_id=#{<span class="user_input">Note.find(params[:note_id])</span>.job_id}&quot;, :job_type =&gt; (<span class="user_input">Note.find(params[:note_id])</span>.job_type))</span><table id='context193' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>98</pre>
          </td>
          <td class='context'>
            <pre class='context'>  #Deleting of notes for jobs are handled here</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def delete_note</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>    note = Note.find(params[:note_id])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if note.destroy</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if note.job_type == &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/jobs/show?job_type_id=#{note.job_id}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>      elsif note.job_type == &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{note.job_id}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/misc_jobs/show?job_type_id=#{note.job_id}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>delete_note</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context194');toggle('message194');toggle('full_message194')" ><span id='message194' style='display:block' >Possible unprotected redirect near line 105: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{Note.fi...</span><span id='full_message194' style='display:none'>Possible unprotected redirect near line 105: redirect_to(&quot;/fixedprice_jobs/show?job_type_id=#{<span class="user_input">Note.find(params[:note_id])</span>.job_id}&quot;, :job_type =&gt; (<span class="user_input">Note.find(params[:note_id])</span>.job_type))</span><table id='context194' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>100</pre>
          </td>
          <td class='context'>
            <pre class='context'>    note = Note.find(params[:note_id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if note.destroy</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if note.job_type == &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/jobs/show?job_type_id=#{note.job_id}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>      elsif note.job_type == &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{note.job_id}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/misc_jobs/show?job_type_id=#{note.job_id}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>delete_note</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context195');toggle('message195');toggle('full_message195')" ><span id='message195' style='display:block' >Possible unprotected redirect near line 107: redirect_to(&quot;/misc_jobs/show?job_type_id=#{Note.find(par...</span><span id='full_message195' style='display:none'>Possible unprotected redirect near line 107: redirect_to(&quot;/misc_jobs/show?job_type_id=#{<span class="user_input">Note.find(params[:note_id])</span>.job_id}&quot;, :job_type =&gt; (<span class="user_input">Note.find(params[:note_id])</span>.job_type))</span><table id='context195' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>102</pre>
          </td>
          <td class='context'>
            <pre class='context'>      if note.job_type == &quot;Job Hourly&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/jobs/show?job_type_id=#{note.job_id}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>      elsif note.job_type == &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/fixedprice_jobs/show?job_type_id=#{note.job_id}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/misc_jobs/show?job_type_id=#{note.job_id}&quot;, :job_type =&gt; note.job_type</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>delete</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context196');toggle('message196');toggle('full_message196')" ><span id='message196' style='display:block' >Possible unprotected redirect near line 145: redirect_to(&quot;/jobs/show?job_type_id=#{Job.find(:all, :co...</span><span id='full_message196' style='display:none'>Possible unprotected redirect near line 145: redirect_to(&quot;/jobs/show?job_type_id=#{<span class="user_input">Job.find(:all, :conditions =&gt; ([&quot;job_project_id = ?&quot;, Job.find(params[:job_id]).job_project_id]))</span>.last.id}&quot;)</span><table id='context196' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>141</pre>
          </td>
          <td class='context'>
            <pre class='context'>      a_jobs = Job.find(:all, :conditions =&gt; [&quot;job_project_id = ?&quot;, p_id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>143</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if !a_jobs.blank? &amp;&amp; params[:from] != 'lead'</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>144</pre>
            </td>
            <td class='context'>
              <pre class='context'>        j_show = a_jobs.last.id</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>145</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/jobs/show?job_type_id=#{j_show}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>146</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>147</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/leads/#{l_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>149</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise &quot;Job ID not found!! &quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>delete</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context197');toggle('message197');toggle('full_message197')" ><span id='message197' style='display:block' >Possible unprotected redirect near line 147: redirect_to(&quot;/leads/#{<span class="user_input">Job.find(params[:job_id])</span>.lead_id}...</span><span id='full_message197' style='display:none'>Possible unprotected redirect near line 147: redirect_to(&quot;/leads/#{<span class="user_input">Job.find(params[:job_id])</span>.lead_id};show&quot;)</span><table id='context197' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>143</pre>
          </td>
          <td class='context'>
            <pre class='context'>      if !a_jobs.blank? &amp;&amp; params[:from] != 'lead'</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>144</pre>
            </td>
            <td class='context'>
              <pre class='context'>        j_show = a_jobs.last.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>145</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/jobs/show?job_type_id=#{j_show}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>146</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>147</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/leads/#{l_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>149</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise &quot;Job ID not found!! &quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>151</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context198');toggle('message198');toggle('full_message198')" ><span id='message198' style='display:block' >Possible unprotected redirect near line 409: redirect_to(&quot;/jobs/show?job_type_id=#{Job.find(params[:j...</span><span id='full_message198' style='display:none'>Possible unprotected redirect near line 409: redirect_to(&quot;/jobs/show?job_type_id=#{<span class="user_input">Job.find(params[:job][:id])</span>.id}&quot;)</span><table id='context198' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>407</pre>
          </td>
          <td class='context'>
            <pre class='context'>    if @job_up.save</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>408</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash[:notice] = &quot;Edit Success&quot;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>409</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to &quot;/jobs/show?job_type_id=#{@job_up.id}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>410</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>411</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; 'edit'</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>412</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>414</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>change_service_location</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context199');toggle('message199');toggle('full_message199')" >Possible unprotected redirect near line 28: redirect_to(&quot;/leads/#{<span class="user_input">Lead.find(params[:id])</span>.id};show&quot;)<table id='context199' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>23</pre>
          </td>
          <td class='context'>
            <pre class='context'>    if @lead.save</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>      add_to_general_messages('This lead has been reassigned to '+@new_service_location.name)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>      add_to_problem_messages('Unable to reassign.  Lead errors were: '+@lead.errors.full_messages.join(', '))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to &quot;/leads/#{@lead.id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def perform_merge</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @primary_lead = Lead.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @other_lead = Lead.find(params[:merge][:other_lead_id])</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>perform_merge</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context200');toggle('message200');toggle('full_message200')" >Possible unprotected redirect near line 60: redirect_to(&quot;/leads/#{<span class="user_input">Lead.find(params[:id])</span>.id};show&quot;)<table id='context200' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>55</pre>
          </td>
          <td class='context'>
            <pre class='context'>      end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      add_to_problem_messages('Merge failed.  Other lead has NOT been destroyed, and an event has NOT been created Primary lead error messages were: '+@primary_lead.errors.full_messages.join(', '))</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to &quot;/leads/#{@primary_lead.id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def batch_operation</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context201');toggle('message201');toggle('full_message201')" >Possible unprotected redirect near line 162: redirect_to(&quot;/leads/#{<span class="user_input">Lead.initialized_lead</span>.id};show&quot;)<table id='context201' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>157</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @lead = Lead.initialized_lead</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>158</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead.update_by_form(params[:lead])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>160</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @lead.save</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>161</pre>
            </td>
            <td class='context'>
              <pre class='context'>      add_to_general_messages('Your new lead was saved, and a quote was generated')</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>162</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to &quot;/leads/#{@lead.id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>163</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>164</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; &quot;new&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>165</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>167</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context202');toggle('message202');toggle('full_message202')" >Possible unprotected redirect near line 456: redirect_to(&quot;/leads/#{<span class="user_input">Lead.find(params[:id])</span>.id};show&quot;)<table id='context202' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>451</pre>
          </td>
          <td class='context'>
            <pre class='context'>    #raise &quot;lead.attributes looks like: #{Configurable.hash_to_string(@lead.attributes)}&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>453</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>454</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @lead.save</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>455</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Lead was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>456</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to &quot;/leads/#{@lead.id};show&quot; }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>457</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>458</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>459</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>460</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { render :xml =&gt; @lead.errors.to_xml }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>461</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>MiscJobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context203');toggle('message203');toggle('full_message203')" ><span id='message203' style='display:block' >Possible unprotected redirect near line 253: redirect_to(&quot;/misc_jobs/show?job_type_id=#{MiscJob.find(...</span><span id='full_message203' style='display:none'>Possible unprotected redirect near line 253: redirect_to(&quot;/misc_jobs/show?job_type_id=#{<span class="user_input">MiscJob.find(params[:misc_job][:id])</span>.id}&quot;)</span><table id='context203' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>248</pre>
          </td>
          <td class='context'>
            <pre class='context'>    end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>251</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @job_up.save</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>252</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash[:notice] = &quot;Edit Success&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>253</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to &quot;/misc_jobs/show?job_type_id=#{@job_up.id}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>254</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>255</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; 'edit'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>256</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>258</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>MiscJobsController</td>
    <td>delete</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context204');toggle('message204');toggle('full_message204')" ><span id='message204' style='display:block' >Possible unprotected redirect near line 323: redirect_to(&quot;/misc_jobs/show?job_type_id=#{MiscJob.find(...</span><span id='full_message204' style='display:none'>Possible unprotected redirect near line 323: redirect_to(&quot;/misc_jobs/show?job_type_id=#{<span class="user_input">MiscJob.find(:all, :conditions =&gt; ([&quot;job_project_id = ?&quot;, MiscJob.find(params[:job_id]).job_project_id]))</span>.last.id}&quot;)</span><table id='context204' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>319</pre>
          </td>
          <td class='context'>
            <pre class='context'>      a_jobs = MiscJob.find(:all, :conditions =&gt; [&quot;job_project_id = ?&quot;, p_id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>321</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if !a_jobs.blank? &amp;&amp; params[:from] != 'lead'</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>322</pre>
            </td>
            <td class='context'>
              <pre class='context'>        j_show = a_jobs.last.id</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>323</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/misc_jobs/show?job_type_id=#{j_show}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>324</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>325</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/leads/#{l_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>326</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>MiscJobsController</td>
    <td>delete</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context205');toggle('message205');toggle('full_message205')" ><span id='message205' style='display:block' >Possible unprotected redirect near line 325: redirect_to(&quot;/leads/#{<span class="user_input">MiscJob.find(params[:job_id])</span>.lead...</span><span id='full_message205' style='display:none'>Possible unprotected redirect near line 325: redirect_to(&quot;/leads/#{<span class="user_input">MiscJob.find(params[:job_id])</span>.lead_id};show&quot;)</span><table id='context205' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>321</pre>
          </td>
          <td class='context'>
            <pre class='context'>      if !a_jobs.blank? &amp;&amp; params[:from] != 'lead'</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>322</pre>
            </td>
            <td class='context'>
              <pre class='context'>        j_show = a_jobs.last.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>323</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/misc_jobs/show?job_type_id=#{j_show}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>324</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>325</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to &quot;/leads/#{l_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>326</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>329</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>330</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise &quot;Job ID not found!! &quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>QuotesController</td>
    <td>margin_compensator_old</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context206');toggle('message206');toggle('full_message206')" ><span id='message206' style='display:block' >Possible unprotected redirect near line 23: redirect_to(&quot;/leads/#{<span class="user_input">Lead.find(params[:lead_id])</span>.id};sho...</span><span id='full_message206' style='display:none'>Possible unprotected redirect near line 23: redirect_to(&quot;/leads/#{<span class="user_input">Lead.find(params[:lead_id])</span>.id};show&quot;)</span><table id='context206' class='context' style='display:none'><caption>app/controllers/quotes_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>18</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @quote = @lead.quotes.sort_by{|x| x.created_on}.reverse[0]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>    newquote = @quote.reproduce_by_margin_compensate(Configurable.get_config_value('estimating', 'threshold_profit_margin_in_percent'))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>    newquote.save</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to &quot;/leads/#{@lead.id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def margin_compensator</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>TasksController</td>
    <td>email_update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context207');toggle('message207');toggle('full_message207')" ><span id='message207' style='display:block' >Possible unprotected redirect near line 36: redirect_to(((&quot;&quot; or &quot;/tasks/email_preview?dn_email_id=#{D...</span><span id='full_message207' style='display:none'>Possible unprotected redirect near line 36: redirect_to(((&quot;&quot; or &quot;/tasks/email_preview?dn_email_id=#{<span class="user_input">DnEmail.find(params[:dn_email_id])</span>.id}&quot;) or &quot;/leads/#{<span class="user_input">DnEmail.find(params[:dn_email_id])</span>.lead_id};show&quot;))</span><table id='context207' class='context' style='display:none'><caption>app/controllers/tasks_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>31</pre>
          </td>
          <td class='context'>
            <pre class='context'>      elsif params[:commit] == &quot;Save and return to Lead&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_url = &quot;/leads/#{@dn_email.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>        raise &quot;unexpected commit received: #{params[:commit]}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>      redirect_to redirect_url</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :action =&gt; &quot;email_edit&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>TasksController</td>
    <td>auto_perform_task</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context208');toggle('message208');toggle('full_message208')" ><span id='message208' style='display:block' >Possible unprotected redirect near line 146: redirect_to(&quot;/leads/#{<span class="user_input">DnTask.find(params[:task_id])</span>.lead...</span><span id='full_message208' style='display:none'>Possible unprotected redirect near line 146: redirect_to(&quot;/leads/#{<span class="user_input">DnTask.find(params[:task_id])</span>.lead_id};show&quot;)</span><table id='context208' class='context' style='display:none'><caption>app/controllers/tasks_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>141</pre>
          </td>
          <td class='context'>
            <pre class='context'>      'failure' =&gt; 'Task autoperform failed.  Try again?',</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>142</pre>
            </td>
            <td class='context'>
              <pre class='context'>    }[result]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>144</pre>
            </td>
            <td class='context'>
              <pre class='context'>    add_to_general_messages(message)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>146</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to &quot;/leads/#{@task.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def save_new_event_for_task</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>TasksController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context209');toggle('message209');toggle('full_message209')" ><span id='message209' style='display:block' >Possible unprotected redirect near line 426: redirect_to(((((&quot;/leads/&quot; + DnTask.initialized_task(para...</span><span id='full_message209' style='display:none'>Possible unprotected redirect near line 426: redirect_to(((((&quot;/leads/&quot; + <span class="user_input">DnTask.initialized_task(params[:task][:flavor], Lead.find(params[:lead_id]), User.find(params[:task][:assigned_to_id]))</span>.lead_id.to_s) + &quot;;show&quot;) or &quot;/tasks/email_edit?dn_email_id=#{<span class="user_input">DnTask.initialized_task(params[:task][:flavor], Lead.find(params[:lead_id]), User.find(params[:task][:assigned_to_id]))</span>.dn_email.id}&quot;) or &quot;/tasks/#{<span class="user_input">DnTask.initialized_task(params[:task][:flavor], Lead.find(params[:lead_id]), User.find(params[:task][:assigned_to_id]))</span>.id}/edit?mode=edit_sms&amp;flavor=SmsTask&quot;))</span><table id='context209' class='context' style='display:none'><caption>app/controllers/tasks_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>421</pre>
          </td>
          <td class='context'>
            <pre class='context'>          redirect_url = &quot;/tasks/email_edit?dn_email_id=#{@task.dn_email.id}&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>422</pre>
            </td>
            <td class='context'>
              <pre class='context'>        when 'Save and Edit SMS'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>423</pre>
            </td>
            <td class='context'>
              <pre class='context'>          redirect_url = &quot;/tasks/#{@task.id}/edit?mode=edit_sms&amp;flavor=SmsTask&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>424</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>426</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html {redirect_to redirect_url}</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>427</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :created, :location =&gt; task_url(@task) }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>428</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>429</pre>
            </td>
            <td class='context'>
              <pre class='context'>        MyLogger.logthis('TasksController.create: task did NOT save successfully') if debug</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>430</pre>
            </td>
            <td class='context'>
              <pre class='context'>        session[:pending_task] = @task</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>431</pre>
            </td>
            <td class='context'>
              <pre class='context'>        raise &quot;task did not validate - errors are: &quot;+ @task.errors.full_messages.join('; ')</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>TasksController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context210');toggle('message210');toggle('full_message210')" ><span id='message210' style='display:block' >Possible unprotected redirect near line 462: redirect_to(&quot;/leads/#{<span class="user_input">DnTask.find(params[:id])</span>.lead_id};...</span><span id='full_message210' style='display:none'>Possible unprotected redirect near line 462: redirect_to(&quot;/leads/#{<span class="user_input">DnTask.find(params[:id])</span>.lead_id};show&quot;)</span><table id='context210' class='context' style='display:none'><caption>app/controllers/tasks_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>457</pre>
          </td>
          <td class='context'>
            <pre class='context'>        format.html {</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>458</pre>
            </td>
            <td class='context'>
              <pre class='context'>          case params[:mode]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>459</pre>
            </td>
            <td class='context'>
              <pre class='context'>          when nil</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>460</pre>
            </td>
            <td class='context'>
              <pre class='context'>            render_partial 'minimizable_task_show', 'task' =&gt; @task, 'container_div_id' =&gt; params[:container_div_id], 'mode' =&gt; 'minimized', 'message' =&gt; nil</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>461</pre>
            </td>
            <td class='context'>
              <pre class='context'>          when 'update_email'</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>462</pre>
            </td>
            <td class='context'>
              <pre class='context'>            redirect_to &quot;/leads/#{@task.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>463</pre>
            </td>
            <td class='context'>
              <pre class='context'>          when 'update_sms'</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>464</pre>
            </td>
            <td class='context'>
              <pre class='context'>            redirect_to &quot;/leads/#{@task.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>465</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>466</pre>
            </td>
            <td class='context'>
              <pre class='context'>        }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>467</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>TasksController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context211');toggle('message211');toggle('full_message211')" ><span id='message211' style='display:block' >Possible unprotected redirect near line 464: redirect_to(&quot;/leads/#{<span class="user_input">DnTask.find(params[:id])</span>.lead_id};...</span><span id='full_message211' style='display:none'>Possible unprotected redirect near line 464: redirect_to(&quot;/leads/#{<span class="user_input">DnTask.find(params[:id])</span>.lead_id};show&quot;)</span><table id='context211' class='context' style='display:none'><caption>app/controllers/tasks_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>459</pre>
          </td>
          <td class='context'>
            <pre class='context'>          when nil</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>460</pre>
            </td>
            <td class='context'>
              <pre class='context'>            render_partial 'minimizable_task_show', 'task' =&gt; @task, 'container_div_id' =&gt; params[:container_div_id], 'mode' =&gt; 'minimized', 'message' =&gt; nil</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>461</pre>
            </td>
            <td class='context'>
              <pre class='context'>          when 'update_email'</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>462</pre>
            </td>
            <td class='context'>
              <pre class='context'>            redirect_to &quot;/leads/#{@task.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>463</pre>
            </td>
            <td class='context'>
              <pre class='context'>          when 'update_sms'</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>464</pre>
            </td>
            <td class='context'>
              <pre class='context'>            redirect_to &quot;/leads/#{@task.lead_id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>465</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>466</pre>
            </td>
            <td class='context'>
              <pre class='context'>        }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>467</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>468</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>469</pre>
            </td>
            <td class='context'>
              <pre class='context'>        breakpoint &quot;@task didn't save: full error messages = &quot;+ @task.errors.full_messages.join(', ') if debug</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ApplicationController</td>
    <td>counter_and_timer</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context218');toggle('message218');toggle('full_message218')" ><span id='message218' style='display:block' >Possible SQL injection near line 22: Visit.find(:all, :conditions =&gt; (&quot;resource = '#{params[:controll...</span><span id='full_message218' style='display:none'>Possible SQL injection near line 22: Visit.find(:all, :conditions =&gt; (&quot;resource = '#{<span class="user_input">params[:controller]</span>.blank? ? (0) : (<span class="user_input">params[:controller]</span>)}/#{params[:action].blank? ? (0) : (params[:action])}/#{params[&quot;id&quot;].blank? ? (&quot;&quot;) : (&quot;displayPage&quot;)}'&quot;))</span><table id='context218' class='context' style='display:none'><caption>app/controllers/application.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>17</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @visit = Visit.create({:browser_agent =&gt; request.env['HTTP_USER_AGENT'],</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>                           :ip =&gt; request.remote_ip.to_s,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>                           :resource =&gt; &quot;#{params[:controller].blank? ? 0 : params[:controller] }/#{params[:action].blank? ? 0 : params[:action]}/#{id}&quot;})</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @visit_length = Visit.find(:all,</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>                               :conditions =&gt; &quot;resource = '#{params[:controller].blank? ? 0 : params[:controller] }/#{params[:action].blank? ? 0 : params[:action]}/#{id}'&quot;).length</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'> end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def get_autoincrement_div_id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if session[:highest_div_id]</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnConfirmationLettersController</td>
    <td>next_bunch</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context220');toggle('message220');toggle('full_message220')" ><span id='message220' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 128: DnConfi...</span><span id='full_message220' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 128: DnConfirmationLetter.find(:all, :limit =&gt; (params[:number].to_i), :offset =&gt; (params[:offset].to_i), :order =&gt; &quot;created_at DESC&quot;, :conditions =&gt; &quot;status like 'received%' or status like 'turned into%' or status = 'could not turn into lead' or status like 'keep%' or status = 'delete'&quot;)</span><table id='context220' class='context' style='display:none'><caption>app/controllers/dn_confirmation_letters_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>123</pre>
          </td>
          <td class='context'>
            <pre class='context'>    redirect_to &quot;/received&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>124</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def next_bunch</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise &quot;must pass in an offset&quot; if params[:offset].nil?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise &quot;must pass in a number&quot; if params[:number].nil?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @dn_emails = DnConfirmationLetter.find(:all, :limit =&gt; params[:number].to_i, :offset =&gt; params[:offset].to_i, :order =&gt; 'created_at DESC', :conditions =&gt; &quot;status like 'received%' or status like 'turned into%' or status = 'could not turn into lead' or status like 'keep%' or status = 'delete'&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render_partial('dn_emails/list',</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>      'dnes' =&gt; @dn_emails,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>      'next_offset' =&gt; params[:offset].to_i + params[:number].to_i,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>      'counter_starts_at' =&gt; params[:offset].to_i + 1</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>DnEmailsController</td>
    <td>next_bunch</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context222');toggle('message222');toggle('full_message222')" ><span id='message222' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 118: DnEmail...</span><span id='full_message222' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 118: DnEmail.find(:all, :limit =&gt; (params[:number].to_i), :offset =&gt; (params[:offset].to_i), :order =&gt; &quot;created_at DESC&quot;, :conditions =&gt; &quot;status like 'received%' or status like 'turned into%' or status = 'could not turn into lead' or status like 'keep%' or status = 'delete'&quot;)</span><table id='context222' class='context' style='display:none'><caption>app/controllers/dn_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>113</pre>
          </td>
          <td class='context'>
            <pre class='context'>    redirect_to &quot;/received&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def next_bunch</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise &quot;must pass in an offset&quot; if params[:offset].nil?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>117</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise &quot;must pass in a number&quot; if params[:number].nil?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @dn_emails = DnEmail.find(:all, :limit =&gt; params[:number].to_i, :offset =&gt; params[:offset].to_i, :order =&gt; 'created_at DESC', :conditions =&gt; &quot;status like 'received%' or status like 'turned into%' or status = 'could not turn into lead' or status like 'keep%' or status = 'delete'&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>120</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render_partial('dn_emails/list', </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>121</pre>
            </td>
            <td class='context'>
              <pre class='context'>      'dnes' =&gt; @dn_emails, </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>      'next_offset' =&gt; params[:offset].to_i + params[:number].to_i, </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>      'counter_starts_at' =&gt; params[:offset].to_i + 1</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobReferencesController</td>
    <td>index</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context223');toggle('message223');toggle('full_message223')" ><span id='message223' style='display:block' >Possible SQL injection near line 61: JobReference.find(:all, :limit =&gt; 100, :offset =&gt; ((((params[:pa...</span><span id='full_message223' style='display:none'>Possible SQL injection near line 61: JobReference.find(:all, :limit =&gt; 100, :offset =&gt; ((((params[:page].to_i or 1).to_f - 1) * 100.to_f).to_i), :order =&gt; (&quot;#{(<span class="user_input">params[:sort_by]</span> or &quot;move_date&quot;)}#{((params[:sort_reverse] or &quot;yes&quot;) == &quot;yes&quot;) ? (&quot; DESC&quot;) : (&quot;&quot;)}&quot;))</span><table id='context223' class='context' style='display:none'><caption>app/controllers/job_references_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>56</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @sort_by = params[:sort_by] || 'move_date'</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sort_reverse = params[:sort_reverse] || 'yes'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    order = &quot;#{@sort_by}#{@sort_reverse == 'yes' ? ' DESC' : ''}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_references = JobReference.find(:all, :limit =&gt; perpage, :offset =&gt; offset, :order =&gt; order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.html # index.rhtml</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.xml  { render :xml =&gt; @job_references.to_xml }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>JobReferencesController</td>
    <td>index</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context224');toggle('message224');toggle('full_message224')" ><span id='message224' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 61: JobRefer...</span><span id='full_message224' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 61: JobReference.find(:all, :limit =&gt; 100, :offset =&gt; ((((params[:page].to_i or 1).to_f - 1) * 100.to_f).to_i), :order =&gt; (&quot;#{(params[:sort_by] or &quot;move_date&quot;)}#{((params[:sort_reverse] or &quot;yes&quot;) == &quot;yes&quot;) ? (&quot; DESC&quot;) : (&quot;&quot;)}&quot;))</span><table id='context224' class='context' style='display:none'><caption>app/controllers/job_references_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>56</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @sort_by = params[:sort_by] || 'move_date'</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @sort_reverse = params[:sort_reverse] || 'yes'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    order = &quot;#{@sort_by}#{@sort_reverse == 'yes' ? ' DESC' : ''}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_references = JobReference.find(:all, :limit =&gt; perpage, :offset =&gt; offset, :order =&gt; order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.html # index.rhtml</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.xml  { render :xml =&gt; @job_references.to_xml }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>LeadsController</td>
    <td>index</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context217');toggle('message217');toggle('full_message217')" >Possible SQL injection near line 127: ServiceLocation.exists?(<span class="user_input">params[:service_location_id]</span>)<table id='context217' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>122</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # GET /leads</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /leads.xml</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>124</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def index</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @list = ListType.find(params[:list_type_id] || ListType::NEEDS_FIRST_CALL)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>    session[:list_type_id] = @list.id</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @service_location = ServiceLocation.exists?(params[:service_location_id]) ? ServiceLocation.find(params[:service_location_id]) : nil</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @list.id == ListType::ALL_LEADS_ID</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @leads = Lead.index_leads(@page, @perpage, @service_location)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>      session[:list_lead_ids] = Lead.index_lead_ids(@service_location)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @leads = @list.paginated_list_leads(@page, @perpage, @service_location)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ListType</td>
    <td>ListType.demand_for</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context216');toggle('message216');toggle('full_message216')" ><span id='message216' style='display:block' >Possible SQL injection near line 42: Lead.count(:conditions =&gt; ([&quot;id NOT IN (#{ListType.lead_ids_for_...</span><span id='full_message216' style='display:none'>Possible SQL injection near line 42: Lead.count(:conditions =&gt; ([&quot;id NOT IN (#{<span class="user_input">ListType.lead_ids_for_types([ListType::INACTIVE_LEADS, ListType::BOOKED_MOVES]).join(&quot;,&quot;)</span>}) AND move_date = ?&quot;, (local target_date)]))</span><table id='context216' class='context' style='display:none'><caption>app/models/list_type.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>37</pre>
          </td>
          <td class='context'>
            <pre class='context'>                          :total_entries =&gt; total_entries,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>                          :conditions =&gt; conditions)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def self.demand_for(target_date)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>    Lead.count(:conditions =&gt; [&quot;id NOT IN (#{ListType.lead_ids_for_types([ListType::INACTIVE_LEADS, ListType::BOOKED_MOVES]).join(',')}) AND move_date = ?&quot;, target_date])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # return an Array of Lead ids for the list_types passed</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def self.lead_ids_for_types(list_types)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless list_types.is_a?(Array)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ReportsController</td>
    <td>emails_to_lead_companies</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context225');toggle('message225');toggle('full_message225')" ><span id='message225' style='display:block' >Possible SQL injection near line 80: Event.find(:all, :conditions =&gt; (&quot;sent_email_id is not null AND ...</span><span id='full_message225' style='display:none'>Possible SQL injection near line 80: Event.find(:all, :conditions =&gt; (&quot;sent_email_id is not null AND created_on &lt; #{((Time.parse(<span class="user_input">params[&quot;end_date&quot;]</span>).year.to_s + (Time.parse(<span class="user_input">params[&quot;end_date&quot;]</span>).month.to_s or (&quot;0&quot; + Time.parse(<span class="user_input">params[&quot;end_date&quot;]</span>).month.to_s))) + (Time.parse(<span class="user_input">params[&quot;end_date&quot;]</span>).mday.to_s or (&quot;0&quot; + Time.parse(<span class="user_input">params[&quot;end_date&quot;]</span>).mday.to_s)))} AND created_on &gt;= #{((Time.parse(params[&quot;start_date&quot;]).year.to_s + (Time.parse(params[&quot;start_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).month.to_s))) + (Time.parse(params[&quot;start_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).mday.to_s)))}&quot;), :include =&gt; &quot;sent_email&quot;)</span><table id='context225' class='context' style='display:none'><caption>app/controllers/reports_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>75</pre>
          </td>
          <td class='context'>
            <pre class='context'>    if @data.nil?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @cached = 'Results just calculated'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @predata = Hash[*LeadCompany.find(:all).map{|x| [x, 0]}.flatten]</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>      events = Event.find(:all, :conditions =&gt; &quot;sent_email_id is not null AND created_on &lt; #{time2_unix} AND created_on &gt;= #{time1_unix}&quot;, :include =&gt; 'sent_email')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>      for e in events</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @predata.each_key do |lead_company|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>          if e.sent_email.to == lead_company.email and e.sent_email.to.to_s != ''</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @predata[lead_company] += 1</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>UndigestibleEmailsController</td>
    <td>next_bunch</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context227');toggle('message227');toggle('full_message227')" ><span id='message227' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 51: Undigest...</span><span id='full_message227' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 51: UndigestibleEmail.find(:all, :limit =&gt; (params[:number].to_i), :offset =&gt; (params[:offset].to_i), :order =&gt; &quot;created_on DESC&quot;)</span><table id='context227' class='context' style='display:none'><caption>app/controllers/undigestible_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>46</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def next_bunch</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise &quot;must pass in an offset&quot; if params[:offset].nil?</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise &quot;must pass in a number&quot; if params[:number].nil?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @undigestible_emails = UndigestibleEmail.find(:all, :limit =&gt; params[:number].to_i, :offset =&gt; params[:offset].to_i, :order =&gt; 'created_on DESC')</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render_partial('undigestible_emails/list', </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>      'ues' =&gt; @undigestible_emails, </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>      'next_offset' =&gt; params[:offset].to_i + params[:number].to_i, </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>      'counter_starts_at' =&gt; params[:offset].to_i + 1</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td></td>
    <td></td>
    <td><a href="https://groups.google.com/d/topic/rubyonrails-security/61bkgvnSGTQ/discussion">Remote Code Execution</a></td>
    <td>Rails 1.2.2 has a remote code execution vulnerability: upgrade to 2.3.15 or disable XML parsing</td>
  </tr>
  
  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>Lead</td>
    <td>generate_csv_file</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
    <td><div class='warning_message' onClick="toggle('context9');toggle('message9');toggle('full_message9')" >Model attribute value used in file name near line 1031: File.open(<span class="user_input">Lead.csv_filepath(id)</span>, &quot;w&quot;)<table id='context9' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1026</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def csv_urlpath</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1027</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &quot;/csv_dumps/lead_#{id}.csv&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1028</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1029</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def generate_csv_file</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1030</pre>
            </td>
            <td class='context'>
              <pre class='context'>    csv_path = Lead.csv_filepath(id)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>1031</pre>
            </td>
            <td class='context'>
              <pre class='context'>    outfile = File.open(csv_path, 'w')</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1032</pre>
            </td>
            <td class='context'>
              <pre class='context'>    outfile.write(&quot;id,&quot;+Lead.csv_attributes.join(',')+&quot;\n&quot;) </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1033</pre>
            </td>
            <td class='context'>
              <pre class='context'>    outfile.write(&quot;#{id},&quot;+to_csv+&quot;\n&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1034</pre>
            </td>
            <td class='context'>
              <pre class='context'>    outfile.write(Lead.csv_class_delimiter+&quot;\n&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1035</pre>
            </td>
            <td class='context'>
              <pre class='context'>    outfile.write(&quot;lead_id,roomname,itemname,quantity,pounds,cubic_feet\n&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1036</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless inventory.nil?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>Lead</td>
    <td>Lead.new_leads</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context228');toggle('message228');toggle('full_message228')" ><span id='message228' style='display:block' >Possible SQL injection near line 124: Lead.find(:all, :conditions =&gt; (&quot;leads.id in (#{Set.new.to_a.jo...</span><span id='full_message228' style='display:none'>Possible SQL injection near line 124: Lead.find(:all, :conditions =&gt; (&quot;leads.id in (#{<span class="user_input">Set.new.to_a.join(&quot;,&quot;)</span>})&quot;), :include =&gt; :list_types)</span><table id='context228' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>119</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def self.new_leads</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>120</pre>
            </td>
            <td class='context'>
              <pre class='context'>    lead_ids = Set.new</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>121</pre>
            </td>
            <td class='context'>
              <pre class='context'>    [ListType::NEEDS_FIRST_SMS, ListType::NEEDS_FIRST_EMAIL, ListType::NEEDS_FIRST_CALL].each{|type|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>      lead_ids.merge(ListType.lead_ids_for_types(type))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>    }</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>124</pre>
            </td>
            <td class='context'>
              <pre class='context'>    return lead_ids.empty? ? [] : Lead.find(:all, :conditions =&gt; &quot;leads.id in (#{lead_ids.to_a.join(',')})&quot;, :include =&gt; :list_types)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def before_validation_clean_up_phones</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>    modified_phones = []</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.phones(false).each do |phone|</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>Lead</td>
    <td>my_duplicates</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context229');toggle('message229');toggle('full_message229')" ><span id='message229' style='display:block' >Possible SQL injection near line 1485: Lead.find(:all, :conditions =&gt; (&quot;<span class="user_input">contact_email</span> = '#{contact_em...</span><span id='full_message229' style='display:none'>Possible SQL injection near line 1485: Lead.find(:all, :conditions =&gt; (&quot;<span class="user_input">contact_email</span> = '#{<span class="user_input">contact_email</span>}' AND id &lt;&gt; #{id ? ((0 + id)) : (9999999)}&quot;))</span><table id='context229' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1480</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def my_duplicates(pagination_opts={})</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1481</pre>
            </td>
            <td class='context'>
              <pre class='context'>    my_id = id ? 0 + id : 9999999</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1482</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = []</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1483</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #output_size = 0 + output.size</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1484</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if contact_email.to_s.scan(VUtility.regex_for('email_address')).size &gt; 0</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>1485</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output = output.concat Lead.find(:all, :conditions =&gt; &quot;contact_email = '#{contact_email}' AND id &lt;&gt; #{my_id}&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1486</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1487</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;duplicate was found based on email&quot; if output.size &gt; output_size</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1488</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #output_size = 0 + output.size</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>Lead</td>
    <td>my_duplicates</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context230');toggle('message230');toggle('full_message230')" ><span id='message230' style='display:block' >Possible SQL injection near line 1505: Lead.find(:all, :conditions =&gt; (&quot;(stringified_phones like '%#{...</span><span id='full_message230' style='display:none'>Possible SQL injection near line 1505: Lead.find(:all, :conditions =&gt; (&quot;(stringified_phones like '%#{<span class="user_input">phones.map do  (local x)[&quot;phone&quot;]  end.join(&quot;%' OR stringified_phones like '%&quot;)</span>}%') AND id &lt;&gt; #{id ? ((0 + id)) : (9999999)}&quot;))</span><table id='context230' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1500</pre>
          </td>
          <td class='context'>
            <pre class='context'>    #raise &quot;duplicate was found based on true_name: #{output[0].inspect}&quot; if output.size &gt; output_size</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1501</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #output_size = 0 + output.size</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1503</pre>
            </td>
            <td class='context'>
              <pre class='context'>    phones_condition = &quot;(stringified_phones like '%#{phones.map{|x| x['phone']}.join('%\' OR stringified_phones like \'%')}%') AND id &lt;&gt; #{my_id}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>1505</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = output.concat Lead.find(:all, :conditions =&gt; phones_condition) unless phones.size &lt; 1</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1507</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails_condition = &quot;(stringified_emails like '%#{emails.map{|x| x['email']}.join('%\' OR stringified_emails like \'%')}%') AND id &lt;&gt; #{my_id}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1508</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = output.concat Lead.find(:all, :conditions =&gt; emails_condition) unless emails.size &lt; 1</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1510</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if phone1.to_s.scan(VUtility.regex_for('phone_number')).size &gt; 0</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>Lead</td>
    <td>my_duplicates</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context231');toggle('message231');toggle('full_message231')" ><span id='message231' style='display:block' >Possible SQL injection near line 1508: Lead.find(:all, :conditions =&gt; (&quot;(stringified_emails like '%#{...</span><span id='full_message231' style='display:none'>Possible SQL injection near line 1508: Lead.find(:all, :conditions =&gt; (&quot;(stringified_emails like '%#{<span class="user_input">emails.map do  (local x)[&quot;email&quot;]  end.join(&quot;%' OR stringified_emails like '%&quot;)</span>}%') AND id &lt;&gt; #{id ? ((0 + id)) : (9999999)}&quot;))</span><table id='context231' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1503</pre>
          </td>
          <td class='context'>
            <pre class='context'>    phones_condition = &quot;(stringified_phones like '%#{phones.map{|x| x['phone']}.join('%\' OR stringified_phones like \'%')}%') AND id &lt;&gt; #{my_id}&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1505</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = output.concat Lead.find(:all, :conditions =&gt; phones_condition) unless phones.size &lt; 1</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1507</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails_condition = &quot;(stringified_emails like '%#{emails.map{|x| x['email']}.join('%\' OR stringified_emails like \'%')}%') AND id &lt;&gt; #{my_id}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>1508</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = output.concat Lead.find(:all, :conditions =&gt; emails_condition) unless emails.size &lt; 1</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1510</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if phone1.to_s.scan(VUtility.regex_for('phone_number')).size &gt; 0</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1511</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output = output.concat Lead.find(:all, :conditions =&gt; &quot;(phone1 = '#{phone1}' OR phone2 = '#{phone1}' OR phone3 = '#{phone1}') AND id &lt;&gt; #{my_id}&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1512</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1513</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;duplicate was found based on phone1&quot; if output.size &gt; output_size</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>Lead</td>
    <td>my_duplicates</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context232');toggle('message232');toggle('full_message232')" ><span id='message232' style='display:block' >Possible SQL injection near line 1511: Lead.find(:all, :conditions =&gt; (&quot;(<span class="user_input">phone1</span> = '#{<span class="user_input">phone1</span>}' OR phon...</span><span id='full_message232' style='display:none'>Possible SQL injection near line 1511: Lead.find(:all, :conditions =&gt; (&quot;(<span class="user_input">phone1</span> = '#{<span class="user_input">phone1</span>}' OR phone2 = '#{<span class="user_input">phone1</span>}' OR phone3 = '#{<span class="user_input">phone1</span>}') AND id &lt;&gt; #{id ? ((0 + id)) : (9999999)}&quot;))</span><table id='context232' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1507</pre>
          </td>
          <td class='context'>
            <pre class='context'>    emails_condition = &quot;(stringified_emails like '%#{emails.map{|x| x['email']}.join('%\' OR stringified_emails like \'%')}%') AND id &lt;&gt; #{my_id}&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1508</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = output.concat Lead.find(:all, :conditions =&gt; emails_condition) unless emails.size &lt; 1</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1510</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if phone1.to_s.scan(VUtility.regex_for('phone_number')).size &gt; 0</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>1511</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output = output.concat Lead.find(:all, :conditions =&gt; &quot;(phone1 = '#{phone1}' OR phone2 = '#{phone1}' OR phone3 = '#{phone1}') AND id &lt;&gt; #{my_id}&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1512</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1513</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;duplicate was found based on phone1&quot; if output.size &gt; output_size</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1514</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #output_size = 0 + output.size</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1515</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if phone2.to_s.scan(VUtility.regex_for('phone_number')).size &gt; 0</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1516</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output = output.concat Lead.find(:all, :conditions =&gt; &quot;(phone1 = '#{phone2}' OR phone2 = '#{phone2}' OR phone3 = '#{phone2}') AND id &lt;&gt; #{my_id}&quot;)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>Lead</td>
    <td>my_duplicates</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context233');toggle('message233');toggle('full_message233')" ><span id='message233' style='display:block' >Possible SQL injection near line 1516: Lead.find(:all, :conditions =&gt; (&quot;(phone1 = '#{<span class="user_input">phone2</span>}' OR phon...</span><span id='full_message233' style='display:none'>Possible SQL injection near line 1516: Lead.find(:all, :conditions =&gt; (&quot;(phone1 = '#{<span class="user_input">phone2</span>}' OR <span class="user_input">phone2</span> = '#{<span class="user_input">phone2</span>}' OR phone3 = '#{<span class="user_input">phone2</span>}') AND id &lt;&gt; #{id ? ((0 + id)) : (9999999)}&quot;))</span><table id='context233' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1511</pre>
          </td>
          <td class='context'>
            <pre class='context'>      output = output.concat Lead.find(:all, :conditions =&gt; &quot;(phone1 = '#{phone1}' OR phone2 = '#{phone1}' OR phone3 = '#{phone1}') AND id &lt;&gt; #{my_id}&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1512</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1513</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;duplicate was found based on phone1&quot; if output.size &gt; output_size</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1514</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #output_size = 0 + output.size</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1515</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if phone2.to_s.scan(VUtility.regex_for('phone_number')).size &gt; 0</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>1516</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output = output.concat Lead.find(:all, :conditions =&gt; &quot;(phone1 = '#{phone2}' OR phone2 = '#{phone2}' OR phone3 = '#{phone2}') AND id &lt;&gt; #{my_id}&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1517</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1518</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;duplicate was found based on phone2&quot; if output.size &gt; output_size</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1519</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #output_size = 0 + output.size</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1520</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if phone3.to_s.scan(VUtility.regex_for('phone_number')).size &gt; 0</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1521</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output = output.concat Lead.find(:all, :conditions =&gt; &quot;(phone1 = '#{phone3}' OR phone2 = '#{phone3}' OR phone3 = '#{phone3}') AND id &lt;&gt; #{my_id}&quot;)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>Lead</td>
    <td>my_duplicates</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context234');toggle('message234');toggle('full_message234')" ><span id='message234' style='display:block' >Possible SQL injection near line 1521: Lead.find(:all, :conditions =&gt; (&quot;(phone1 = '#{<span class="user_input">phone3</span>}' OR phon...</span><span id='full_message234' style='display:none'>Possible SQL injection near line 1521: Lead.find(:all, :conditions =&gt; (&quot;(phone1 = '#{<span class="user_input">phone3</span>}' OR phone2 = '#{<span class="user_input">phone3</span>}' OR <span class="user_input">phone3</span> = '#{<span class="user_input">phone3</span>}') AND id &lt;&gt; #{id ? ((0 + id)) : (9999999)}&quot;))</span><table id='context234' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1516</pre>
          </td>
          <td class='context'>
            <pre class='context'>      output = output.concat Lead.find(:all, :conditions =&gt; &quot;(phone1 = '#{phone2}' OR phone2 = '#{phone2}' OR phone3 = '#{phone2}') AND id &lt;&gt; #{my_id}&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1517</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1518</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;duplicate was found based on phone2&quot; if output.size &gt; output_size</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1519</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #output_size = 0 + output.size</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1520</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if phone3.to_s.scan(VUtility.regex_for('phone_number')).size &gt; 0</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>1521</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output = output.concat Lead.find(:all, :conditions =&gt; &quot;(phone1 = '#{phone3}' OR phone2 = '#{phone3}' OR phone3 = '#{phone3}') AND id &lt;&gt; #{my_id}&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1522</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1523</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;duplicate was found based on phone3&quot; if output.size &gt; output_size</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1524</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #output_size = 0 + output.size</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1526</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output.uniq!</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>HotConditionsController</td>
    <td>new</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/dynamic_render_path/">Dynamic Render Path</a></td>
    <td><div class='warning_message' onClick="toggle('context214');toggle('message214');toggle('full_message214')" ><span id='message214' style='display:block' >Render path contains parameter value near line 34: render(action =&gt; (&quot;hot_conditions/&quot; + (&quot;new_&quot; + pa...</span><span id='full_message214' style='display:none'>Render path contains parameter value near line 34: render(action =&gt; (&quot;hot_conditions/&quot; + (&quot;new_&quot; + <span class="user_input">params[:flavor]</span>)), {})</span><table id='context214' class='context' style='display:none'><caption>app/controllers/hot_conditions_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>29</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @hot_condition = HotCondition.new(:flavor =&gt; params[:flavor])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if !params[:flavor]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise &quot;HotConditionsController.new called without necessary param 'flavor'&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>    formname = 'new_'+params[:flavor]</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render 'hot_conditions/'+formname</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /hot_conditions/1;edit</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def edit</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @hot_condition = HotCondition.find(params[:id])</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>TasksController</td>
    <td>edit</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/dynamic_render_path/">Dynamic Render Path</a></td>
    <td><div class='warning_message' onClick="toggle('context215');toggle('message215');toggle('full_message215')" ><span id='message215' style='display:block' >Render path contains parameter value near line 382: render(partial =&gt; (&quot;tasks/edit_&quot; + params[:flavor...</span><span id='full_message215' style='display:none'>Render path contains parameter value near line 382: render(partial =&gt; (&quot;tasks/edit_&quot; + <span class="user_input">params[:flavor]</span>), { :locals =&gt; ({ &quot;outcomes_string&quot; =&gt; (DnTask.find(params[:id]).outcomes_string), &quot;task&quot; =&gt; (DnTask.find(params[:id])), &quot;container_div_id&quot; =&gt; (params[:container_div_id]), &quot;commit_string&quot; =&gt; &quot;Save&quot;, &quot;form_url&quot; =&gt; (&quot;/tasks/#{DnTask.find(params[:id]).id}/update&quot;), &quot;mode&quot; =&gt; &quot;edit&quot; }) })</span><table id='context215' class='context' style='display:none'><caption>app/controllers/tasks_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>377</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @form_url = &quot;/tasks/#{@task.id}/update&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>379</pre>
            </td>
            <td class='context'>
              <pre class='context'>    case params[:mode]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>380</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when nil</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>381</pre>
            </td>
            <td class='context'>
              <pre class='context'>      partial_name = 'tasks/edit_'+params[:flavor]</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>382</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render :partial =&gt; partial_name, :locals =&gt; {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>383</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'outcomes_string' =&gt; @task.outcomes_string,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>384</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'task' =&gt; @task, </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>385</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'container_div_id' =&gt; params[:container_div_id],</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>386</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'commit_string' =&gt; 'Save',</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>387</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'form_url' =&gt; @form_url,</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>ApplicationController</td>
    <td>counter_and_timer</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context148');toggle('message148');toggle('full_message148')" ><span id='message148' style='display:block' >Unprotected mass assignment near line 19: Visit.create(:browser_agent =&gt; (request.env[&quot;HTTP_USER_AGEN...</span><span id='full_message148' style='display:none'>Unprotected mass assignment near line 19: Visit.create(:browser_agent =&gt; (request.env[&quot;HTTP_USER_AGENT&quot;]), :ip =&gt; (request.remote_ip.to_s), :resource =&gt; (&quot;#{params[:controller].blank? ? (0) : (params[:controller])}/#{<span class="user_input">params[:action]</span>.blank? ? (0) : (<span class="user_input">params[:action]</span>)}/#{params[&quot;id&quot;].blank? ? (&quot;&quot;) : (&quot;displayPage&quot;)}&quot;))</span><table id='context148' class='context' style='display:none'><caption>app/controllers/application.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>15</pre>
          </td>
          <td class='context'>
            <pre class='context'>    id = params[&quot;id&quot;].blank? ? &quot;&quot;: &quot;displayPage&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @visit = Visit.create({:browser_agent =&gt; request.env['HTTP_USER_AGENT'],</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>                           :ip =&gt; request.remote_ip.to_s,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>                           :resource =&gt; &quot;#{params[:controller].blank? ? 0 : params[:controller] }/#{params[:action].blank? ? 0 : params[:action]}/#{id}&quot;})</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @visit_length = Visit.find(:all,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>                               :conditions =&gt; &quot;resource = '#{params[:controller].blank? ? 0 : params[:controller] }/#{params[:action].blank? ? 0 : params[:action]}/#{id}'&quot;).length</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'> end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>AutoEmailMappingsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context88');toggle('message88');toggle('full_message88')" ><span id='message88' style='display:block' >Unprotected mass assignment near line 143: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_temp...</span><span id='full_message88' style='display:none'>Unprotected mass assignment near line 143: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = ?&quot;, 1000])).update_attributes(:email_template_mapped_id =&gt; (params[:&quot;#{#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}}&quot;]), :email_template_mapped_name =&gt; ((<span class="user_input">EmailTemplate.find((params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;] or (&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;])))</span> or EmailTemplate.find(:first, :conditions =&gt; ([&quot;id = ?&quot;, params[&quot;#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}&quot;]]), :select =&gt; &quot;name&quot;)).name))</span><table id='context88' class='context' style='display:none'><caption>app/controllers/auto_email_mappings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>138</pre>
          </td>
          <td class='context'>
            <pre class='context'>                   if (temp_id == &quot;default&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>140</pre>
            </td>
            <td class='context'>
              <pre class='context'>                     prev_id = AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, 1000])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>141</pre>
            </td>
            <td class='context'>
              <pre class='context'>                     temp_name = EmailTemplate.find(:first, :conditions=&gt;[&quot;id = ?&quot;, check], :select =&gt; &quot;name&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>143</pre>
            </td>
            <td class='context'>
              <pre class='context'>                     AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, 1000]).update_attributes(:email_template_mapped_id =&gt; params[:&quot;#{temp_id}&quot;], :email_template_mapped_name =&gt; temp_name.name)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>145</pre>
            </td>
            <td class='context'>
              <pre class='context'>                      param_upd1 = &quot;'&quot; + check + &quot;'&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>146</pre>
            </td>
            <td class='context'>
              <pre class='context'>                     param_upd2 = &quot;'&quot; + temp_name.name + &quot;'&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>                     AutoEmailMapping.update_all(&quot;email_template_mapped_id = #{param_upd1}, email_template_mapped_name = #{param_upd2}&quot;, &quot;email_template_mapped_id = '#{prev_id.email_template_mapped_id}'&quot;)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>AutoEmailMappingsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context89');toggle('message89');toggle('full_message89')" ><span id='message89' style='display:block' >Unprotected mass assignment near line 174: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_temp...</span><span id='full_message89' style='display:none'>Unprotected mass assignment near line 174: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = ?&quot;, ((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])])).update_attributes(:email_template_mapped_id =&gt; ((((params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;] or (&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;])) or params[:&quot;#{#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}}&quot;]) or ((&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;]) or AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_id))), :email_template_mapped_name =&gt; (((EmailTemplate.find((params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;] or (&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;]))) or EmailTemplate.find(:first, :conditions =&gt; ([&quot;id = ?&quot;, params[&quot;#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}&quot;]]), :select =&gt; &quot;name&quot;)) or <span class="user_input">AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_name</span>)))</span><table id='context89' class='context' style='display:none'><caption>app/controllers/auto_email_mappings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>169</pre>
          </td>
          <td class='context'>
            <pre class='context'>                                add_entry.email_template_mapped_id = mapped_id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>170</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                add_entry.email_template_mapped_name = temp_name</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>171</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                add_entry.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>172</pre>
            </td>
            <td class='context'>
              <pre class='context'>                              else</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>174</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                 AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, temp_id]).update_attributes(:email_template_mapped_id =&gt; mapped_id, :email_template_mapped_name =&gt; temp_name)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>175</pre>
            </td>
            <td class='context'>
              <pre class='context'>                              end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>176</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>177</pre>
            </td>
            <td class='context'>
              <pre class='context'>                              temp_name = EmailTemplate.find(params[:&quot;#{temp_id}&quot;])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>178</pre>
            </td>
            <td class='context'>
              <pre class='context'>                              row_exists = AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, temp_id])</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>AutoEmailMappingsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context90');toggle('message90');toggle('full_message90')" ><span id='message90' style='display:block' >Unprotected mass assignment near line 187: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_temp...</span><span id='full_message90' style='display:none'>Unprotected mass assignment near line 187: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = ?&quot;, ((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])])).update_attributes(:email_template_mapped_id =&gt; (params[:&quot;#{#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}}&quot;]), :email_template_mapped_name =&gt; ((((EmailTemplate.find((params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;] or (&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;]))) or EmailTemplate.find(:first, :conditions =&gt; ([&quot;id = ?&quot;, params[&quot;#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}&quot;]]), :select =&gt; &quot;name&quot;)) or AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_name) or <span class="user_input">EmailTemplate.find(params[:&quot;#{#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}}&quot;])</span>).name))</span><table id='context90' class='context' style='display:none'><caption>app/controllers/auto_email_mappings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>182</pre>
          </td>
          <td class='context'>
            <pre class='context'>                                add_entry.email_template_id = temp_id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                add_entry.email_template_mapped_id = mapped_id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>184</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                add_entry.email_template_mapped_name = temp_name.name</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                add_entry.save</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>                              else</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>187</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                 AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, temp_id]).update_attributes(:email_template_mapped_id =&gt; params[:&quot;#{temp_id}&quot;], :email_template_mapped_name =&gt; temp_name.name)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>                              end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>189</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>191</pre>
            </td>
            <td class='context'>
              <pre class='context'>                        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>192</pre>
            </td>
            <td class='context'>
              <pre class='context'>                   end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>AutoEmailMappingsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context91');toggle('message91');toggle('full_message91')" ><span id='message91' style='display:block' >Unprotected mass assignment near line 213: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_temp...</span><span id='full_message91' style='display:none'>Unprotected mass assignment near line 213: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = ?&quot;, 1000])).update_attributes(:email_template_mapped_id =&gt; (params[:&quot;#{#{(((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;]) or params[:&quot;F#{#{(((0 or 1) or ((0 or 1) + 1)) or 0)}}&quot;])}}&quot;]), :email_template_mapped_name =&gt; (((((EmailTemplate.find((params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;] or (&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;]))) or EmailTemplate.find(:first, :conditions =&gt; ([&quot;id = ?&quot;, params[&quot;#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}&quot;]]), :select =&gt; &quot;name&quot;)) or AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_name) or EmailTemplate.find(params[:&quot;#{#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}}&quot;])) or <span class="user_input">EmailTemplate.find(:first, :conditions =&gt; ([&quot;id = ?&quot;, (params[&quot;#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}&quot;] or params[&quot;#{(((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;]) or params[:&quot;F#{#{(((0 or 1) or ((0 or 1) + 1)) or 0)}}&quot;])}&quot;])]), :select =&gt; &quot;name&quot;)</span>).name))</span><table id='context91' class='context' style='display:none'><caption>app/controllers/auto_email_mappings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>208</pre>
          </td>
          <td class='context'>
            <pre class='context'>                     temp_name = EmailTemplate.find(:first, :conditions=&gt;[&quot;id = ?&quot;, check], :select =&gt; &quot;name&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>210</pre>
            </td>
            <td class='context'>
              <pre class='context'>                     param_upd1 = &quot;'&quot; + check + &quot;'&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>211</pre>
            </td>
            <td class='context'>
              <pre class='context'>                     param_upd2 = &quot;'&quot; + temp_name.name + &quot;'&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>213</pre>
            </td>
            <td class='context'>
              <pre class='context'>                     AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, 1000]).update_attributes(:email_template_mapped_id =&gt; params[:&quot;#{temp_id}&quot;], :email_template_mapped_name =&gt; temp_name.name)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>214</pre>
            </td>
            <td class='context'>
              <pre class='context'>                     AutoEmailMapping.update_all(&quot;email_template_mapped_id = #{param_upd1}, email_template_mapped_name = #{param_upd2}&quot;, &quot;email_template_mapped_id = '#{prev_id.email_template_mapped_id}'&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>216</pre>
            </td>
            <td class='context'>
              <pre class='context'>                   else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>217</pre>
            </td>
            <td class='context'>
              <pre class='context'>                        temp_def_val =  AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = 1000&quot;])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>218</pre>
            </td>
            <td class='context'>
              <pre class='context'>                        default_val = temp_def_val.email_template_mapped_id</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>AutoEmailMappingsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context92');toggle('message92');toggle('full_message92')" ><span id='message92' style='display:block' >Unprotected mass assignment near line 227: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_temp...</span><span id='full_message92' style='display:none'>Unprotected mass assignment near line 227: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = ?&quot;, (((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;]) or params[:&quot;F#{#{(((0 or 1) or ((0 or 1) + 1)) or 0)}}&quot;])])).update_attributes(:email_template_mapped_id =&gt; ((((((params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;] or (&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;])) or params[:&quot;#{#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}}&quot;]) or ((&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;]) or AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_id)) or params[:&quot;#{#{(((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;]) or params[:&quot;F#{#{(((0 or 1) or ((0 or 1) + 1)) or 0)}}&quot;])}}&quot;]) or ((((&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;]) or AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_id) or &quot;none&quot;) or AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_id))), :email_template_mapped_name =&gt; ((((((EmailTemplate.find((params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;] or (&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;]))) or EmailTemplate.find(:first, :conditions =&gt; ([&quot;id = ?&quot;, params[&quot;#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}&quot;]]), :select =&gt; &quot;name&quot;)) or <span class="user_input">AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_name</span>) or EmailTemplate.find(params[:&quot;#{#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}}&quot;])) or EmailTemplate.find(:first, :conditions =&gt; ([&quot;id = ?&quot;, (params[&quot;#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}&quot;] or params[&quot;#{(((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;]) or params[:&quot;F#{#{(((0 or 1) or ((0 or 1) + 1)) or 0)}}&quot;])}&quot;])]), :select =&gt; &quot;name&quot;)) or <span class="user_input">AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_name</span>)))</span><table id='context92' class='context' style='display:none'><caption>app/controllers/auto_email_mappings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>223</pre>
          </td>
          <td class='context'>
            <pre class='context'>                       else</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>224</pre>
            </td>
            <td class='context'>
              <pre class='context'>                          if (mapped_id == &quot;Select Template&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>225</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            mapped_id = default_val</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>226</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            temp_name = default_name</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>227</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, temp_id]).update_attributes(:email_template_mapped_id =&gt; mapped_id, :email_template_mapped_name =&gt; temp_name)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>228</pre>
            </td>
            <td class='context'>
              <pre class='context'>                          else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>229</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            temp_name = EmailTemplate.find(params[:&quot;#{temp_id}&quot;])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>230</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, temp_id]).update_attributes(:email_template_mapped_id =&gt; params[:&quot;#{temp_id}&quot;], :email_template_mapped_name =&gt; temp_name.name)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>231</pre>
            </td>
            <td class='context'>
              <pre class='context'>                          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>232</pre>
            </td>
            <td class='context'>
              <pre class='context'>                       end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>AutoEmailMappingsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context93');toggle('message93');toggle('full_message93')" ><span id='message93' style='display:block' >Unprotected mass assignment near line 230: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_temp...</span><span id='full_message93' style='display:none'>Unprotected mass assignment near line 230: AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = ?&quot;, (((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;]) or params[:&quot;F#{#{(((0 or 1) or ((0 or 1) + 1)) or 0)}}&quot;])])).update_attributes(:email_template_mapped_id =&gt; (params[:&quot;#{#{(((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;]) or params[:&quot;F#{#{(((0 or 1) or ((0 or 1) + 1)) or 0)}}&quot;])}}&quot;]), :email_template_mapped_name =&gt; (((((((EmailTemplate.find((params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;] or (&quot;none&quot; or params[:&quot;#{#{params[:&quot;F#{#{0}}&quot;]}}&quot;]))) or EmailTemplate.find(:first, :conditions =&gt; ([&quot;id = ?&quot;, params[&quot;#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}&quot;]]), :select =&gt; &quot;name&quot;)) or AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_name) or EmailTemplate.find(params[:&quot;#{#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}}&quot;])) or EmailTemplate.find(:first, :conditions =&gt; ([&quot;id = ?&quot;, (params[&quot;#{((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;])}&quot;] or params[&quot;#{(((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;]) or params[:&quot;F#{#{(((0 or 1) or ((0 or 1) + 1)) or 0)}}&quot;])}&quot;])]), :select =&gt; &quot;name&quot;)) or AutoEmailMapping.find(:first, :conditions =&gt; ([&quot;email_template_id = 1000&quot;])).email_template_mapped_name) or <span class="user_input">EmailTemplate.find(params[:&quot;#{#{(((params[:&quot;F#{#{0}}&quot;] or 1000) or params[:&quot;F#{#{(0 or 1)}}&quot;]) or params[:&quot;F#{#{(((0 or 1) or ((0 or 1) + 1)) or 0)}}&quot;])}}&quot;])</span>).name))</span><table id='context93' class='context' style='display:none'><caption>app/controllers/auto_email_mappings_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>225</pre>
          </td>
          <td class='context'>
            <pre class='context'>                            mapped_id = default_val</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>226</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            temp_name = default_name</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>227</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, temp_id]).update_attributes(:email_template_mapped_id =&gt; mapped_id, :email_template_mapped_name =&gt; temp_name)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>228</pre>
            </td>
            <td class='context'>
              <pre class='context'>                          else</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>229</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            temp_name = EmailTemplate.find(params[:&quot;#{temp_id}&quot;])</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>230</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            AutoEmailMapping.find(:first, :conditions =&gt; [&quot;email_template_id = ?&quot;, temp_id]).update_attributes(:email_template_mapped_id =&gt; params[:&quot;#{temp_id}&quot;], :email_template_mapped_name =&gt; temp_name.name)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>231</pre>
            </td>
            <td class='context'>
              <pre class='context'>                          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>232</pre>
            </td>
            <td class='context'>
              <pre class='context'>                       end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>233</pre>
            </td>
            <td class='context'>
              <pre class='context'>                   end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>234</pre>
            </td>
            <td class='context'>
              <pre class='context'>                   i = i + 1</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>235</pre>
            </td>
            <td class='context'>
              <pre class='context'>                end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Condition</td>
    <td>initialize</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context85');toggle('message85');toggle('full_message85')" >Unprotected mass assignment near line 116: self.attributes = (local attributes)<table id='context85' class='context' style='display:none'><caption>app/models/condition.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>112</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def initialize(attributes = nil, condition_form = nil)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @attributes = attributes_from_column_definition</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @new_record = true</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ensure_proper_type</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.attributes = attributes unless attributes.nil?</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>117</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>119</pre>
            </td>
            <td class='context'>
              <pre class='context'>    Condition.update_event_according_to_form_inputs(self, condition_form) unless condition_form.nil?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>121</pre>
            </td>
            <td class='context'>
              <pre class='context'>    yield self if block_given?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>ConfigurablesController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context11');toggle('message11');toggle('full_message11')" ><span id='message11' style='display:block' >Unprotected mass assignment near line 68: Configurable.new(&quot;name&quot; =&gt; (params[&quot;name&quot;]), &quot;stringified_h...</span><span id='full_message11' style='display:none'>Unprotected mass assignment near line 68: Configurable.new(&quot;name&quot; =&gt; (params[&quot;name&quot;]), &quot;stringified_hash&quot; =&gt; (<span class="user_input">params[&quot;hash_string&quot;]</span>))</span><table id='context11' class='context' style='display:none'><caption>app/controllers/configurables_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>64</pre>
          </td>
          <td class='context'>
            <pre class='context'>    attributes['name'] = params['name']</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>    attributes['stringified_hash'] = params['hash_string']</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @configurable = Configurable.new(attributes)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @configurable.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'Configurable was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to configurable_url(@configurable) }</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>ConfirmationLetterTemplate</td>
    <td>move_up</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context137');toggle('message137');toggle('full_message137')" ><span id='message137' style='display:block' >Unprotected mass assignment near line 115: self.update_attributes(:order =&gt; (ConfirmationLetterTempla...</span><span id='full_message137' style='display:none'>Unprotected mass assignment near line 115: self.update_attributes(:order =&gt; (<span class="user_input">ConfirmationLetterTemplate.find(:all).sort_by</span> do  (local e).order  end[(<span class="user_input">ConfirmationLetterTemplate.find(:all).sort_by</span> do  (local e).order  end.index(self) - 1)].order))</span><table id='context137' class='context' style='display:none'><caption>app/models/confirmation_letter_template.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>110</pre>
          </td>
          <td class='context'>
            <pre class='context'>    my_index = all_ets.index(self)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et = all_ets[my_index - 1]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>    my_new_order = other_et.order</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; 1000000)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.update_attributes(:order =&gt; my_new_order)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; my_old_order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>119</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def move_down</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>ConfirmationLetterTemplate</td>
    <td>move_down</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context138');toggle('message138');toggle('full_message138')" ><span id='message138' style='display:block' >Unprotected mass assignment near line 133: self.update_attributes(:order =&gt; (ConfirmationLetterTempla...</span><span id='full_message138' style='display:none'>Unprotected mass assignment near line 133: self.update_attributes(:order =&gt; (<span class="user_input">ConfirmationLetterTemplate.find(:all).sort_by</span> do  (local e).order  end.reverse[(<span class="user_input">ConfirmationLetterTemplate.find(:all).sort_by</span> do  (local e).order  end.reverse.index(self) - 1)].order))</span><table id='context138' class='context' style='display:none'><caption>app/models/confirmation_letter_template.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>128</pre>
          </td>
          <td class='context'>
            <pre class='context'>    my_index = all_ets.index(self)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et = all_ets[my_index - 1]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>    my_new_order = other_et.order</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; 1000000)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.update_attributes(:order =&gt; my_new_order)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; my_old_order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>137</pre>
            </td>
            <td class='context'>
              <pre class='context'>  ##</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Email</td>
    <td>to_undigestible</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context62');toggle('message62');toggle('full_message62')" >Unprotected mass assignment near line 87: UndigestibleEmail.new(fullemail)<table id='context62' class='context' style='display:none'><caption>app/models/email.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>82</pre>
          </td>
          <td class='context'>
            <pre class='context'>    lead</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def to_undigestible</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #return false unless UndigestibleEmail.find(:first, :conditions =&gt; [&quot;uidl = ?&quot;, uidl]).nil?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ue = UndigestibleEmail.new(fullemail)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ue.uidl = uidl</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ue</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Email</td>
    <td>Email.create_from_textfile</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context63');toggle('message63');toggle('full_message63')" >Unprotected mass assignment near line 167: self.new((&quot;&quot; + File.open((local pathstring), &quot;r&quot;).gets))<table id='context63' class='context' style='display:none'><caption>app/models/email.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>162</pre>
          </td>
          <td class='context'>
            <pre class='context'>    fullemail = ''</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>163</pre>
            </td>
            <td class='context'>
              <pre class='context'>    while line = infile.gets</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>164</pre>
            </td>
            <td class='context'>
              <pre class='context'>      fullemail += line</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>165</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>167</pre>
            </td>
            <td class='context'>
              <pre class='context'>    email = self.new(fullemail)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>169</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>171</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def converted_to_lead?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>172</pre>
            </td>
            <td class='context'>
              <pre class='context'>    (lead and true)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>EmailTemplate</td>
    <td>move_up</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context139');toggle('message139');toggle('full_message139')" ><span id='message139' style='display:block' >Unprotected mass assignment near line 114: self.update_attributes(:order =&gt; (EmailTemplate.find(:all)...</span><span id='full_message139' style='display:none'>Unprotected mass assignment near line 114: self.update_attributes(:order =&gt; (<span class="user_input">EmailTemplate.find(:all).sort_by</span> do  (local e).order  end[(<span class="user_input">EmailTemplate.find(:all).sort_by</span> do  (local e).order  end.index(self) - 1)].order))</span><table id='context139' class='context' style='display:none'><caption>app/models/email_template.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>109</pre>
          </td>
          <td class='context'>
            <pre class='context'>    my_index = all_ets.index(self)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et = all_ets[my_index - 1]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>    my_new_order = other_et.order</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; 1000000)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.update_attributes(:order =&gt; my_new_order)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; my_old_order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>117</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def move_down</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>EmailTemplate</td>
    <td>move_down</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context140');toggle('message140');toggle('full_message140')" ><span id='message140' style='display:block' >Unprotected mass assignment near line 132: self.update_attributes(:order =&gt; (EmailTemplate.find(:all)...</span><span id='full_message140' style='display:none'>Unprotected mass assignment near line 132: self.update_attributes(:order =&gt; (<span class="user_input">EmailTemplate.find(:all).sort_by</span> do  (local e).order  end.reverse[(<span class="user_input">EmailTemplate.find(:all).sort_by</span> do  (local e).order  end.reverse.index(self) - 1)].order))</span><table id='context140' class='context' style='display:none'><caption>app/models/email_template.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>127</pre>
          </td>
          <td class='context'>
            <pre class='context'>    my_index = all_ets.index(self)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et = all_ets[my_index - 1]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>    my_new_order = other_et.order</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; 1000000)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.update_attributes(:order =&gt; my_new_order)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; my_old_order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>##</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>EmailTemplatesController</td>
    <td>post_review</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context17');toggle('message17');toggle('full_message17')" ><span id='message17' style='display:block' >Unprotected mass assignment near line 187: Event.new(:lead_id =&gt; (Lead.find(params[:lead_id]).id), :n...</span><span id='full_message17' style='display:none'>Unprotected mass assignment near line 187: Event.new(:lead_id =&gt; (Lead.find(params[:lead_id]).id), :notes =&gt; (((((((((&quot;Template: &quot; + EmailTemplate.find(params[:email_template_id]).name.to_s) + &quot;&lt;br&gt;Attachments: &quot;) + EmailTemplate.params_to_attachments(params).map do  (local x).original_filename  end.join(&quot;, &quot;)) + &quot;&lt;br&gt;Quote Included: &quot;) + Event.quote_message((params[:bodyhash] or {}), EmailTemplate.find(params[:email_template_id]))) + &quot;&lt;br&gt;Signature: &quot;) + User.find(params[:user_id]).firstname) + &quot;&lt;br&gt;Reviewed: Yes &lt;br&gt;From Task: No&quot;)), :initiator =&gt; (User.find(params[:user_id]).firstname), :mode =&gt; &quot;email&quot;, :outcome =&gt; ((&quot;other&quot; or ((nil or params[:sendable_email_outcomes].keys.join(&quot;, &quot;)) or params[:outcomes_string]))), :quote_included =&gt; (EmailTemplate.find(params[:email_template_id]).include_estimate_tables_as_bool), :initiator_id =&gt; (User.find(params[:user_id]).id), :purpose =&gt; &quot;other&quot;, :user_id =&gt; (session[:user].id), :sent_email_id =&gt; (<span class="user_input">Mailprep.send_emails_with_cc_bcc(EmailTemplate.find(params[:email_template_id]).to_tmail(Lead.find(params[:lead_id]), Quote.find(params[:quote_id]), User.find(params[:user_id]), params[:to], (params[:bodyhash] or {}), (params[:cc] or &quot;&quot;).split(&quot;,&quot;), (params[:bcc] or &quot;&quot;).split(&quot;,&quot;), EmailTemplate.params_to_attachments(params)))[0]</span>[1].id))</span><table id='context17' class='context' style='display:none'><caption>app/controllers/email_templates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>182</pre>
          </td>
          <td class='context'>
            <pre class='context'>          :outcome =&gt; these_outcomes, </pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :quote_included =&gt; @email_template.include_estimate_tables_as_bool, </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>184</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :initiator_id =&gt; @user.id, </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :purpose =&gt; 'other', </pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :user_id =&gt; session[:user].id,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>187</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :sent_email_id =&gt; @results[0][1].id</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>        })</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>190</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if @event.outcome.nil? or @event.outcome == ''</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>191</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @event.outcome = 'other'</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>192</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>EmailTemplatesController</td>
    <td>review_manual_email</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context18');toggle('message18');toggle('full_message18')" ><span id='message18' style='display:block' >Unprotected mass assignment near line 273: Event.new(:lead_id =&gt; (Lead.find(params[:lead_id]).id), :n...</span><span id='full_message18' style='display:none'>Unprotected mass assignment near line 273: Event.new(:lead_id =&gt; (Lead.find(params[:lead_id]).id), :notes =&gt; (((((((((&quot;Template: &quot; + EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).name.to_s) + &quot;&lt;br&gt;Attachments: &quot;) + EmailTemplate.params_to_attachments(params, EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]]))).map do  (local x).original_filename  end.join(&quot;, &quot;)) + &quot;&lt;br&gt;Quote Included: &quot;) + Event.quote_message((EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).get_bodyhash(Lead.find(params[:lead_id]), Quote.find(params[:quote_id]), User.find(params[:user_id])) or session[:pending_bodyhash]), EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])))) + &quot;&lt;br&gt;Signature: &quot;) + User.find(params[:user_id]).firstname) + &quot;&lt;br&gt;Reviewed: Quicksend &lt;br&gt;From Task: No&quot;)), :initiator =&gt; (User.find(params[:user_id]).firstname), :mode =&gt; &quot;email&quot;, :outcome =&gt; ((&quot;other&quot; or EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).default_outcomes.to_s)), :quote_included =&gt; (EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).include_estimate_tables_as_bool), :initiator_id =&gt; (User.find(params[:user_id]).id), :purpose =&gt; &quot;other&quot;, :user_id =&gt; (session[:user].id), :sent_email_id =&gt; (<span class="user_input">Mailprep.send_emails_with_cc_bcc(MailSender.create_from_template_new(Lead.find(params[:lead_id]).contact_email, (EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).get_bodyhash(Lead.find(params[:lead_id]), Quote.find(params[:quote_id]), User.find(params[:user_id])) or session[:pending_bodyhash]), EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).include_estimate_tables_as_bool, EmailTemplate.params_to_attachments(params, EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])))))[0]</span>[1].id))</span><table id='context18' class='context' style='display:none'><caption>app/controllers/email_templates_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>268</pre>
          </td>
          <td class='context'>
            <pre class='context'>          :outcome =&gt; these_outcomes, </pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>269</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :quote_included =&gt; @email_template.include_estimate_tables_as_bool, </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>270</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :initiator_id =&gt; @user.id, </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>271</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :purpose =&gt; 'other', </pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>272</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :user_id =&gt; session[:user].id,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>273</pre>
            </td>
            <td class='context'>
              <pre class='context'>          :sent_email_id =&gt; @results[0][1].id</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>274</pre>
            </td>
            <td class='context'>
              <pre class='context'>        }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>275</pre>
            </td>
            <td class='context'>
              <pre class='context'>        )</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>277</pre>
            </td>
            <td class='context'>
              <pre class='context'>#        breakpoint</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>EmailsController</td>
    <td>new</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context20');toggle('message20');toggle('full_message20')" >Unprotected mass assignment near line 44: Email.new(&quot;b&quot;)<table id='context20' class='context' style='display:none'><caption>app/controllers/emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @email = Email.find(params[:id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /emails/new</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def new</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email = Email.new('b')</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /emails/1;edit</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def edit</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @email = Email.find(params[:id])</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Event</td>
    <td>Event.record_email_sent</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context64');toggle('message64');toggle('full_message64')" ><span id='message64' style='display:block' >Unprotected mass assignment near line 94: self.new(:lead_id =&gt; (DnEmail.find((local event).dn_email_i...</span><span id='full_message64' style='display:none'>Unprotected mass assignment near line 94: self.new(:lead_id =&gt; (<span class="user_input">DnEmail.find((local event).dn_email_id)</span>.lead_id), :notes =&gt; ((((((((((&quot;Template: &quot; + (if (<span class="user_input">DnEmail.find((local event).dn_email_id)</span>.class.to_s == &quot;DnConfirmationLetter&quot;) then   <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.confirmation_letter_template.name.to_s else   <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.email_template.name.to_s end)) + &quot;&lt;br&gt;Attachments: &quot;) + <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.attachments.map do  (local x).original_filename  end.join(&quot;, &quot;)) + &quot;&lt;br&gt;Quote Included: &quot;) + (self.quote_message(<span class="user_input">DnEmail.find((local event).dn_email_id)</span>.bodyhash, <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.confirmation_letter_template) or self.quote_message(<span class="user_input">DnEmail.find((local event).dn_email_id)</span>.bodyhash, <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.email_template))) + &quot;&lt;br&gt;Signature: &quot;) + <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.user.firstname) + &quot;&lt;br&gt;Reviewed: Yes &lt;br&gt;From Task: &quot;) + ((local fromtask) ? (&quot;Yes&quot;) : (&quot;No&quot;)))), :initiator =&gt; (<span class="user_input">DnEmail.find((local event).dn_email_id)</span>.user.firstname), :mode =&gt; &quot;email&quot;, :outcome =&gt; (if <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.event_outcomes.blank? then   &quot;&quot; else   <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.event_outcomes.join(&quot;, &quot;) end), :quote_included =&gt; (if (<span class="user_input">DnEmail.find((local event).dn_email_id)</span>.class.to_s == &quot;DnConfirmationLetter&quot;) then   <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.confirmation_letter_template.include_estimate_tables_as_bool else   <span class="user_input">DnEmail.find((local event).dn_email_id)</span>.email_template.include_estimate_tables_as_bool end), :initiator_id =&gt; (<span class="user_input">DnEmail.find((local event).dn_email_id)</span>.user.id), :purpose =&gt; &quot;other&quot;, :user_id =&gt; (<span class="user_input">DnEmail.find((local event).dn_email_id)</span>.user.id))</span><table id='context64' class='context' style='display:none'><caption>app/models/event.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>89</pre>
          </td>
          <td class='context'>
            <pre class='context'>      :mode =&gt; 'email', </pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :outcome =&gt; dn_email.event_outcomes.blank? ? &quot;&quot; : dn_email.event_outcomes.join(', '), </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :quote_included =&gt; (dn_email.class.to_s == &quot;DnConfirmationLetter&quot; ? dn_email.confirmation_letter_template.include_estimate_tables_as_bool : dn_email.email_template.include_estimate_tables_as_bool),</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :initiator_id =&gt; dn_email.user.id, </pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :purpose =&gt; 'other', </pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :user_id =&gt; dn_email.user.id</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #:sent_email_id =&gt; @results[0][1].id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>    })</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if dn_email.class.to_s == &quot;DnConfirmationLetter&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output[:dn_email_id] = nil</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Event</td>
    <td>Event.initialized_for_email_quicksent</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context65');toggle('message65');toggle('full_message65')" ><span id='message65' style='display:block' >Unprotected mass assignment near line 136: Event.new(:lead_id =&gt; (Lead.find((local event).lead_id).id...</span><span id='full_message65' style='display:none'>Unprotected mass assignment near line 136: Event.new(:lead_id =&gt; (Lead.find((local event).lead_id).id), :notes =&gt; (((((((((&quot;Template: &quot; + (local options)[&quot;email_template&quot;].name.to_s) + &quot;&lt;br&gt;Attachments: &quot;) + (local options)[&quot;attachments&quot;].map do  (local x).original_filename  end.join(&quot;, &quot;)) + &quot;&lt;br&gt;Quote Included: &quot;) + <span class="user_input">Event.quote_message((local options)[&quot;bodyhash&quot;], (local options)[&quot;email_template&quot;])</span>) + &quot;&lt;br&gt;Signature: &quot;) + (local user).firstname) + &quot;&lt;br&gt;Reviewed: Quicksend &lt;br&gt;From Task: No&quot;)), :initiator =&gt; ((local user).firstname), :mode =&gt; &quot;email&quot;, :outcome =&gt; ((&quot;other&quot; or (local options)[&quot;email_template&quot;].default_outcomes.to_s)), :quote_included =&gt; ((local options)[&quot;email_template&quot;].include_estimate_tables_as_bool), :initiator_id =&gt; ((local user).id), :purpose =&gt; &quot;other&quot;, :user_id =&gt; ((local user).id), :sent_email_id =&gt; ((local options)[&quot;sent_email&quot;].id))</span><table id='context65' class='context' style='display:none'><caption>app/models/event.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>132</pre>
          </td>
          <td class='context'>
            <pre class='context'>    event = Event.new({:lead_id =&gt; lead.id, </pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :notes =&gt; (</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'Template: '+email_template.name.to_s+'&lt;br&gt;'+</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'Attachments: '+attachments.map{|x| x.original_filename}.join(', ')+'&lt;br&gt;'+</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'Quote Included: '+quote_sent+'&lt;br&gt;'+</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>137</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'Signature: '+ user.firstname + '&lt;br&gt;'+</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>138</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'Reviewed: Quicksend &lt;br&gt;'+</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>139</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'From Task: No'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>140</pre>
            </td>
            <td class='context'>
              <pre class='context'>      ), </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>141</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :initiator =&gt; user.firstname, </pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Event</td>
    <td>Event.get_status_changer</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context66');toggle('message66');toggle('full_message66')" ><span id='message66' style='display:block' >Unprotected mass assignment near line 167: self.new(:lead_id =&gt; (Lead.find((local event).lead_id).id)...</span><span id='full_message66' style='display:none'>Unprotected mass assignment near line 167: self.new(:lead_id =&gt; (Lead.find((local event).lead_id).id), :user_id =&gt; ((local user).id), :initiator_id =&gt; ((local user).id), :initiator =&gt; (<span class="user_input">User.find((local user).id).firstname</span>), :outcome =&gt; ({ &quot;Booked&quot; =&gt; &quot;move booked&quot;, &quot;Inactive&quot; =&gt; &quot;inactive/not interested&quot;, &quot;Successfully Contacted&quot; =&gt; &quot;successful contact&quot;, &quot;Re Attempting Contact&quot; =&gt; &quot;reattempting contact&quot;, &quot;Postponed&quot; =&gt; &quot;postponed&quot; }[(local new_status)]), :mode =&gt; &quot;other&quot;, :purpose =&gt; &quot;other&quot;, :notes =&gt; ((local notes)))</span><table id='context66' class='context' style='display:none'><caption>app/models/event.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>162</pre>
          </td>
          <td class='context'>
            <pre class='context'>        :outcome =&gt; {'Booked' =&gt; 'move booked', 'Inactive' =&gt; 'inactive/not interested', 'Successfully Contacted' =&gt; 'successful contact', 'Re Attempting Contact' =&gt; 'reattempting contact', 'Postponed' =&gt; 'postponed'}[new_status],</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>163</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :mode =&gt; 'other',</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>164</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :purpose =&gt; 'other',</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>165</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :notes =&gt; notes</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>166</pre>
            </td>
            <td class='context'>
              <pre class='context'>      }</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>167</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output = self.new(attr_hash)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>168</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>169</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>170</pre>
            </td>
            <td class='context'>
              <pre class='context'>      return false</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>171</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>172</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Event</td>
    <td>Event.get_merge_event</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context67');toggle('message67');toggle('full_message67')" ><span id='message67' style='display:block' >Unprotected mass assignment near line 186: self.new(:lead_id =&gt; (Lead.find((local event).lead_id).id)...</span><span id='full_message67' style='display:none'>Unprotected mass assignment near line 186: self.new(:lead_id =&gt; (Lead.find((local event).lead_id).id), :user_id =&gt; ((local user).id), :initiator_id =&gt; ((local user).id), :initiator =&gt; (<span class="user_input">User.find((local user).id).firstname</span>), :outcome =&gt; &quot;merge&quot;, :mode =&gt; &quot;other&quot;, :purpose =&gt; &quot;other&quot;, :notes =&gt; (&quot;Another lead was merged with this one: #{(local other_lead).merge_related_identifier_string}.&lt;br/&gt;  #{if (local resets_status) then   &quot;This event resets status.&quot; else   &quot;This event DOES NOT reset status.&quot; end}&quot;), :resets_status =&gt; ((local resets_status)))</span><table id='context67' class='context' style='display:none'><caption>app/models/event.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>181</pre>
          </td>
          <td class='context'>
            <pre class='context'>      :mode =&gt; 'other',</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>182</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :purpose =&gt; 'other',</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :notes =&gt; &quot;Another lead was merged with this one: #{other_lead.merge_related_identifier_string}.&lt;br/&gt;  #{resets_status ? 'This event resets status.' : 'This event DOES NOT reset status.'}&quot;,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>184</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :resets_status =&gt; resets_status,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>    }</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = self.new(attr_hash)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>187</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Event</td>
    <td>Event.record_auto_email_sent</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context68');toggle('message68');toggle('full_message68')" ><span id='message68' style='display:block' >Unprotected mass assignment near line 522: self.new(:lead_id =&gt; (DnEmail.find((local event).dn_email_...</span><span id='full_message68' style='display:none'>Unprotected mass assignment near line 522: self.new(:lead_id =&gt; (DnEmail.find((local event).dn_email_id).lead_id), :notes =&gt; ((((((((((&quot;Template: &quot; + DnEmail.find((local event).dn_email_id).email_template.name.to_s) + &quot;&lt;br&gt;Attachments: &quot;) + DnEmail.find((local event).dn_email_id).attachments.map do  (local x).original_filename  end.join(&quot;, &quot;)) + &quot;&lt;br&gt;Quote Included: &quot;) + self.quote_message(DnEmail.find((local event).dn_email_id).bodyhash, DnEmail.find((local event).dn_email_id).email_template)) + &quot;&lt;br&gt;Signature: &quot;) + DnEmail.find((local event).dn_email_id).user.firstname) + &quot;&lt;br&gt;Reviewed: Yes &lt;br&gt;From Task: &quot;) + ((local fromtask) ? (&quot;Yes&quot;) : (&quot;No&quot;)))), :initiator =&gt; (DnEmail.find((local event).dn_email_id).user.firstname), :mode =&gt; &quot;other&quot;, :outcome =&gt; &quot;other&quot;, :quote_included =&gt; (DnEmail.find((local event).dn_email_id).email_template.include_estimate_tables_as_bool), :initiator_id =&gt; (DnEmail.find((local event).dn_email_id).user.id), :purpose =&gt; &quot;other&quot;, :user_id =&gt; (DnEmail.find((local event).dn_email_id).user.id), :dn_email_id =&gt; (<span class="user_input">DnEmail.find((local event).dn_email_id).id</span>))</span><table id='context68' class='context' style='display:none'><caption>app/models/event.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>517</pre>
          </td>
          <td class='context'>
            <pre class='context'>      :outcome =&gt; 'other',</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>518</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :quote_included =&gt; dn_email.email_template.include_estimate_tables_as_bool,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>519</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :initiator_id =&gt; dn_email.user.id,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>520</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :purpose =&gt; 'other',</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>521</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :user_id =&gt; dn_email.user.id,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>522</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :dn_email_id =&gt; dn_email.id</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>523</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #:sent_email_id =&gt; @results[0][1].id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>524</pre>
            </td>
            <td class='context'>
              <pre class='context'>    })</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>526</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>527</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Event</td>
    <td>initialize</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context86');toggle('message86');toggle('full_message86')" >Unprotected mass assignment near line 234: self.attributes = (local attributes)<table id='context86' class='context' style='display:none'><caption>app/models/event.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>230</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def initialize(attributes = nil, event_form_inputs = nil)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>231</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @attributes = attributes_from_column_definition</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>232</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @new_record = true</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>233</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ensure_proper_type</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>234</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.attributes = attributes unless attributes.nil?</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>235</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>237</pre>
            </td>
            <td class='context'>
              <pre class='context'>    Event.update_event_according_to_form_inputs(self, event_form_inputs) unless event_form_inputs.nil?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>239</pre>
            </td>
            <td class='context'>
              <pre class='context'>    yield self if block_given?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>EventInterface</td>
    <td>EventInterface.new_event</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context69');toggle('message69');toggle('full_message69')" >Unprotected mass assignment near line 9: Event.new((local attributes))<table id='context69' class='context' style='display:none'><caption>app/models/event_interface.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def self.new_event(attributes)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    MyLogger.logthis('WARNING!!!  EventInterface.new_event called with attribute \'filed_under\' inclded') if attributes['filed_under']</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    Event.new(attributes)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def self.old_function(function_name, arguments = {})</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>FixedpriceJobsController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context25');toggle('message25');toggle('full_message25')" ><span id='message25' style='display:block' >Unprotected mass assignment near line 56: Inventory.new(:lead_id =&gt; (FixedpriceJob.find(params[:job_t...</span><span id='full_message25' style='display:none'>Unprotected mass assignment near line 56: Inventory.new(:lead_id =&gt; (FixedpriceJob.find(params[:job_type_id]).lead_id), :purpose =&gt; (<span class="user_input">FixedpriceJob.find(params[:job_type_id]).id</span>), :purpose_type =&gt; &quot;Job Fixed Price&quot;)</span><table id='context25' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>51</pre>
          </td>
          <td class='context'>
            <pre class='context'>    }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_custom_services = JobCustomService.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ?&quot;, params[:job_type_id], &quot;Job Fixed Price&quot;])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @desc_fields = JobDescription.find(:all)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @inventory.nil?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @inventory = Inventory.new(:lead_id =&gt; @job.lead_id, :purpose =&gt; @job.id, :purpose_type =&gt; &quot;Job Fixed Price&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @inventory.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @phones = []</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless @job.phone.nil?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>FixedpriceJobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context149');toggle('message149');toggle('full_message149')" >Unprotected mass assignment near line 183: JobExtraStop.create((local value))<table id='context149' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>179</pre>
          </td>
          <td class='context'>
            <pre class='context'>    unless params[:job_extra_stop].blank?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>180</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:job_extra_stop].each do |key, value|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>181</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if value[:id].blank?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes = JobExtraStop.create(value)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>184</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.job_id = @job_up.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.lead_id = @job_up.lead_id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.job_type = &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>187</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>FixedpriceJobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context150');toggle('message150');toggle('full_message150')" >Unprotected mass assignment near line 218: JobCustomService.create((local value))<table id='context150' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>214</pre>
          </td>
          <td class='context'>
            <pre class='context'>    unless params[:job_custom_service].blank?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>215</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:job_custom_service].each do |key, value|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>216</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if value[:id].blank?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>218</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs = JobCustomService.create(value)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>219</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.job_id = @job_up.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>220</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.job_type = &quot;Job Fixed Price&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>221</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.created_at = Date.today</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>222</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>223</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>FixedpriceJobsController</td>
    <td>Add_Day_FP</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context152');toggle('message152');toggle('full_message152')" >Unprotected mass assignment near line 272: JobExtraStop.create((local current_stop).attributes)<table id='context152' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>267</pre>
          </td>
          <td class='context'>
            <pre class='context'>      all_creditcard = CreditCard.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ? and lead_id = ?&quot;, params[:job_type_id], &quot;Job Fixed Price&quot;, current_job.lead_id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>268</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day = FixedpriceJob.create(current_job.attributes.merge({:created_on =&gt; DateTime.now(), :created_by =&gt; session[:user].fullname.split(' ')[0]}))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>269</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day.day = total_jobs.last.day.to_i + 1</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>270</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @new_day.save</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>271</pre>
            </td>
            <td class='context'>
              <pre class='context'>        current_stops.each do |current_stop|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>272</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop = JobExtraStop.create(current_stop.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>273</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.job_id = @new_day.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>274</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>275</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>276</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless all_creditcard.blank?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>277</pre>
            </td>
            <td class='context'>
              <pre class='context'>          all_creditcard.each do |cc|</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>FixedpriceJobsController</td>
    <td>Add_Day_FP</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context154');toggle('message154');toggle('full_message154')" ><span id='message154' style='display:block' >Unprotected mass assignment near line 283: JobCustomService.create((local current_service).attributes...</span><span id='full_message154' style='display:none'>Unprotected mass assignment near line 283: JobCustomService.create((local current_service).attributes)</span><table id='context154' class='context' style='display:none'><caption>app/controllers/fixedprice_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>278</pre>
          </td>
          <td class='context'>
            <pre class='context'>            CreditCard.create(cc.attributes.merge({:job_id =&gt; @new_day.id, :card_number =&gt; CreditCard.decrypt_rsa(cc.card_number, CreditCard::RSA_PASS)}))</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>279</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>280</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>281</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_services.nil?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>282</pre>
            </td>
            <td class='context'>
              <pre class='context'>          current_services.each do |current_service|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>283</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service = JobCustomService.create(current_service.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>284</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service.job_id = @new_day.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>285</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>286</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>287</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>288</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_inventory.nil?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>HotCondition</td>
    <td>initialize</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context87');toggle('message87');toggle('full_message87')" >Unprotected mass assignment near line 43: self.attributes = (local attributes)<table id='context87' class='context' style='display:none'><caption>app/models/hot_condition.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>    def initialize(attributes = nil, condition_form = nil)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @attributes = attributes_from_column_definition</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_record = true</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>      ensure_proper_type</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>      self.attributes = attributes unless attributes.nil?</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>      self.class.send(:scope, :create).each { |att,value| self.send(&quot;#{att}=&quot;, value) } if self.class.send(:scoped?, :create)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      Condition.update_event_according_to_form_inputs(self, condition_form) unless condition_form.nil?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      yield self if block_given?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>HotConditionsController</td>
    <td>new</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context26');toggle('message26');toggle('full_message26')" >Unprotected mass assignment near line 29: HotCondition.new(:flavor =&gt; (<span class="user_input">params[:flavor]</span>))<table id='context26' class='context' style='display:none'><caption>app/controllers/hot_conditions_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>24</pre>
          </td>
          <td class='context'>
            <pre class='context'>    end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /hot_conditions/new</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def new</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @hot_condition = HotCondition.new(:flavor =&gt; params[:flavor])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if !params[:flavor]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise &quot;HotConditionsController.new called without necessary param 'flavor'&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>    formname = 'new_'+params[:flavor]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render 'hot_conditions/'+formname</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>ImportJobsController</td>
    <td>handle_csv_import</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context107');toggle('message107');toggle('full_message107')" ><span id='message107' style='display:block' >Unprotected mass assignment near line 23: <span class="user_input">ImportJob.new(params[:import_job])</span>.update_attributes(:filep...</span><span id='full_message107' style='display:none'>Unprotected mass assignment near line 23: <span class="user_input">ImportJob.new(params[:import_job])</span>.update_attributes(:filepath =&gt; ((&quot;#{RAILS_ROOT}/public/import_files/&quot; + <span class="user_input">ImportJob.new(params[:import_job])</span>.id.to_s)))</span><table id='context107' class='context' style='display:none'><caption>app/controllers/import_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>18</pre>
          </td>
          <td class='context'>
            <pre class='context'>      filepath = &quot;#{RAILS_ROOT}/public/import_files/&quot;+ @import_job.id.to_s</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #raise &quot;filepath = &quot;+filepath</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>      File.open(filepath, 'wb') do |f|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>        f.write(@params[:csv_file].read)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @import_job.update_attributes(:filepath =&gt; filepath)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @import_job.update_attributes(:target_class =&gt; &quot;Lead&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise &quot;could not save import job, even before attaching file&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Importer</td>
    <td>Importer.attempt_import</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context71');toggle('message71');toggle('full_message71')" >Unprotected mass assignment near line 227: Email.new((local uidl_message)[1])<table id='context71' class='context' style='display:none'><caption>app/models/importer.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>222</pre>
          </td>
          <td class='context'>
            <pre class='context'>    if Email.find(:first, :conditions =&gt; [&quot;uidl = ?&quot;, uidl_message[0]]).class == Email</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>223</pre>
            </td>
            <td class='context'>
              <pre class='context'>      MyLogger.logimport('returning nil because an Email with this uidl is already in the database')</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>224</pre>
            </td>
            <td class='context'>
              <pre class='context'>      return nil</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>225</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>227</pre>
            </td>
            <td class='context'>
              <pre class='context'>    email = Email.new(uidl_message[1])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>229</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if email.class != Email</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>230</pre>
            </td>
            <td class='context'>
              <pre class='context'>      MyLogger.logimport('Email.new(emailstring) did not yield an email. uidl was '+uidl_message[0])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>231</pre>
            </td>
            <td class='context'>
              <pre class='context'>      return nil</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>232</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Importer</td>
    <td>Importer.attempt_import</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context72');toggle('message72');toggle('full_message72')" >Unprotected mass assignment near line 236: UndigestibleEmail.new((local uidl_message)[1])<table id='context72' class='context' style='display:none'><caption>app/models/importer.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>231</pre>
          </td>
          <td class='context'>
            <pre class='context'>      return nil</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>232</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>233</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if make_undigestible</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>234</pre>
            </td>
            <td class='context'>
              <pre class='context'>      uecount1 = UndigestibleEmail.count</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>236</pre>
            </td>
            <td class='context'>
              <pre class='context'>      ue = UndigestibleEmail.new(uidl_message[1])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>237</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if ue.class != UndigestibleEmail</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>238</pre>
            </td>
            <td class='context'>
              <pre class='context'>        MyLogger.logimport('UndigestibleEmail.new(emailstring) did not yield an UndigestibleEmail. uidl was '+uidl_message[0])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>239</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>240</pre>
            </td>
            <td class='context'>
              <pre class='context'>      ue.set_uidl(uidl_message[0])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>241</pre>
            </td>
            <td class='context'>
              <pre class='context'>      uesave_result = ue.save</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>InventoriesController</td>
    <td>edit</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context31');toggle('message31');toggle('full_message31')" >Unprotected mass assignment near line 39: Inventory.new(:lead_id =&gt; (<span class="user_input">params[:lead_id]</span>))<table id='context31' class='context' style='display:none'><caption>app/controllers/inventories_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>34</pre>
          </td>
          <td class='context'>
            <pre class='context'>    if(params[:job_type_id].nil?)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>       @inventory = Inventory.find(:first, :conditions =&gt; [&quot;lead_id = ? and purpose is null&quot;, params[:lead_id]])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #breakpoint</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @inventory.nil?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @inventory = Inventory.new(:lead_id =&gt; params[:lead_id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @inventory.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render_partial 'inventories/form', 'inventory' =&gt; @inventory, 'job_type' =&gt; nil</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #breakpoint</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>InventoriesController</td>
    <td>edit</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context32');toggle('message32');toggle('full_message32')" ><span id='message32' style='display:block' >Unprotected mass assignment near line 55: Inventory.new(:lead_id =&gt; (params[:lead_id]), :purpose =&gt; (...</span><span id='full_message32' style='display:none'>Unprotected mass assignment near line 55: Inventory.new(:lead_id =&gt; (params[:lead_id]), :purpose =&gt; (params[:job_type_id]), :purpose_type =&gt; (<span class="user_input">params[:job_type]</span>))</span><table id='context32' class='context' style='display:none'><caption>app/controllers/inventories_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>50</pre>
          </td>
          <td class='context'>
            <pre class='context'>       else</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>         @job = Job.find(params[:job_type_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>       end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #breakpoint</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @inventory.nil?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @inventory = Inventory.new(:lead_id =&gt; params[:lead_id], :purpose =&gt; params[:job_type_id], :purpose_type =&gt; params[:job_type] )</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @inventory.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render_partial 'inventories/form', 'inventory' =&gt; @inventory  , 'job' =&gt; @job, 'job_type' =&gt; params[:job_type]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>JobReferencesController</td>
    <td>assign_for_lead</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context110');toggle('message110');toggle('full_message110')" ><span id='message110' style='display:block' >Unprotected mass assignment near line 31: Lead.find(params[:lead_id]).update_attributes(:reference_1_...</span><span id='full_message110' style='display:none'>Unprotected mass assignment near line 31: Lead.find(params[:lead_id]).update_attributes(:reference_1_id =&gt; (<span class="user_input">params[:job_reference_id]</span>))</span><table id='context110' class='context' style='display:none'><caption>app/controllers/job_references_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>26</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def assign_for_lead</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead = Lead.find(params[:lead_id])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>    case params[:index].to_i</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when 1</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_1_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when 2</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_2_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when 3</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_3_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>JobReferencesController</td>
    <td>assign_for_lead</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context111');toggle('message111');toggle('full_message111')" ><span id='message111' style='display:block' >Unprotected mass assignment near line 33: Lead.find(params[:lead_id]).update_attributes(:reference_2_...</span><span id='full_message111' style='display:none'>Unprotected mass assignment near line 33: Lead.find(params[:lead_id]).update_attributes(:reference_2_id =&gt; (<span class="user_input">params[:job_reference_id]</span>))</span><table id='context111' class='context' style='display:none'><caption>app/controllers/job_references_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>28</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @lead = Lead.find(params[:lead_id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>    case params[:index].to_i</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when 1</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_1_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when 2</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_2_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when 3</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_3_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to &quot;/leads/#{@lead.id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>JobReferencesController</td>
    <td>assign_for_lead</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context112');toggle('message112');toggle('full_message112')" ><span id='message112' style='display:block' >Unprotected mass assignment near line 35: Lead.find(params[:lead_id]).update_attributes(:reference_3_...</span><span id='full_message112' style='display:none'>Unprotected mass assignment near line 35: Lead.find(params[:lead_id]).update_attributes(:reference_3_id =&gt; (<span class="user_input">params[:job_reference_id]</span>))</span><table id='context112' class='context' style='display:none'><caption>app/controllers/job_references_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>30</pre>
          </td>
          <td class='context'>
            <pre class='context'>    when 1</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_1_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when 2</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_2_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>    when 3</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @lead.update_attributes(:reference_3_id =&gt; params[:job_reference_id])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to &quot;/leads/#{@lead.id};show&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /job_references</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>JobsController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context37');toggle('message37');toggle('full_message37')" ><span id='message37' style='display:block' >Unprotected mass assignment near line 58: Inventory.new(:lead_id =&gt; (Job.find(params[:job_type_id]).l...</span><span id='full_message37' style='display:none'>Unprotected mass assignment near line 58: Inventory.new(:lead_id =&gt; (Job.find(params[:job_type_id]).lead_id), :purpose =&gt; (<span class="user_input">Job.find(params[:job_type_id]).id</span>), :purpose_type =&gt; &quot;Job Hourly&quot;)</span><table id='context37' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>53</pre>
          </td>
          <td class='context'>
            <pre class='context'>    }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_custom_services = JobCustomService.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ?&quot;, params[:job_type_id], &quot;Job Hourly&quot;])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @desc_fields = JobDescription.find(:all)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @inventory.nil?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @inventory = Inventory.new(:lead_id =&gt; @job.lead_id, :purpose =&gt; @job.id, :purpose_type =&gt; &quot;Job Hourly&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @inventory.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @phones = []</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless @job.phone.nil?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>JobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context156');toggle('message156');toggle('full_message156')" >Unprotected mass assignment near line 338: JobExtraStop.create((local value))<table id='context156' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>334</pre>
          </td>
          <td class='context'>
            <pre class='context'>    unless params[:job_extra_stop].blank?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>335</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:job_extra_stop].each do |key, value|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>336</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if value[:id].blank?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>338</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes = JobExtraStop.create(value)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>339</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.job_id = @job_up.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>340</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.lead_id = @job_up.lead_id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>341</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.job_type = &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>342</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>343</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>JobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context157');toggle('message157');toggle('full_message157')" >Unprotected mass assignment near line 373: JobCustomService.create((local value))<table id='context157' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>369</pre>
          </td>
          <td class='context'>
            <pre class='context'>    unless params[:job_custom_service].blank?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>370</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:job_custom_service].each do |key, value|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>371</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if value[:id].blank?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>373</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs = JobCustomService.create(value)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>374</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.job_id = @job_up.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>375</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.job_type = &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>376</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.created_at = Date.today</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>377</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>378</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>JobsController</td>
    <td>job_process</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context158');toggle('message158');toggle('full_message158')" ><span id='message158' style='display:block' >Unprotected mass assignment near line 436: JobProject.create(:lead_id =&gt; (params[:lead_id]), :created...</span><span id='full_message158' style='display:none'>Unprotected mass assignment near line 436: JobProject.create(:lead_id =&gt; (params[:lead_id]), :created_at =&gt; (DateTime.now), :job_type =&gt; (<span class="user_input">params[:job_type]</span>))</span><table id='context158' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>431</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def job_process</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>433</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if ((params[:lead_id].nil?) || (params[:quote_id].nil?))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>434</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise &quot;NO Lead/Quote information sent&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>435</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>436</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @job_project = JobProject.create(:lead_id =&gt; params[:lead_id], :created_at =&gt; DateTime.now, :job_type =&gt; params[:job_type])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>437</pre>
            </td>
            <td class='context'>
              <pre class='context'>      res = false</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>438</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @job_project.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>439</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if params[:job_type] == &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>440</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @job_new = Job.create</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>441</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @job_new.description = &quot;Job Hourly&quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>JobsController</td>
    <td>Add_Day</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context160');toggle('message160');toggle('full_message160')" >Unprotected mass assignment near line 586: JobExtraStop.create((local current_stop).attributes)<table id='context160' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>581</pre>
          </td>
          <td class='context'>
            <pre class='context'>      all_creditcard = CreditCard.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ? and lead_id = ?&quot;, params[:job_type_id], &quot;Job Hourly&quot;, current_job.lead_id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>582</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day = Job.create(current_job.attributes.merge({:created_on =&gt; DateTime.now(), :created_by =&gt; session[:user].fullname.split(' ')[0]}))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>583</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day.day = total_jobs.last.day.to_i + 1</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>584</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @new_day.save</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>585</pre>
            </td>
            <td class='context'>
              <pre class='context'>        current_stops.each do |current_stop|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>586</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop = JobExtraStop.create(current_stop.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>587</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.job_id = @new_day.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>588</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>589</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>590</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless all_creditcard.blank?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>591</pre>
            </td>
            <td class='context'>
              <pre class='context'>          all_creditcard.each do |cc|</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>JobsController</td>
    <td>Add_Day</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context162');toggle('message162');toggle('full_message162')" ><span id='message162' style='display:block' >Unprotected mass assignment near line 597: JobCustomService.create((local current_service).attributes...</span><span id='full_message162' style='display:none'>Unprotected mass assignment near line 597: JobCustomService.create((local current_service).attributes)</span><table id='context162' class='context' style='display:none'><caption>app/controllers/jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>592</pre>
          </td>
          <td class='context'>
            <pre class='context'>            CreditCard.create(cc.attributes.merge({:job_id =&gt; @new_day.id, :card_number =&gt; CreditCard.decrypt_rsa(cc.card_number, CreditCard::RSA_PASS)}))</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>593</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>594</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>595</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_services.nil?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>596</pre>
            </td>
            <td class='context'>
              <pre class='context'>          current_services.each do |current_service|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>597</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service = JobCustomService.create(current_service.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>598</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service.job_id = @new_day.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>599</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>600</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>601</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>602</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_inventory.nil?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Lead</td>
    <td>autoset_extra_stops</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context74');toggle('message74');toggle('full_message74')" ><span id='message74' style='display:block' >Unprotected mass assignment near line 1578: ExtraStop.new(:location_type =&gt; (Configurable.get_hash_by...</span><span id='full_message74' style='display:none'>Unprotected mass assignment near line 1578: ExtraStop.new(:location_type =&gt; (Configurable.get_hash_by_name(&quot;stops&quot;)[&quot;default_orig_location_type&quot;]), :activity =&gt; (<span class="user_input">Configurable.get_hash_by_name(&quot;stops&quot;)[&quot;default_orig_activity&quot;]</span>), :order =&gt; 1, :street_address =&gt; (@attributes[&quot;orig_street_address&quot;]), :city =&gt; (@attributes[&quot;orig_city&quot;]), :state =&gt; (@attributes[&quot;orig_state&quot;]), :zip =&gt; (@attributes[&quot;orig_zip&quot;]), :elevator =&gt; (@attributes[&quot;elevator_at_orig&quot;]), :floor =&gt; (@attributes[&quot;floor_at_orig&quot;]))</span><table id='context74' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1573</pre>
          </td>
          <td class='context'>
            <pre class='context'>      :state =&gt; @attributes['orig_state'],</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1574</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :zip =&gt; @attributes['orig_zip'],</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1575</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :elevator =&gt; @attributes['elevator_at_orig'],</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1576</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :floor =&gt; @attributes['floor_at_orig'],</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1577</pre>
            </td>
            <td class='context'>
              <pre class='context'>    }</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>1578</pre>
            </td>
            <td class='context'>
              <pre class='context'>    orig_stop = ExtraStop.new(orig_hash)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1579</pre>
            </td>
            <td class='context'>
              <pre class='context'>    dest_hash = {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1580</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :location_type =&gt; stops_config['default_dest_location_type'],</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1581</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :activity =&gt; stops_config['default_dest_activity'],</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1582</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :order =&gt; 2,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1583</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :street_address =&gt; @attributes['dest_street_address'],</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Lead</td>
    <td>autoset_extra_stops</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context75');toggle('message75');toggle('full_message75')" ><span id='message75' style='display:block' >Unprotected mass assignment near line 1590: ExtraStop.new(:location_type =&gt; (Configurable.get_hash_by...</span><span id='full_message75' style='display:none'>Unprotected mass assignment near line 1590: ExtraStop.new(:location_type =&gt; (Configurable.get_hash_by_name(&quot;stops&quot;)[&quot;default_dest_location_type&quot;]), :activity =&gt; (<span class="user_input">Configurable.get_hash_by_name(&quot;stops&quot;)[&quot;default_dest_activity&quot;]</span>), :order =&gt; 2, :street_address =&gt; (@attributes[&quot;dest_street_address&quot;]), :city =&gt; (@attributes[&quot;dest_city&quot;]), :state =&gt; (@attributes[&quot;dest_state&quot;]), :zip =&gt; (@attributes[&quot;dest_zip&quot;]), :elevator =&gt; (@attributes[&quot;elevator_at_dest&quot;]), :floor =&gt; (@attributes[&quot;floor_at_dest&quot;]))</span><table id='context75' class='context' style='display:none'><caption>app/models/lead.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1585</pre>
          </td>
          <td class='context'>
            <pre class='context'>      :state =&gt; @attributes['dest_state'],</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1586</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :zip =&gt; @attributes['dest_zip'],</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1587</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :elevator =&gt; @attributes['elevator_at_dest'],</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1588</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :floor =&gt; @attributes['floor_at_dest'],</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1589</pre>
            </td>
            <td class='context'>
              <pre class='context'>    }</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>1590</pre>
            </td>
            <td class='context'>
              <pre class='context'>    dest_stop = ExtraStop.new(dest_hash)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>1591</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.extra_stops = [orig_stop, dest_stop]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1592</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>1594</pre>
            </td>
            <td class='context'>
              <pre class='context'>  #### /ASSOCIATIONS</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>1595</pre>
            </td>
            <td class='context'>
              <pre class='context'>  #####################################</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>LeadsController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context41');toggle('message41');toggle('full_message41')" ><span id='message41' style='display:block' >Unprotected mass assignment near line 300: Event.new({ :lead_id =&gt; (<span class="user_input">Lead.find(params[:id]).id</span>) }, nil...</span><span id='full_message41' style='display:none'>Unprotected mass assignment near line 300: Event.new({ :lead_id =&gt; (<span class="user_input">Lead.find(params[:id]).id</span>) }, nil)</span><table id='context41' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>295</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @debug1 = String.new(session[:pending_bodyhash].to_s)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>297</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @lead = Lead.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>298</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_collections = Job.find(:all, :conditions =&gt; [&quot;lead_id = ?&quot;, @lead.id]).concat(FixedpriceJob.find(:all, :conditions =&gt; [&quot;lead_id = ?&quot;, @lead.id])).concat(MiscJob.find(:all, :conditions =&gt; [&quot;lead_id = ?&quot;, @lead.id]))</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>300</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @event_for_form = Event.new({:lead_id =&gt; @lead.id}, nil)  # second argument is event_form input</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>301</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @event_for_form = session[:pending_event] if session[:pending_event]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>303</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @old_attributes_stringified = Configurable.hash_to_string(@lead.attributes)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>305</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if params[:new_values_stringified]</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>LeadsController</td>
    <td>send_problem_report</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context118');toggle('message118');toggle('full_message118')" ><span id='message118' style='display:block' >Unprotected mass assignment near line 593: LeadCompany.find(params[:lead_company_id]).update_attribut...</span><span id='full_message118' style='display:none'>Unprotected mass assignment near line 593: LeadCompany.find(params[:lead_company_id]).update_attributes(&quot;last_report_sent_on&quot; =&gt; (Time.now), &quot;last_report_start_date&quot; =&gt; (Time.parse(((((params[&quot;start_year&quot;] + &quot;-&quot;) + params[&quot;start_month&quot;]) + &quot;-&quot;) + params[&quot;start_day&quot;]))), &quot;last_report_end_date&quot; =&gt; (Time.parse(<span class="user_input">((((params[&quot;end_year&quot;] + &quot;-&quot;) + params[&quot;end_month&quot;]) + &quot;-&quot;) + params[&quot;end_day&quot;])</span>)))</span><table id='context118' class='context' style='display:none'><caption>app/controllers/leads_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>588</pre>
          </td>
          <td class='context'>
            <pre class='context'>    else</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>589</pre>
            </td>
            <td class='context'>
              <pre class='context'>      lead_company.update_attributes(</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>590</pre>
            </td>
            <td class='context'>
              <pre class='context'>        {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>591</pre>
            </td>
            <td class='context'>
              <pre class='context'>          'last_report_sent_on'     =&gt; Time.now, </pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>592</pre>
            </td>
            <td class='context'>
              <pre class='context'>          'last_report_start_date'  =&gt; start_time, </pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>593</pre>
            </td>
            <td class='context'>
              <pre class='context'>          'last_report_end_date'    =&gt; end_time</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>594</pre>
            </td>
            <td class='context'>
              <pre class='context'>        }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>595</pre>
            </td>
            <td class='context'>
              <pre class='context'>      )</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>596</pre>
            </td>
            <td class='context'>
              <pre class='context'>      MyLogger.logthis('sent problem report email to lead_company with id = '+result[0][0])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>597</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash[:notice] = 'report was sent for '+lead_company.name</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>598</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Mailprep</td>
    <td>Mailprep.send_emails</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context76');toggle('message76');toggle('full_message76')" ><span id='message76' style='display:block' >Unprotected mass assignment near line 180: SentEmail.new(:sent_at =&gt; (Time.now), :smtp_response =&gt; ((...</span><span id='full_message76' style='display:none'>Unprotected mass assignment near line 180: SentEmail.new(:sent_at =&gt; (Time.now), :smtp_response =&gt; ((local smtp).sendmail((local tmail).encoded, <span class="user_input">Configurable.get_hash_by_name(&quot;send_mail_settings&quot;)[&quot;from_address&quot;]</span>, (local tmail).to[0])), :from =&gt; ((local tmail).from.to_a.join(&quot;, &quot;)), :to =&gt; ((local tmail).to.to_a.join(&quot;, &quot;)), :cc =&gt; ((local tmail).cc.to_a.join(&quot;, &quot;)), :bcc =&gt; ((local tmail).bcc.to_a.join(&quot;, &quot;)), :subject =&gt; ((local tmail).subject), :body =&gt; ((local tmail).body))</span><table id='context76' class='context' style='display:none'><caption>app/models/mailprep.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>175</pre>
          </td>
          <td class='context'>
            <pre class='context'>###############################</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>176</pre>
            </td>
            <td class='context'>
              <pre class='context'>          success_regex = Mailprep.smtpsend_success_regex#/250 2\.5\.0 Ok/</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>177</pre>
            </td>
            <td class='context'>
              <pre class='context'>          if r.scan(success_regex)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>178</pre>
            </td>
            <td class='context'>
              <pre class='context'>            sent_email = SentEmail.new({</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>179</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :sent_at =&gt; Time.now,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>180</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :smtp_response =&gt; r,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>182</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :from =&gt; tmail.from.to_a.join(', '),</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :to =&gt; tmail.to.to_a.join(', '),</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>184</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :cc =&gt; tmail.cc.to_a.join(', '  ),</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :bcc =&gt; tmail.bcc.to_a.join(', '),</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>MiscJobsController</td>
    <td>show</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context44');toggle('message44');toggle('full_message44')" ><span id='message44' style='display:block' >Unprotected mass assignment near line 57: Inventory.new(:lead_id =&gt; (MiscJob.find(params[:job_type_id...</span><span id='full_message44' style='display:none'>Unprotected mass assignment near line 57: Inventory.new(:lead_id =&gt; (MiscJob.find(params[:job_type_id]).lead_id), :purpose =&gt; (<span class="user_input">MiscJob.find(params[:job_type_id]).id</span>), :purpose_type =&gt; &quot;Miscellaneous Jobs&quot;)</span><table id='context44' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>    }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @job_custom_services = JobCustomService.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ?&quot;, params[:job_type_id], &quot;Miscellaneous Jobs&quot;])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @desc_fields = JobDescription.find(:all)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @inventory.nil?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @inventory = Inventory.new(:lead_id =&gt; @job.lead_id, :purpose =&gt; @job.id, :purpose_type =&gt; &quot;Miscellaneous Jobs&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @inventory.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @phones = []</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless @job.phone.nil?</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>MiscJobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context164');toggle('message164');toggle('full_message164')" >Unprotected mass assignment near line 184: JobExtraStop.create((local value))<table id='context164' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>180</pre>
          </td>
          <td class='context'>
            <pre class='context'>    unless params[:job_extra_stop].blank?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>181</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:job_extra_stop].each do |key, value|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>182</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if value[:id].blank?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>184</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes = JobExtraStop.create(value)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.job_id = @job_up.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.lead_id = @job_up.lead_id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>187</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.job_type = &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jes.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>189</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>MiscJobsController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context165');toggle('message165');toggle('full_message165')" >Unprotected mass assignment near line 219: JobCustomService.create((local value))<table id='context165' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>215</pre>
          </td>
          <td class='context'>
            <pre class='context'>    unless params[:job_custom_service].blank?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>216</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:job_custom_service].each do |key, value|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>217</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if value[:id].blank?</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>219</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs = JobCustomService.create(value)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>220</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.job_id = @job_up.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>221</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.job_type = &quot;Miscellaneous Jobs&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>222</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.created_at = Date.today</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>223</pre>
            </td>
            <td class='context'>
              <pre class='context'>          jcs.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>224</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>MiscJobsController</td>
    <td>Add_Day_MC</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context167');toggle('message167');toggle('full_message167')" >Unprotected mass assignment near line 274: JobExtraStop.create((local current_stop).attributes)<table id='context167' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>269</pre>
          </td>
          <td class='context'>
            <pre class='context'>      all_creditcard = CreditCard.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ? and lead_id = ?&quot;, params[:job_type_id], &quot;Miscellaneous Jobs&quot;, current_job.lead_id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>270</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day = MiscJob.create(current_job.attributes.merge({:created_on =&gt; DateTime.now(), :created_by =&gt; session[:user].fullname.split(' ')[0]}))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>271</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_day.day = total_jobs.last.day.to_i + 1</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>272</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @new_day.save</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>273</pre>
            </td>
            <td class='context'>
              <pre class='context'>        current_stops.each do |current_stop|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>274</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop = JobExtraStop.create(current_stop.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>275</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.job_id = @new_day.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>276</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @new_stop.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>277</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>278</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless all_creditcard.blank?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>279</pre>
            </td>
            <td class='context'>
              <pre class='context'>          all_creditcard.each do |cc|</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>MiscJobsController</td>
    <td>Add_Day_MC</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context169');toggle('message169');toggle('full_message169')" ><span id='message169' style='display:block' >Unprotected mass assignment near line 285: JobCustomService.create((local current_service).attributes...</span><span id='full_message169' style='display:none'>Unprotected mass assignment near line 285: JobCustomService.create((local current_service).attributes)</span><table id='context169' class='context' style='display:none'><caption>app/controllers/misc_jobs_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>280</pre>
          </td>
          <td class='context'>
            <pre class='context'>            CreditCard.create(cc.attributes.merge({:job_id =&gt; @new_day.id, :card_number =&gt; CreditCard.decrypt_rsa(cc.card_number, CreditCard::RSA_PASS)}))</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>281</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>282</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>283</pre>
            </td>
            <td class='context'>
              <pre class='context'>        unless current_services.nil?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>284</pre>
            </td>
            <td class='context'>
              <pre class='context'>          current_services.each do |current_service|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>285</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service = JobCustomService.create(current_service.attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>286</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service.job_id = @new_day.id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>287</pre>
            </td>
            <td class='context'>
              <pre class='context'>            @new_service.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>288</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>289</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Postprocessor</td>
    <td>Postprocessor.get_or_create_zipcode_or_pseudozipcode</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context77');toggle('message77');toggle('full_message77')" ><span id='message77' style='display:block' >Unprotected mass assignment near line 341: PseudoZipCode.new(&quot;latitude&quot; =&gt; (((((ZipCode.find(:all, :c...</span><span id='full_message77' style='display:none'>Unprotected mass assignment near line 341: PseudoZipCode.new(&quot;latitude&quot; =&gt; (((((<span class="user_input">ZipCode.find(:all, :conditions =&gt; ([&quot;city = ? and state = ?&quot;, (local cityname).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase, (local stateabb).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase])).map</span> do  (local z).latitude.to_f  end.inject do  sum = ((local sum) + (local lat))  end / <span class="user_input">ZipCode.find(:all, :conditions =&gt; ([&quot;city = ? and state = ?&quot;, (local cityname).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase, (local stateabb).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase])).map</span> do  (local z).latitude.to_f  end.length) * 1000000).floor.to_f / 1000000).to_s or (&quot;+&quot; + (((<span class="user_input">ZipCode.find(:all, :conditions =&gt; ([&quot;city = ? and state = ?&quot;, (local cityname).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase, (local stateabb).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase])).map</span> do  (local z).latitude.to_f  end.inject do  sum = ((local sum) + (local lat))  end / <span class="user_input">ZipCode.find(:all, :conditions =&gt; ([&quot;city = ? and state = ?&quot;, (local cityname).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase, (local stateabb).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase])).map</span> do  (local z).latitude.to_f  end.length) * 1000000).floor.to_f / 1000000).to_s))), &quot;longitude&quot; =&gt; (((((<span class="user_input">ZipCode.find(:all, :conditions =&gt; ([&quot;city = ? and state = ?&quot;, (local cityname).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase, (local stateabb).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase])).map</span> do  (local z).longitude.to_f  end.inject do  sum = (((local sum) + (local lat)) + (local long))  end / <span class="user_input">ZipCode.find(:all, :conditions =&gt; ([&quot;city = ? and state = ?&quot;, (local cityname).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase, (local stateabb).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase])).map</span> do  (local z).longitude.to_f  end.length) * 1000000).floor.to_f / 1000000).to_s or (&quot;+&quot; + (((<span class="user_input">ZipCode.find(:all, :conditions =&gt; ([&quot;city = ? and state = ?&quot;, (local cityname).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase, (local stateabb).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase])).map</span> do  (local z).longitude.to_f  end.inject do  sum = (((local sum) + (local lat)) + (local long))  end / <span class="user_input">ZipCode.find(:all, :conditions =&gt; ([&quot;city = ? and state = ?&quot;, (local cityname).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase, (local stateabb).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase])).map</span> do  (local z).longitude.to_f  end.length) * 1000000).floor.to_f / 1000000).to_s))), &quot;city&quot; =&gt; ((local cityname).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase), &quot;state&quot; =&gt; ((local stateabb).gsub(/^\s+/, &quot;&quot;).gsub(/\s+$/, &quot;&quot;).downcase))</span><table id='context77' class='context' style='display:none'><caption>app/models/postprocessor.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>336</pre>
          </td>
          <td class='context'>
            <pre class='context'>        'latitude'  =&gt; new_lat_string,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>337</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'longitude' =&gt; new_long_string,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>338</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'city'      =&gt; cityname.downcase,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>339</pre>
            </td>
            <td class='context'>
              <pre class='context'>        'state'     =&gt; stateabb.downcase,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>340</pre>
            </td>
            <td class='context'>
              <pre class='context'>      }</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>341</pre>
            </td>
            <td class='context'>
              <pre class='context'>      pseudozipcode = PseudoZipCode.new(attributes)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>342</pre>
            </td>
            <td class='context'>
              <pre class='context'>      pseudozipcode.save</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>344</pre>
            </td>
            <td class='context'>
              <pre class='context'>      return (100000 + pseudozipcode.id).to_s</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>346</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Quote</td>
    <td>custom_services</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context78');toggle('message78');toggle('full_message78')" ><span id='message78' style='display:block' >Unprotected mass assignment near line 336: CustomService.new(:quote_id =&gt; (id), :name =&gt; ((local x).s...</span><span id='full_message78' style='display:none'>Unprotected mass assignment near line 336: CustomService.new(:quote_id =&gt; (id), :name =&gt; ((local x).split(&quot;@@@@@&quot;)[0]), :price =&gt; ((local x).split(&quot;@@@@@&quot;)[1].to_f), :description =&gt; (<span class="user_input">Configurable.get_hash_by_name(&quot;additional_services&quot;)</span>[(local x).split(&quot;@@@@@&quot;)[0]][&quot;description&quot;] rescue &quot;no description&quot;))</span><table id='context78' class='context' style='display:none'><caption>app/models/quote.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>331</pre>
          </td>
          <td class='context'>
            <pre class='context'>    hash = Configurable.get_hash_by_name('additional_services')</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>332</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = custom_services_string.split(';;;;').map{|x| CustomService.new(</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>333</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :quote_id =&gt; id, </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>334</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :name =&gt; x.split('@@@@@')[0], </pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>335</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :price =&gt; x.split('@@@@@')[1].to_f,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>336</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :description =&gt; (hash[x.split('@@@@@')[0]]['description'] rescue &quot;no description&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>337</pre>
            </td>
            <td class='context'>
              <pre class='context'>      )}</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>338</pre>
            </td>
            <td class='context'>
              <pre class='context'>#    raise &quot;output = &quot;+Configurable.array_to_string(output.map{|x| x.attributes})</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>339</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>340</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Quoter</td>
    <td>Quoter.lead_to_quote</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context79');toggle('message79');toggle('full_message79')" ><span id='message79' style='display:block' >Unprotected mass assignment near line 10: Quote.new(self.body_hash_to_quote_hash(self.lead_to_body_ha...</span><span id='full_message79' style='display:none'>Unprotected mass assignment near line 10: Quote.new(self.body_hash_to_quote_hash(self.lead_to_body_hash((local lead), (local work_date_string)), (local lead).id))</span><table id='context79' class='context' style='display:none'><caption>app/models/quoter.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def self.lead_to_quote(lead, work_date_string = nil)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #    raise &quot;entered VQuoteHelper.lead_to_quote&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    debug = false</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>    MyLogger.logthis('entered VQuoteHelper.lead_to_quote') if debug</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    quotehash = self.body_hash_to_quote_hash(self.lead_to_body_hash(lead, work_date_string), lead.id)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    quote = Quote.new(quotehash)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>    quote.sendable = 1</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    quote.user_id = 1</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #raise &quot;VQuoteHelper.lead_to_quote about to return quote.attributes = #{Configurable.hash_to_string(quote.attributes)}&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    quote</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>QuotesController</td>
    <td>add_custom_service</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context49');toggle('message49');toggle('full_message49')" ><span id='message49' style='display:block' >Unprotected mass assignment near line 11: CustomService.new(:quote_id =&gt; (params[:quote_id]), :name =...</span><span id='full_message49' style='display:none'>Unprotected mass assignment near line 11: CustomService.new(:quote_id =&gt; (params[:quote_id]), :name =&gt; (params[:name]), :price =&gt; (<span class="user_input">CustomService.default_price_for(params[:name])</span>))</span><table id='context49' class='context' style='display:none'><caption>app/controllers/quotes_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>6</pre>
          </td>
          <td class='context'>
            <pre class='context'>    input_name = params[:input_name] || 'quote_id'</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render_partial 'quote_selector', 'quotes' =&gt; @quotes, 'input_name' =&gt; input_name</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def add_custom_service</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @service = CustomService.new(:quote_id =&gt; params[:quote_id], :name =&gt; params[:name], :price =&gt; CustomService.default_price_for(params[:name]) )</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render_partial  'custom_services/cs_form', 'service' =&gt; @service, 'index' =&gt; get_autoincrement_div_id </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def margin_compensator_old</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>SmsMessage</td>
    <td>SmsMessage.send_emails</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context80');toggle('message80');toggle('full_message80')" ><span id='message80' style='display:block' >Unprotected mass assignment near line 65: SentEmail.new(:sent_at =&gt; (Time.now), :smtp_response =&gt; (((...</span><span id='full_message80' style='display:none'>Unprotected mass assignment near line 65: SentEmail.new(:sent_at =&gt; (Time.now), :smtp_response =&gt; (((local smtp).sendmail((local tmail).encoded, <span class="user_input">Configurable.get_config_value(&quot;send_mail_settings&quot;, &quot;from_address&quot;)</span>, (local tmail).to[0]) or (local smtp).sendmail((local tmail).encoded, <span class="user_input">Configurable.get_config_value(&quot;send_mail_settings&quot;, &quot;from_address&quot;)</span>, (local tmail).to[0]).message.to_s)), :from =&gt; ((local tmail).from.to_a.join(&quot;, &quot;)), :to =&gt; ((local tmail).to.to_a.join(&quot;, &quot;)), :cc =&gt; ((local tmail).cc.to_a.join(&quot;, &quot;)), :bcc =&gt; ((local tmail).bcc.to_a.join(&quot;, &quot;)), :subject =&gt; ((local tmail).subject), :body =&gt; ((local tmail).body))</span><table id='context80' class='context' style='display:none'><caption>app/models/sms_message.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>60</pre>
          </td>
          <td class='context'>
            <pre class='context'>          success_regex = Mailprep.smtpsend_success_regex#/250 2\.5\.0 Ok/</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>          #raise &quot;regex = #{success_regex.to_s}; r = #{r}, r.scan(success_regex) = #{Configurable.array_to_string(r.scan(success_regex))}&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>          if r.to_s.scan(success_regex).size &gt; 0</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>            sent_email = SentEmail.new({</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :sent_at =&gt; Time.now,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :smtp_response =&gt; r,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :from =&gt; tmail.from.to_a.join(', '),</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :to =&gt; tmail.to.to_a.join(', '),</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :cc =&gt; tmail.cc.to_a.join(', '  ),</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>              :bcc =&gt; tmail.bcc.to_a.join(', '),</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>SmsMessage</td>
    <td>to_event</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context81');toggle('message81');toggle('full_message81')" ><span id='message81' style='display:block' >Unprotected mass assignment near line 152: Event.new(:purpose =&gt; (SmsTemplate.find(sms_template_id).p...</span><span id='full_message81' style='display:none'>Unprotected mass assignment near line 152: Event.new(:purpose =&gt; (SmsTemplate.find(sms_template_id).purpose), :outcome =&gt; (SmsTemplate.find(sms_template_id).outcomes), :lead_id =&gt; (lead_id), :user_id =&gt; (user_id), :quote_id =&gt; (quote_id), :initiator =&gt; (user.firstname), :mode =&gt; &quot;sms&quot;, :quote_included =&gt; (<span class="user_input">SmsTemplate.find(sms_template_id).quote_included</span>), :initiator_id =&gt; (logged_in_user_id), :sent_sms_id =&gt; (id), :notes =&gt; ((&quot;message sent: &quot; + message)))</span><table id='context81' class='context' style='display:none'><caption>app/models/sms_message.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>147</pre>
          </td>
          <td class='context'>
            <pre class='context'>        :lead_id =&gt; lead_id,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :user_id =&gt; user_id,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>149</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :quote_id =&gt; quote_id,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :initiator =&gt; user.firstname,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>151</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :mode =&gt; 'sms',</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :quote_included =&gt; template.quote_included,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>153</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :initiator_id =&gt; logged_in_user_id,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :sent_sms_id =&gt; id,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>155</pre>
            </td>
            <td class='context'>
              <pre class='context'>        :notes =&gt; 'message sent: '+message</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>156</pre>
            </td>
            <td class='context'>
              <pre class='context'>      }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>157</pre>
            </td>
            <td class='context'>
              <pre class='context'>    )</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>SmsTemplate</td>
    <td>move_up</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context144');toggle('message144');toggle('full_message144')" ><span id='message144' style='display:block' >Unprotected mass assignment near line 60: self.update_attributes(:order =&gt; (SmsTemplate.find(:all).so...</span><span id='full_message144' style='display:none'>Unprotected mass assignment near line 60: self.update_attributes(:order =&gt; (<span class="user_input">SmsTemplate.find(:all).sort_by</span> do  (local e).order  end[(<span class="user_input">SmsTemplate.find(:all).sort_by</span> do  (local e).order  end.index(self) - 1)].order))</span><table id='context144' class='context' style='display:none'><caption>app/models/sms_template.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>55</pre>
          </td>
          <td class='context'>
            <pre class='context'>      my_index = all_ets.index(self)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>      other_et = all_ets[my_index - 1]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>      my_new_order = other_et.order</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>      other_et.update_attributes(:order =&gt; 1000000)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>      self.update_attributes(:order =&gt; my_new_order)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      other_et.update_attributes(:order =&gt; my_old_order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def move_down</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>SmsTemplate</td>
    <td>move_down</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context145');toggle('message145');toggle('full_message145')" ><span id='message145' style='display:block' >Unprotected mass assignment near line 78: self.update_attributes(:order =&gt; (SmsTemplate.find(:all).so...</span><span id='full_message145' style='display:none'>Unprotected mass assignment near line 78: self.update_attributes(:order =&gt; (<span class="user_input">SmsTemplate.find(:all).sort_by</span> do  (local e).order  end.reverse[(<span class="user_input">SmsTemplate.find(:all).sort_by</span> do  (local e).order  end.reverse.index(self) - 1)].order))</span><table id='context145' class='context' style='display:none'><caption>app/models/sms_template.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>73</pre>
          </td>
          <td class='context'>
            <pre class='context'>      my_index = all_ets.index(self)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>      other_et = all_ets[my_index - 1]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>      my_new_order = other_et.order</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>      other_et.update_attributes(:order =&gt; 1000000)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>      self.update_attributes(:order =&gt; my_new_order)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>      other_et.update_attributes(:order =&gt; my_old_order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>  ##</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>SmtpSetting</td>
    <td>move_up</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context146');toggle('message146');toggle('full_message146')" ><span id='message146' style='display:block' >Unprotected mass assignment near line 63: self.update_attributes(:order =&gt; (SmtpSetting.find(:all).so...</span><span id='full_message146' style='display:none'>Unprotected mass assignment near line 63: self.update_attributes(:order =&gt; (<span class="user_input">SmtpSetting.find(:all).sort_by</span> do  (local e).order  end[(<span class="user_input">SmtpSetting.find(:all).sort_by</span> do  (local e).order  end.index(self) - 1)].order))</span><table id='context146' class='context' style='display:none'><caption>app/models/smtp_setting.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>58</pre>
          </td>
          <td class='context'>
            <pre class='context'>    my_index = all_ets.index(self)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et = all_ets[my_index - 1]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>    my_new_order = other_et.order</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; 1000000)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.update_attributes(:order =&gt; my_new_order)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; my_old_order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def move_down</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>SmtpSetting</td>
    <td>move_down</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context147');toggle('message147');toggle('full_message147')" ><span id='message147' style='display:block' >Unprotected mass assignment near line 81: self.update_attributes(:order =&gt; (SmtpSetting.find(:all).so...</span><span id='full_message147' style='display:none'>Unprotected mass assignment near line 81: self.update_attributes(:order =&gt; (<span class="user_input">SmtpSetting.find(:all).sort_by</span> do  (local e).order  end.reverse[(<span class="user_input">SmtpSetting.find(:all).sort_by</span> do  (local e).order  end.reverse.index(self) - 1)].order))</span><table id='context147' class='context' style='display:none'><caption>app/models/smtp_setting.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>76</pre>
          </td>
          <td class='context'>
            <pre class='context'>    my_index = all_ets.index(self)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et = all_ets[my_index - 1]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>    my_new_order = other_et.order</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; 1000000)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.update_attributes(:order =&gt; my_new_order)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>    other_et.update_attributes(:order =&gt; my_old_order)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>UndigestibleEmail</td>
    <td>UndigestibleEmail.create_from_email</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context82');toggle('message82');toggle('full_message82')" >Unprotected mass assignment near line 126: UndigestibleEmail.new((local email).fullemail)<table id='context82' class='context' style='display:none'><caption>app/models/undigestible_email.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>121</pre>
          </td>
          <td class='context'>
            <pre class='context'>    puts &quot;=============================&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>    puts &quot;created #{countera} undigestible_emails, #{n} for each microformat attempted&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def self.create_from_email(email)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>    UndigestibleEmail.new(email.fullemail)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def initialize(emailstring)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @new_record = true</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @attributes = {}</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>UndigestibleEmail</td>
    <td>UndigestibleEmail.create_from_textfile</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context83');toggle('message83');toggle('full_message83')" >Unprotected mass assignment near line 220: self.new((&quot;&quot; + File.open((local pathstring), &quot;r&quot;).gets))<table id='context83' class='context' style='display:none'><caption>app/models/undigestible_email.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>215</pre>
          </td>
          <td class='context'>
            <pre class='context'>    fullemail = ''</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>216</pre>
            </td>
            <td class='context'>
              <pre class='context'>    while line = infile.gets</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>217</pre>
            </td>
            <td class='context'>
              <pre class='context'>      fullemail += line</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>218</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>220</pre>
            </td>
            <td class='context'>
              <pre class='context'>    email = self.new(fullemail)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>222</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>224</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def autoset_microformat</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>225</pre>
            </td>
            <td class='context'>
              <pre class='context'>    result = false</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>UsersController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context59');toggle('message59');toggle('full_message59')" ><span id='message59' style='display:block' >Unprotected mass assignment near line 89: User.new(:login =&gt; (params[:login]), :firstname =&gt; (params[...</span><span id='full_message59' style='display:none'>Unprotected mass assignment near line 89: User.new(:login =&gt; (params[:login]), :firstname =&gt; (params[:firstname]), :lastname =&gt; (params[:lastname]), :fullname =&gt; (params[:fullname]), :signature =&gt; (<span class="user_input">params[:signature]</span>))</span><table id='context59' class='context' style='display:none'><caption>app/controllers/users_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>84</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /users</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # POST /users.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def create</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @user = User.new({:login =&gt; params[:login], :firstname =&gt; params[:firstname], :lastname =&gt; params[:lastname], :fullname =&gt; params[:fullname], :signature =&gt; params[:signature]})</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @user.set_password(params[:password])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @user.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'User was successfully created.'</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>ZipCode</td>
    <td>ZipCode.load_zip_codes_from_csv_file</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context84');toggle('message84');toggle('full_message84')" ><span id='message84' style='display:block' >Unprotected mass assignment near line 130: ZipCode.new(self.clean_up_county(self.clean_up_state(self....</span><span id='full_message84' style='display:none'>Unprotected mass assignment near line 130: ZipCode.new(self.clean_up_county(self.clean_up_state(self.clean_up_city(self.clean_up_latitude(self.clean_up_longitude(self.clean_up_zip((local hash), (true or false)), (true or false)), (true or false)), (true or false)), (true or false)), (true or false)))</span><table id='context84' class='context' style='display:none'><caption>app/models/zip_code.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>126</pre>
          </td>
          <td class='context'>
            <pre class='context'>    counter = 0</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>    for hash in clean_zip_hashes</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>      zipcode = ZipCode.new(hash)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>      zipcode.save</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>      counter += 1</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>UsersController</td>
    <td>create</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context212');toggle('message212');toggle('full_message212')" ><span id='message212' style='display:block' >Possible unprotected redirect near line 95: redirect_to((&quot;/users/show/&quot; + User.new(:login =&gt; (params[...</span><span id='full_message212' style='display:none'>Possible unprotected redirect near line 95: redirect_to((&quot;/users/show/&quot; + <span class="user_input">User.new(:login =&gt; (params[:login]), :firstname =&gt; (params[:firstname]), :lastname =&gt; (params[:lastname]), :fullname =&gt; (params[:fullname]), :signature =&gt; (params[:signature]))</span>.id.to_s))</span><table id='context212' class='context' style='display:none'><caption>app/controllers/users_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>90</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @user.set_password(params[:password])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @user.save</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'User was successfully created.'</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to '/users/show/'+@user.id.to_s }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :created, :location =&gt; user_url(@user) }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;new&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { render :xml =&gt; @user.errors.to_xml }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>UsersController</td>
    <td>update</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/redirect/">Redirect</a></td>
    <td><div class='warning_message' onClick="toggle('context213');toggle('message213');toggle('full_message213')" ><span id='message213' style='display:block' >Possible unprotected redirect near line 112: redirect_to((&quot;/users/show/&quot; + <span class="user_input">User.find(params[:id])</span>.id....</span><span id='full_message213' style='display:none'>Possible unprotected redirect near line 112: redirect_to((&quot;/users/show/&quot; + <span class="user_input">User.find(params[:id])</span>.id.to_s))</span><table id='context213' class='context' style='display:none'><caption>app/controllers/users_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>107</pre>
          </td>
          <td class='context'>
            <pre class='context'>    @user = User.find(params[:id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if @user.update_attributes(params[:user]) and @user.update_attributes({'signature' =&gt; params[:signature]})</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash[:notice] = 'User was successfully updated.'</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { redirect_to '/users/show/'+@user.id.to_s }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { head :ok }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.html { render :action =&gt; &quot;edit&quot; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>        format.xml  { render :xml =&gt; @user.errors.to_xml }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>117</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>DnConfirmationLettersController</td>
    <td>received</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context219');toggle('message219');toggle('full_message219')" ><span id='message219' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 110: DnConfi...</span><span id='full_message219' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 110: DnConfirmationLetter.find(:all, :limit =&gt; 5000, :order =&gt; &quot;id DESC&quot;)</span><table id='context219' class='context' style='display:none'><caption>app/controllers/dn_confirmation_letters_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>106</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def received</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @dn_emails = []</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails = DnConfirmationLetter.find(:all, :limit =&gt; 5000, :order =&gt; 'id DESC')</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails = emails.select{|e| /keep|received|turned into|could not turn into lead|delete/.match(e.status)}</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails.each_with_index do |ue, idx|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>      break if @dn_emails.size &gt; 500</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @dn_emails.push(ue)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>DnEmailsController</td>
    <td>received</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context221');toggle('message221');toggle('full_message221')" ><span id='message221' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 100: DnEmail...</span><span id='full_message221' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 100: DnEmail.find(:all, :limit =&gt; 5000, :order =&gt; &quot;id DESC&quot;)</span><table id='context221' class='context' style='display:none'><caption>app/controllers/dn_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>96</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def received</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @dn_emails = []</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails = DnEmail.find(:all, :limit =&gt; 5000, :order =&gt; 'id DESC')</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails = emails.select{|e| /keep|received|turned into|could not turn into lead|delete/.match(e.status)}</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails.each_with_index do |ue, idx|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>      break if @dn_emails.size &gt; 500</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @dn_emails.push(ue)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>Signature</td>
    <td>test_undigestibles</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context235');toggle('message235');toggle('full_message235')" ><span id='message235' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 20: DnEmail....</span><span id='full_message235' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 20: DnEmail.find(:all, :limit =&gt; 5000, :order =&gt; &quot;id DESC&quot;)</span><table id='context235' class='context' style='display:none'><caption>app/models/signature.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>15</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def test_undigestibles</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = []</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails = DnEmail.find(:all, :limit =&gt; 5000, :order =&gt; 'id DESC')</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails = emails.select{|e| /keep|received|turned into|could not turn into lead|delete/.match(e.status)}</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>    emails.each_with_index do |ue, idx|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>      break if idx &gt; 500</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output.push [match_by_fingerprints(ue.fullemail), ue]</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  
  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>UndigestibleEmailsController</td>
    <td>index</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context226');toggle('message226');toggle('full_message226')" ><span id='message226' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 40: Undigest...</span><span id='full_message226' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 40: UndigestibleEmail.find(:all, :limit =&gt; 50, :offset =&gt; 0, :order =&gt; &quot;created_on DESC&quot;)</span><table id='context226' class='context' style='display:none'><caption>app/controllers/undigestible_emails_controller.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>35</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /undigestible_emails</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # GET /undigestible_emails.xml</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def index</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @undigestible_emails = UndigestibleEmail.find(:all, :limit =&gt; 50, :offset =&gt; 0, :order =&gt; 'created_on DESC')</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @instructions = 'You should start here.  If you see undigestible emails that belong to a certain microformat, select them and define them as the target set.  Later you\'ll be testing your new signatures and extractors against this test set.  It is assumed that all emails in the test set ARE OF A PARTICULAR LEAD FORMAT, called a &quot;microformat&quot;.  Once you have your target set selected, select the lead company that you think is the source of these emails, by using the menu above.'</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>    respond_to do |format|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.html # index.rhtml</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>      format.xml  { render :xml =&gt; @undigestible_emails.to_xml }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</table></div></td>
  </tr>
  

</table><p>Controller Warnings</p>
<table>
  <tr>
    <th>Confidence</th>
    <th>Controller</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ApplicationController</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross-site_request_forgery/">Cross-Site Request Forgery</a></td>
    <td>'protect_from_forgery' should be called in ApplicationController</td>
  </tr>

</table><p>Model Warnings</p>
<table>
  <tr>
    <th>Confidence</th>
    <th>Model</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>AttachedFile, AutoEmailMapping, Condition, Configurable, ConfirmationLetterTemplate, CreditCard, CustomService, DnConfirmationLetter, DnEmail, DnTask, DrivingTime, Email, EmailAttachment, EmailTemplate, Event, EventInterface, ExpectedCost, ExtraStop, Extractor, ExtractorElement, FixedpriceJob, FreeJobId, HotCondition, HourlyRate, ImportJob, Importer, Inventory, InventoryExtractor, InventoryItem, InventoryLineItem, Job, JobCustomService, JobDescription, JobExtraStop, JobProject, JobReference, Lead, LeadCompany, ListCount, ListCountType, ListType, Mailprep, Microformat, MiscJob, MyLogger, Note, PointToPoint, Postprocessor, Preprocessor, PseudoZipCode, Quote, QuoteTemplateSelector, Quoter, Remailer, Remindinator, Report, Room, SentEmail, ServiceLocation, Signature, SmsMessage, SmsTemplate, SmtpSetting, TaskManagementRule, TaskTemplate, Tester, UndigestibleEmail, User, Visit, ZipCode</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/attribute_restriction/">Attribute Restriction</a></td>
    <td>Mass assignment is not restricted using attr_accessible</td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>ServiceLocation</td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/format_validation/">Format Validation</a></td>
    <td><div class='warning_message' onClick="toggle('context236');toggle('message236');toggle('full_message236')" >Insufficient validation for 'state' using /^[A-Z]{2}$/. Use \A and \z as anchors near line 12<table id='context236' class='context' style='display:none'><caption>app/models/service_location.rb</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>  validates_presence_of :name, :street_address, :city, :state, :zip, :phone, :email_from_address, :display_phone</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of :email_from_address, :with =&gt; VUtility.regex_for('email_address')</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of :phone, :with =&gt; VUtility.regex_for('phone_number_extracts')</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of :state, :with =&gt; /^[A-Z]{2}$/</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  before_validation{|sl|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if sl.new_record?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>      other_service_locations = ServiceLocation.find(:all)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

</table><p>View Warnings</p>
<table>
  <tr>
    <th>Confidence</th>
    <th>Template</th>
    <th>Warning Type</th>
    <th>Message</th>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        conditions/test (ConditionsController#test)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context237');toggle('message237');toggle('full_message237')" >Unescaped model attribute near line 6: Condition.find(params[:condition_id]).to_phrase<table id='context237' class='context' style='display:none'><caption>app/views/conditions/test.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;center&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;font color=&quot;blue&quot;&gt;this view is for testing to see whether the conditions are functioning correctly - i.e. whethey they correctly report true or false for each lead&lt;/font&gt;&lt;br&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>condition being tested:</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h2&gt;&lt;%= @condition.to_phrase %&gt;&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;errors&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;&lt;!-- id=&quot;errors&quot; --&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        confirmation_letter_templates/show (ConfirmationLetterTemplatesController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context243');toggle('message243');toggle('full_message243')" >Unescaped model attribute near line 39: ConfirmationLetterTemplate.find(params[:id]).function<table id='context243' class='context' style='display:none'><caption>app/views/confirmation_letter_templates/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>34</pre>
          </td>
          <td class='context'>
            <pre class='context'>  &lt;%=h @email_template.description %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;b&gt;Function:&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= @email_template.function %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;b&gt;Include Estimate Tables:&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% if @email_template.include_est == 1 %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        email_templates/show (EmailTemplatesController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context256');toggle('message256');toggle('full_message256')" >Unescaped model attribute near line 39: EmailTemplate.find(params[:id]).function<table id='context256' class='context' style='display:none'><caption>app/views/email_templates/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>34</pre>
          </td>
          <td class='context'>
            <pre class='context'>  &lt;%=h @email_template.description %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;b&gt;Function:&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= @email_template.function %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;b&gt;Include Estimate Tables:&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% if @email_template.include_est == 1 %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        emails/show_email (EmailsController#show_email)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context257');toggle('message257');toggle('full_message257')" >Unescaped model attribute near line 2: Email.find(params[:id]).to<table id='context257' class='context' style='display:none'><caption>app/views/emails/show_email.rhtml</caption>        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;To:&lt;/td&gt;&lt;td&gt;&lt;%= @email.to %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;From:&lt;/td&gt;&lt;td&gt;&lt;%= @email.from %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.date.to_s %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.subject %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        emails/show_email (EmailsController#show_email)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context258');toggle('message258');toggle('full_message258')" >Unescaped model attribute near line 3: Email.find(params[:id]).from<table id='context258' class='context' style='display:none'><caption>app/views/emails/show_email.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;To:&lt;/td&gt;&lt;td&gt;&lt;%= @email.to %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;From:&lt;/td&gt;&lt;td&gt;&lt;%= @email.from %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.date.to_s %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.subject %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        emails/show_email (EmailsController#show_email)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context259');toggle('message259');toggle('full_message259')" >Unescaped model attribute near line 4: Email.find(params[:id]).date.to_s<table id='context259' class='context' style='display:none'><caption>app/views/emails/show_email.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;To:&lt;/td&gt;&lt;td&gt;&lt;%= @email.to %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;From:&lt;/td&gt;&lt;td&gt;&lt;%= @email.from %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.date.to_s %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.subject %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @email.body %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        emails/show_email (EmailsController#show_email)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context260');toggle('message260');toggle('full_message260')" >Unescaped model attribute near line 5: Email.find(params[:id]).subject<table id='context260' class='context' style='display:none'><caption>app/views/emails/show_email.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;To:&lt;/td&gt;&lt;td&gt;&lt;%= @email.to %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;From:&lt;/td&gt;&lt;td&gt;&lt;%= @email.from %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.date.to_s %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.subject %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @email.body %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        emails/show_email (EmailsController#show_email)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context261');toggle('message261');toggle('full_message261')" >Unescaped model attribute near line 9: Email.find(params[:id]).body<table id='context261' class='context' style='display:none'><caption>app/views/emails/show_email.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.date.to_s %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.subject %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @email.body %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        emails/show_fullemail (EmailsController#show_fullemail)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context262');toggle('message262');toggle('full_message262')" >Unescaped model attribute near line 3: Email.find(params[:id]).to<table id='context262' class='context' style='display:none'><caption>app/views/emails/show_fullemail.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;To:&lt;/td&gt;&lt;td&gt;&lt;%= @email.to %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;From:&lt;/td&gt;&lt;td&gt;&lt;%= @email.from %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.date.to_s %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.subject %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        emails/show_fullemail (EmailsController#show_fullemail)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context263');toggle('message263');toggle('full_message263')" >Unescaped model attribute near line 4: Email.find(params[:id]).from<table id='context263' class='context' style='display:none'><caption>app/views/emails/show_fullemail.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;To:&lt;/td&gt;&lt;td&gt;&lt;%= @email.to %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;From:&lt;/td&gt;&lt;td&gt;&lt;%= @email.from %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.date.to_s %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.subject %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= text_area_tag 'fluff', @email.body, :size =&gt; '80x100' %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        emails/show_fullemail (EmailsController#show_fullemail)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context264');toggle('message264');toggle('full_message264')" >Unescaped model attribute near line 5: Email.find(params[:id]).date.to_s<table id='context264' class='context' style='display:none'><caption>app/views/emails/show_fullemail.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;To:&lt;/td&gt;&lt;td&gt;&lt;%= @email.to %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;From:&lt;/td&gt;&lt;td&gt;&lt;%= @email.from %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.date.to_s %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.subject %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= text_area_tag 'fluff', @email.body, :size =&gt; '80x100' %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        emails/show_fullemail (EmailsController#show_fullemail)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context265');toggle('message265');toggle('full_message265')" >Unescaped model attribute near line 6: Email.find(params[:id]).subject<table id='context265' class='context' style='display:none'><caption>app/views/emails/show_fullemail.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;To:&lt;/td&gt;&lt;td&gt;&lt;%= @email.to %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;From:&lt;/td&gt;&lt;td&gt;&lt;%= @email.from %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.date.to_s %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;Subject:&lt;/td&gt;&lt;td&gt;&lt;%= @email.subject %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= text_area_tag 'fluff', @email.body, :size =&gt; '80x100' %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        extractors/show (ExtractorsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context267');toggle('message267');toggle('full_message267')" >Unescaped model attribute near line 1: Extractor.find(params[:id]).id<table id='context267' class='context' style='display:none'><caption>app/views/extractors/show.rhtml</caption>        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;&lt;font color=&quot;green&quot;&gt;Extractor number &lt;%= @extractor.id %&gt;&lt;/font&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;b&gt;Microformat:&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%=h @extractor.microformat_id %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        hourly_rates/batch_edit (HourlyRatesController#batch_edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context268');toggle('message268');toggle('full_message268')" ><span id='message268' style='display:block' >Unescaped model attribute near line 2: ServiceLocation.find((params[:date_range][:service_location_id...</span><span id='full_message268' style='display:none'>Unescaped model attribute near line 2: ServiceLocation.find((params[:date_range][:service_location_id] or ServiceLocation.find(:first).id)).name</span><table id='context268' class='context' style='display:none'><caption>app/views/hourly_rates/batch_edit.rhtml</caption>        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div id=&quot;errors&quot;&gt;&lt;/div&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h1&gt;Hourly Rates for &lt;font color=&quot;blue&quot;&gt;&lt;%= @service_location.name %&gt;&lt;/font&gt;&lt;/h1&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>(Click a date to see its &lt;%= link_to_function 'demand', &quot;Element.show('demand_explanation')&quot;, :class =&gt; 'view' %&gt;)&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;demand_explanation&quot; style=&quot;display: none;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div class=&quot;instructions&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>		The &quot;demand&quot; for a date is the total number of leads which are active and want to move on that date.  Demand will always appear &lt;span class=&quot;demand&quot;&gt;like this&lt;/span&gt; throughout VDiamond.</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        hourly_rates/csv_dump (HourlyRatesController#csv_dump)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context271');toggle('message271');toggle('full_message271')" ><span id='message271' style='display:block' >Unescaped model attribute near line 2: ServiceLocation.find((params[:date_range][:service_location_id...</span><span id='full_message271' style='display:none'>Unescaped model attribute near line 2: ServiceLocation.find((params[:date_range][:service_location_id] or :first)).name</span><table id='context271' class='context' style='display:none'><caption>app/views/hourly_rates/csv_dump.rhtml</caption>        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;Hourly Rates for Service Location: &lt;%= @service_location.name %&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;span class=&quot;instructions2&quot;&gt;copy/paste this:&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;text-align: left; width: 700px; border: solid thin black; margin: 50px auto;&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        inventory_extractors/edit (InventoryExtractorsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context273');toggle('message273');toggle('full_message273')" ><span id='message273' style='display:block' >Unescaped model attribute near line 4: InventoryExtractor.find(params[:id]).extractor.microformat.nam...</span><span id='full_message273' style='display:none'>Unescaped model attribute near line 4: InventoryExtractor.find(params[:id]).extractor.microformat.name</span><table id='context273' class='context' style='display:none'><caption>app/views/inventory_extractors/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= render_partial 'workflow/microformat_editing_menu' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h1&gt;Editing Inventory Extractor for &lt;span class=&quot;microformat&quot; style=&quot;font-size: 25px;&quot;&gt;&lt;%= @inventory_extractor.extractor.microformat.name %&gt;&lt;/span&gt;&lt;/h1&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;text-align: left; width: 600px; margin: auto;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :inventory_extractor %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        job_references/select_for_lead (JobReferencesController#select_for_lead)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context282');toggle('message282');toggle('full_message282')" >Unescaped model attribute near line 3: Lead.find(params[:lead_id]).fullname<table id='context282' class='context' style='display:none'><caption>app/views/job_references/select_for_lead.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;Recommended references for &lt;%= @lead.fullname %&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for jr in @job_references %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= button_to &quot;Assign this one&quot;, :controller =&gt; 'job_references', :action =&gt; 'assign_for_lead', :lead_id =&gt; @lead.id, :job_reference_id =&gt; jr.id, :index =&gt; @index %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        jobs/list (JobsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context288');toggle('message288');toggle('full_message288')" ><span id='message288' style='display:block' >Unescaped model attribute near line 123: JobExtraStop.find(:all, :conditions =&gt; ([&quot;lead_id = ? and jo...</span><span id='full_message288' style='display:none'>Unescaped model attribute near line 123: JobExtraStop.find(:all, :conditions =&gt; ([&quot;lead_id = ? and job_id = ? and job_type = ?&quot;, (local job).lead_id, (local job).id, &quot;Miscellaneous Jobs&quot;]))[0].blank?</span><table id='context288' class='context' style='display:none'><caption>app/views/jobs/list.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>118</pre>
          </td>
          <td class='context'>
            <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= job_description %&gt;&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>119</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;width: 125px&quot;&gt;&lt;%= job.estimated_arrival_1.blank? &amp;&amp; job.estimated_arrival_2.blank? &amp;&amp; job.arrival_am_pm_1.blank? &amp;&amp; job.arrival_am_pm_2.blank? ? 'N/A' : &quot;#{job.estimated_arrival_1} #{job.arrival_am_pm_1} - #{job.estimated_arrival_2} #{job.arrival_am_pm_2}&quot; %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>120</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= job.q_labor_max || 'N/A' %&gt; hrs&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>121</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= &quot;#{(job.q_crew_size || 'N/A')} M / #{job.q_trucks || 'N/A'} T&quot; %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= cost || &quot;N/A&quot; %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= job_extra_stops[0].blank? ? &quot;N/A&quot; : &quot;#{job_extra_stops[0].city}, #{job_extra_stops[0].state}&quot; %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>124</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= job_extra_stops[1].blank? ? &quot;N/A&quot; : &quot;#{job_extra_stops[1].city}, #{job_extra_stops[1].state}&quot; %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= job.cu_feet || 0 %&gt; CF&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/tbody&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        jobs/list (JobsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context289');toggle('message289');toggle('full_message289')" ><span id='message289' style='display:block' >Unescaped model attribute near line 124: JobExtraStop.find(:all, :conditions =&gt; ([&quot;lead_id = ? and jo...</span><span id='full_message289' style='display:none'>Unescaped model attribute near line 124: JobExtraStop.find(:all, :conditions =&gt; ([&quot;lead_id = ? and job_id = ? and job_type = ?&quot;, (local job).lead_id, (local job).id, &quot;Miscellaneous Jobs&quot;]))[1].blank?</span><table id='context289' class='context' style='display:none'><caption>app/views/jobs/list.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>119</pre>
          </td>
          <td class='context'>
            <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;width: 125px&quot;&gt;&lt;%= job.estimated_arrival_1.blank? &amp;&amp; job.estimated_arrival_2.blank? &amp;&amp; job.arrival_am_pm_1.blank? &amp;&amp; job.arrival_am_pm_2.blank? ? 'N/A' : &quot;#{job.estimated_arrival_1} #{job.arrival_am_pm_1} - #{job.estimated_arrival_2} #{job.arrival_am_pm_2}&quot; %&gt;&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>120</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= job.q_labor_max || 'N/A' %&gt; hrs&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>121</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= &quot;#{(job.q_crew_size || 'N/A')} M / #{job.q_trucks || 'N/A'} T&quot; %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= cost || &quot;N/A&quot; %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= job_extra_stops[0].blank? ? &quot;N/A&quot; : &quot;#{job_extra_stops[0].city}, #{job_extra_stops[0].state}&quot; %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>124</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= job_extra_stops[1].blank? ? &quot;N/A&quot; : &quot;#{job_extra_stops[1].city}, #{job_extra_stops[1].state}&quot; %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td style=&quot;&lt;%= style_td %&gt;&quot;&gt;&lt;%= job.cu_feet || 0 %&gt; CF&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/tbody&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        lead_companies/edit (LeadCompaniesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context290');toggle('message290');toggle('full_message290')" >Unescaped model attribute near line 5: LeadCompany.find(params[:id]).name<table id='context290' class='context' style='display:none'><caption>app/views/lead_companies/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div style=&quot;background-color: lightblue; border: solid thin blue; width: 400px; margin: 20px auto;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h2&gt;Editing &lt;%= @lead_company.name %&gt;&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :lead_company %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:lead_company, :url =&gt; lead_company_path(@lead_company), :html =&gt; { :method =&gt; :put }) do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;p&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/_searchform
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context447');toggle('message447');toggle('full_message447')" >Unescaped model attribute near line 117: Event.new(:outcome =&gt; &quot;move booked&quot;).to_minispan<table id='context447' class='context' style='display:none'><caption>app/views/leads/_searchform.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>112</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;/div&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td width=&quot;5px&quot;&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>117</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;input type=&quot;checkbox&quot; name=&quot;include_booked&quot; /&gt;&lt;%= Event.new(:outcome =&gt; 'move booked').to_minispan %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;input type=&quot;checkbox&quot; name=&quot;include_inactives&quot; /&gt;&lt;%= Event.new(:outcome =&gt; 'inactive/not interested').to_minispan %&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>119</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= submit_tag 'search for leads' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>121</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/_searchform
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context448');toggle('message448');toggle('full_message448')" ><span id='message448' style='display:block' >Unescaped model attribute near line 118: Event.new(:outcome =&gt; &quot;inactive/not interested&quot;).to_minispan...</span><span id='full_message448' style='display:none'>Unescaped model attribute near line 118: Event.new(:outcome =&gt; &quot;inactive/not interested&quot;).to_minispan</span><table id='context448' class='context' style='display:none'><caption>app/views/leads/_searchform.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>115</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;td width=&quot;5px&quot;&gt;&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>117</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;input type=&quot;checkbox&quot; name=&quot;include_booked&quot; /&gt;&lt;%= Event.new(:outcome =&gt; 'move booked').to_minispan %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;input type=&quot;checkbox&quot; name=&quot;include_inactives&quot; /&gt;&lt;%= Event.new(:outcome =&gt; 'inactive/not interested').to_minispan %&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>119</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= submit_tag 'search for leads' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>121</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/edit (LeadsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context293');toggle('message293');toggle('full_message293')" >Unescaped model attribute near line 3: Lead.find(params[:id]).fullname<table id='context293' class='context' style='display:none'><caption>app/views/leads/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= link_to 'Cancel Changes and Return to Lead', &quot;/leads/#{@lead.id};show&quot; %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h1&gt;Editing Lead for &lt;%= @lead.fullname %&gt;&lt;/h1&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h2&gt;You landed here because some of your input was invalid&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;lead&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/index (LeadsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context296');toggle('message296');toggle('full_message296')" ><span id='message296' style='display:block' >Unescaped model attribute near line 5: ListType.find((params[:list_type_id] or ListType::NEEDS_FIRST_...</span><span id='full_message296' style='display:none'>Unescaped model attribute near line 5: ListType.find((params[:list_type_id] or ListType::NEEDS_FIRST_CALL)).nil?.!</span><table id='context296' class='context' style='display:none'><caption>app/views/leads/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table width=&quot;100%&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;h1 style=&quot;margin: 5px 0 0;&quot;&gt;&lt;font color=&quot;blue&quot;&gt;&lt;%= @list.name if !@list.nil? %&gt;&lt;%= @service_location.nil? ? '' : ': '+ @service_location.name + ' only' %&gt;&lt;/font&gt;&lt;/h1&gt;		</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;bottom&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#&quot; onclick=&quot;Element.toggle('color_key')&quot; class=&quot;view&quot;&gt;key&lt;/a&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context317');toggle('message317');toggle('full_message317')" >Unescaped model attribute near line 4: Lead.find(params[:id]).smart_email_date_string<table id='context317' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;center&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;received on:&lt;/td&gt;&lt;td&gt;&lt;%= @lead.smart_email_date_string %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;sending company:&lt;/td&gt;&lt;td&gt;&lt;%= @lead.smart_lead_company_name %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context318');toggle('message318');toggle('full_message318')" >Unescaped model attribute near line 5: Lead.find(params[:id]).smart_lead_company_name<table id='context318' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;center&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;received on:&lt;/td&gt;&lt;td&gt;&lt;%= @lead.smart_email_date_string %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;sending company:&lt;/td&gt;&lt;td&gt;&lt;%= @lead.smart_lead_company_name %&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table width=&quot;400px&quot; border=&quot;1&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context319');toggle('message319');toggle('full_message319')" >Unescaped model attribute near line 12: Lead.find(params[:id]).fullname<table id='context319' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>8</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table width=&quot;400px&quot; border=&quot;1&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td width=&quot;100px&quot;&gt;name:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.fullname %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;orig_city:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.orig_city %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context320');toggle('message320');toggle('full_message320')" >Unescaped model attribute near line 16: Lead.find(params[:id]).orig_city<table id='context320' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>11</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td width=&quot;100px&quot;&gt;name:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.fullname %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;orig_city:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.orig_city %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;orig_state:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.orig_state %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context321');toggle('message321');toggle('full_message321')" >Unescaped model attribute near line 20: Lead.find(params[:id]).orig_state<table id='context321' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>15</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;orig_city:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.orig_city %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;orig_state:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.orig_state %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;orig_zip:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.orig_zip %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context322');toggle('message322');toggle('full_message322')" >Unescaped model attribute near line 24: Lead.find(params[:id]).orig_zip<table id='context322' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>19</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;orig_state:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.orig_state %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;orig_zip:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.orig_zip %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;dest_city:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.dest_city %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context323');toggle('message323');toggle('full_message323')" >Unescaped model attribute near line 28: Lead.find(params[:id]).dest_city<table id='context323' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>23</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;orig_zip:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.orig_zip %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;dest_city:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.dest_city %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;dest_state:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.dest_state %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context324');toggle('message324');toggle('full_message324')" >Unescaped model attribute near line 32: Lead.find(params[:id]).dest_state<table id='context324' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>27</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;dest_city:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.dest_city %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;dest_state:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.dest_state %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;dest_zip:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.dest_zip %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context325');toggle('message325');toggle('full_message325')" >Unescaped model attribute near line 36: Lead.find(params[:id]).dest_zip<table id='context325' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>31</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;dest_state:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.dest_state %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;dest_zip:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.dest_zip %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;move_date:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.move_date %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context326');toggle('message326');toggle('full_message326')" >Unescaped model attribute near line 40: Lead.find(params[:id]).move_date<table id='context326' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>35</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;dest_zip:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.dest_zip %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;move_date:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.move_date %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/td&gt;&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table width=&quot;400px&quot; border=&quot;1&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td width=&quot;100px&quot;&gt;move_weight_lbs:&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context327');toggle('message327');toggle('full_message327')" >Unescaped model attribute near line 46: Lead.find(params[:id]).move_weight_lbs<table id='context327' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>41</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/td&gt;&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table width=&quot;400px&quot; border=&quot;1&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td width=&quot;100px&quot;&gt;move_weight_lbs:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.move_weight_lbs %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;move_weight_text:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.move_weight_text %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context328');toggle('message328');toggle('full_message328')" >Unescaped model attribute near line 50: Lead.find(params[:id]).move_weight_text<table id='context328' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>45</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td width=&quot;100px&quot;&gt;move_weight_lbs:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.move_weight_lbs %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;move_weight_text:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.move_weight_text %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;comments1:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.comments1 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context329');toggle('message329');toggle('full_message329')" >Unescaped model attribute near line 54: Lead.find(params[:id]).comments1<table id='context329' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>49</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;move_weight_text:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.move_weight_text %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;comments1:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.comments1 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;coomments2:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.comments2 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context330');toggle('message330');toggle('full_message330')" >Unescaped model attribute near line 58: Lead.find(params[:id]).comments2<table id='context330' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>53</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;comments1:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.comments1 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;coomments2:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.comments2 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;contact_preference:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.contact_preference %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context331');toggle('message331');toggle('full_message331')" >Unescaped model attribute near line 62: Lead.find(params[:id]).contact_preference<table id='context331' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;coomments2:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.comments2 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;contact_preference:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.contact_preference %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;contact_email:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.contact_email %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context332');toggle('message332');toggle('full_message332')" >Unescaped model attribute near line 66: Lead.find(params[:id]).contact_email<table id='context332' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>61</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;contact_preference:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.contact_preference %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;contact_email:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.contact_email %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;phone numbers:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.phone1 %&gt;, &lt;%= @lead.phone2 %&gt;, &lt;%= @lead.phone3 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context333');toggle('message333');toggle('full_message333')" >Unescaped model attribute near line 70: Lead.find(params[:id]).phone1<table id='context333' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>65</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;contact_email:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.contact_email %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;phone numbers:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.phone1 %&gt;, &lt;%= @lead.phone2 %&gt;, &lt;%= @lead.phone3 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;move_weight_text:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.move_weight_text %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show_lead_info (LeadsController#show_lead_info)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context334');toggle('message334');toggle('full_message334')" >Unescaped model attribute near line 74: Lead.find(params[:id]).move_weight_text<table id='context334' class='context' style='display:none'><caption>app/views/leads/show_lead_info.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>69</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;&lt;td&gt;phone numbers:&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.phone1 %&gt;, &lt;%= @lead.phone2 %&gt;, &lt;%= @lead.phone3 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;move_weight_text:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @lead.move_weight_text %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        microformats/edit (MicroformatsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context335');toggle('message335');toggle('full_message335')" >Unescaped model attribute near line 13: Microformat.find(params[:id]).lead_company.name<table id='context335' class='context' style='display:none'><caption>app/views/microformats/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>8</pre>
          </td>
          <td class='context'>
            <pre class='context'>    &lt;%= f.text_field :name %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;b&gt;Lead company&lt;/b&gt;&lt;br /&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= @microformat.lead_company.name %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= f.hidden_field :lead_company_id %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= submit_tag &quot;Update&quot; %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        microformats/show (MicroformatsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context336');toggle('message336');toggle('full_message336')" >Unescaped model attribute near line 1: Microformat.find(params[:id]).id<table id='context336' class='context' style='display:none'><caption>app/views/microformats/show.rhtml</caption>        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;&lt;font color=&quot;red&quot;&gt;Microformat number &lt;%= @microformat.id %&gt;&lt;/font&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;b&gt;Name:&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%=h @microformat.name %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/p&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        microformats/show (MicroformatsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context337');toggle('message337');toggle('full_message337')" >Unescaped model attribute near line 17: Microformat.find(params[:id]).signature<table id='context337' class='context' style='display:none'><caption>app/views/microformats/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>12</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;td&gt;&lt;%= link_to @microformat.lead_company.name, lead_company_path(@microformat.lead_company_id) if @microformat.lead_company %&gt;&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;signature:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @microformat.signature.id if @microformat.signature %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if @microformat.signature %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= link_to 'go to signature', signature_path(@microformat.signature.id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= link_to 'create signature - use microformat id '+@microformat.id.to_s, new_signature_path %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        microformats/show (MicroformatsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context338');toggle('message338');toggle('full_message338')" >Unescaped model attribute near line 29: Microformat.find(params[:id]).extractor<table id='context338' class='context' style='display:none'><caption>app/views/microformats/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>24</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;extractor:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;%= @microformat.extractor.id if @microformat.extractor %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if @microformat.extractor %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= link_to 'go to extractor', extractor_path(@microformat.extractor.id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= link_to 'create extractor - use microformat id '+@microformat.id.to_s, new_extractor_path %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        reports/lead_company_report (ReportsController#lead_company_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context369');toggle('message369');toggle('full_message369')" >Unescaped model attribute near line 1: LeadCompany.find(params[:lead_company_id]).name<table id='context369' class='context' style='display:none'><caption>app/views/reports/lead_company_report.rhtml</caption>        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h2&gt;Company Report for &lt;%= @company.name %&gt;&lt;/h2&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>period:  &lt;%= pretty_date(@time1) %&gt; through &lt;%= pretty_date(@time2) %&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        reports/lead_company_report (ReportsController#lead_company_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context371');toggle('message371');toggle('full_message371')" ><span id='message371' style='display:block' >Unescaped model attribute near line 8: Lead.find(:all, :conditions =&gt; ([&quot;lead_company_name = ? and cr...</span><span id='full_message371' style='display:none'>Unescaped model attribute near line 8: Lead.find(:all, :conditions =&gt; ([&quot;lead_company_name = ? and created_on &gt;= ? and created_on &lt; ?&quot;, LeadCompany.find(params[:lead_company_id]).name, ((Time.parse(params[&quot;start_date&quot;]).year.to_s + (Time.parse(params[&quot;start_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).month.to_s))) + (Time.parse(params[&quot;start_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).mday.to_s))), ((Time.parse(params[&quot;end_date&quot;]).year.to_s + (Time.parse(params[&quot;end_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).month.to_s))) + (Time.parse(params[&quot;end_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).mday.to_s)))])).size.to_s</span><table id='context371' class='context' style='display:none'><caption>app/views/reports/lead_company_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;br&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table border=&quot;1px&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;&lt;b&gt;total leads:&lt;/b&gt;&lt;/td&gt;&lt;td width=&quot;40px&quot;&gt;&lt;b&gt;&lt;center&gt;&lt;%= @leads.size.to_s %&gt;&lt;/center&gt;&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;local:&lt;/td&gt;&lt;td&gt;&lt;center&gt;&lt;%= @counts['local'] %&gt;&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;long-distance:&lt;/td&gt;&lt;td&gt;&lt;center&gt;&lt;%= @counts['long distance'] %&gt;&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;duplicates: &lt;/td&gt;&lt;td&gt;&lt;center&gt;&lt;%= @counts['duplicates'] %&gt;&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;unacceptable info: &lt;/td&gt;&lt;td&gt;&lt;center&gt;&lt;%= @counts['unacceptable info'] %&gt;&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td&gt;incomplete info: &lt;/td&gt;&lt;td&gt;&lt;center&gt;&lt;%= @counts['incomplete info'] %&gt;&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        reports/users_statuses (ReportsController#users_statuses)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context376');toggle('message376');toggle('full_message376')" >Unescaped model attribute near line 13: User.find((local d)[&quot;id&quot;]).id.to_s<table id='context376' class='context' style='display:none'><caption>app/views/reports/users_statuses.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;% for d in @data %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% user = User.find(d['id']) %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div id=&quot;user_&lt;%= user.id.to_s %&gt;_minimized&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= link_to_function &quot;(+/-)&quot;, &quot;Element.hide('user_#{user.id}_minimized'); Element.show('user_#{user.id}'); return false;&quot;, :class =&gt; 'view' %&gt; &lt;%= user.firstname %&gt;:</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div id=&quot;user_&lt;%= user.id.to_s %&gt;&quot; style=&quot;display: none;&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        reports/users_statuses (ReportsController#users_statuses)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context377');toggle('message377');toggle('full_message377')" >Unescaped model attribute near line 14: User.find((local d)[&quot;id&quot;]).firstname<table id='context377' class='context' style='display:none'><caption>app/views/reports/users_statuses.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;% for d in @data %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% user = User.find(d['id']) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div id=&quot;user_&lt;%= user.id.to_s %&gt;_minimized&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= link_to_function &quot;(+/-)&quot;, &quot;Element.hide('user_#{user.id}_minimized'); Element.show('user_#{user.id}'); return false;&quot;, :class =&gt; 'view' %&gt; &lt;%= user.firstname %&gt;:</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div id=&quot;user_&lt;%= user.id.to_s %&gt;&quot; style=&quot;display: none;&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        reports/users_statuses (ReportsController#users_statuses)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context378');toggle('message378');toggle('full_message378')" >Unescaped model attribute near line 17: User.find((local d)[&quot;id&quot;]).id.to_s<table id='context378' class='context' style='display:none'><caption>app/views/reports/users_statuses.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>13</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;div id=&quot;user_&lt;%= user.id.to_s %&gt;_minimized&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= link_to_function &quot;(+/-)&quot;, &quot;Element.hide('user_#{user.id}_minimized'); Element.show('user_#{user.id}'); return false;&quot;, :class =&gt; 'view' %&gt; &lt;%= user.firstname %&gt;:</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div id=&quot;user_&lt;%= user.id.to_s %&gt;&quot; style=&quot;display: none;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table width=&quot;300px&quot; class=&quot;flat&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        reports/users_statuses (ReportsController#users_statuses)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context379');toggle('message379');toggle('full_message379')" >Unescaped model attribute near line 25: User.find((local d)[&quot;id&quot;]).firstname<table id='context379' class='context' style='display:none'><caption>app/views/reports/users_statuses.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>22</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;table width=&quot;300px&quot; class=&quot;flat&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td colspan=&quot;2&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;h2&gt;&lt;%= link_to_function &quot;(+/-)&quot;, &quot;Element.hide('user_#{user.id}'); Element.show('user_#{user.id}_minimized'); return false;&quot;, :class =&gt; 'view' %&gt; &lt;%= user.firstname %&gt;:&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;	</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% for s in @statuses %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td align=&quot;right&quot;&gt;&lt;font color=&quot;&lt;%= Lead.status_color_codes[s] %&gt;&quot;&gt;&lt;b&gt;&lt;%= s %&gt;&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        rooms/index (RoomsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context382');toggle('message382');toggle('full_message382')" >Unescaped model attribute near line 3: Room.find(:all).size<table id='context382' class='context' style='display:none'><caption>app/views/rooms/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= link_to 'go to Inventory Items', inventory_items_path, :class =&gt; 'navigation' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h1&gt;&lt;%= @rooms.size %&gt; Rooms&lt;/h1&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;span class=&quot;label&quot;&gt;Yes, this interface is ugly, but it works&lt;/span&gt;&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'New room', new_room_path %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr width=&quot;300px&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for room in @rooms.sort_by{|x| x.name} %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        service_locations/edit (ServiceLocationsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context384');toggle('message384');toggle('full_message384')" >Unescaped model attribute near line 1: ServiceLocation.find(params[:id]).name<table id='context384' class='context' style='display:none'><caption>app/views/service_locations/edit.rhtml</caption>        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;Editing Service Location: &lt;%= @service_location.name %&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :service_location %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'service_locations/service_locations_javascript', 'taken_states' =&gt; @taken_states %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        sms_templates/edit (SmsTemplatesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context387');toggle('message387');toggle('full_message387')" >Unescaped model attribute near line 1: SmsTemplate.find(params[:id]).name<table id='context387' class='context' style='display:none'><caption>app/views/sms_templates/edit.rhtml</caption>        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;Editing SMS Template: &lt;%= @sms_template.name %&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :sms_template %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;td colspan=&quot;2&quot; align=&quot;right&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;view&quot; onclick=&quot;Element.toggle('allowable_tokens'); return false;&quot;&gt;allowable tokens:&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        task_management_rules/edit (TaskManagementRulesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context388');toggle('message388');toggle('full_message388')" >Unescaped model attribute near line 6: TaskManagementRule.find(params[:id]).name<table id='context388' class='context' style='display:none'><caption>app/views/task_management_rules/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>Go to:</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>Go to: </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'all rules', task_management_rules_path, :class =&gt; 'navigation' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'this rule\'s task templates', task_templates_url(:task_management_rule_id =&gt; @task_management_rule.id), :class =&gt; 'navigation' %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h1&gt;Task Management&lt;/h1&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h2&gt;edit rule &lt;%= @task_management_rule.name %&gt;&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'Back', task_management_rules_path %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :task_management_rule %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;task_management_rule&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        task_templates/index (TaskTemplatesController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context390');toggle('message390');toggle('full_message390')" ><span id='message390' style='display:block' >Unescaped model attribute near line 5: TaskManagementRule.find(params[:task_management_rule_id]).name...</span><span id='full_message390' style='display:none'>Unescaped model attribute near line 5: TaskManagementRule.find(params[:task_management_rule_id]).name</span><table id='context390' class='context' style='display:none'><caption>app/views/task_templates/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>Go to: </pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'all rules', task_management_rules_path, :class =&gt; 'navigation' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'this rule: &lt;b&gt;'+@task_management_rule.name+'&lt;/b&gt;', edit_task_management_rule_url(@task_management_rule), :class =&gt; 'navigation' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h1&gt;Task Management&lt;/h1&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h2&gt;tasks to be created when &lt;b&gt;&lt;%= @task_management_rule.name %&gt;&lt;/b&gt; is activated&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;errors&quot;&gt;&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        tasks/_task_show_SendemailTask
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context470');toggle('message470');toggle('full_message470')" >Unescaped model attribute near line 40: User.find(task.dn_email.user).firstname<table id='context470' class='context' style='display:none'><caption>app/views/tasks/_task_show_SendemailTask.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>35</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Email Template&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= task.dn_email.email_template.nil? ? 'None' : task.dn_email.email_template.name %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;User&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= User.find(task.dn_email.user).firstname %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;span class=&quot;warning&quot;&gt;associated email is nil!  this is bad&lt;/span&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        tasks/_task_show_SmsTask
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context472');toggle('message472');toggle('full_message472')" >Unescaped model attribute near line 38: SmsTemplate.find(task.parameters[&quot;sms_template_id&quot;]).name<table id='context472' class='context' style='display:none'><caption>app/views/tasks/_task_show_SmsTask.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>33</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Quote&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= quote = Quote.find(task.parameters['quote_id']) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= pretty_datetime_short(quote.created_on)+' $'+quote.smart_price.to_i.to_s %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Sms Template&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= SmsTemplate.find(task.parameters['sms_template_id']).name %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;User&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= User.find(task.parameters['sms_from_user_id']).firstname %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        tasks/_task_show_SmsTask
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context473');toggle('message473');toggle('full_message473')" >Unescaped model attribute near line 41: User.find(task.parameters[&quot;sms_from_user_id&quot;]).firstname<table id='context473' class='context' style='display:none'><caption>app/views/tasks/_task_show_SmsTask.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>36</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Sms Template&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= SmsTemplate.find(task.parameters['sms_template_id']).name %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;User&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= User.find(task.parameters['sms_from_user_id']).firstname %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Notes&lt;/b&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        tasks/edit_sms (TasksController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context392');toggle('message392');toggle('full_message392')" >Unescaped model attribute near line 6: DnTask.find(params[:id]).to_phrase<table id='context392' class='context' style='display:none'><caption>app/views/tasks/edit_sms.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= link_to '&lt;-- back to ' + @task.lead_fullname, &quot;/leads/#{@task.lead_id};show&quot; %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h2 style=&quot;margin: 5px&quot;&gt;Sms for Task: &lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h3&gt;&lt;%= @task.to_phrase %&gt; &lt;font color=&quot;#777&quot;&gt;due&lt;/font&gt; &lt;%= pretty_datetime(@task.start_time) %&gt;&lt;/h3&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;width: 880px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for :task, @task, :url =&gt; &quot;/tasks/#{@task.id}/update?mode=update_sms&quot; do |f| %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        tasks/edit_sms (TasksController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context393');toggle('message393');toggle('full_message393')" >Unescaped model attribute near line 99: DnTask.find(params[:id]).parameters[&quot;sms_messagebody&quot;].size<table id='context393' class='context' style='display:none'><caption>app/views/tasks/edit_sms.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>94</pre>
          </td>
          <td class='context'>
            <pre class='context'>						}'%&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td align=&quot;right&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;div id=&quot;text_counter_number&quot;&gt;&lt;b&gt;&lt;font color=&quot;green&quot; size=&quot;3&quot; face=&quot;arial&quot;&gt;&lt;%= @task.parameters['sms_messagebody'].size %&gt;&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>					characters (129 allowable)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        tasks/index (TasksController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context398');toggle('message398');toggle('full_message398')" >Unescaped model attribute near line 21: User.find(session[:user].id).firstname<table id='context398' class='context' style='display:none'><caption>app/views/tasks/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>16</pre>
          </td>
          <td class='context'>
            <pre class='context'>						&lt;% if @task_flavor == 'all'%&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>							all</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>							&lt;%= DnTask.pretty_flavor(@task_flavor) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;%end%&gt;, </pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;font color=&quot;blue&quot;&gt;user: &lt;%= @assigned_to_user_name %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td valign=&quot;bottom&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;div class=&quot;task_show_incomplete&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        tasks/tasks_for_lead (TasksController#tasks_for_lead)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context401');toggle('message401');toggle('full_message401')" >Unescaped model attribute near line 3: Lead.find(params[:lead_id]).id.to_s<table id='context401' class='context' style='display:none'><caption>app/views/tasks/tasks_for_lead.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;Tasks for Lead Number &lt;%= @lead.id.to_s %&gt;: &lt;%= @lead.fullname %&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h2&gt;moving on &lt;%= pretty_date(@lead.move_date) %&gt;&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'tasks/task_list', </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'my_div_id' =&gt; 'lead_tasks_page_tasks_list',</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        undigestible_emails/show (UndigestibleEmailsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context406');toggle('message406');toggle('full_message406')" ><span id='message406' style='display:block' >Unescaped model attribute near line 10: UndigestibleEmail.find(params[:id]).showable_html.gsub(&quot;\r\n&quot;...</span><span id='full_message406' style='display:none'>Unescaped model attribute near line 10: UndigestibleEmail.find(params[:id]).showable_html.gsub(&quot;\r\n&quot;, &quot;&lt;br&gt;&quot;).gsub(&quot;\n&quot;, &quot;&lt;br&gt;&quot;)</span><table id='context406' class='context' style='display:none'><caption>app/views/undigestible_emails/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= render_partial 'undigestible_emails/undigestible_email', 'ue' =&gt; @undigestible_email, 'suppress_checkbox' =&gt; true, 'counter' =&gt; 1 %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr color=&quot;blue&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% @undigestible_email.predivs %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @undigestible_email.showable_html.gsub(&quot;\r\n&quot;, &quot;&lt;br&gt;&quot;).gsub(&quot;\n&quot;, &quot;&lt;br&gt;&quot;) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% @undigestible_email.postdivs %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        users/edit (UsersController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context407');toggle('message407');toggle('full_message407')" >Unescaped model attribute near line 8: User.find(params[:id]).login<table id='context407' class='context' style='display:none'><caption>app/views/users/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= error_messages_for :user %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:user, :url =&gt; '/users/update/'+@user.id.to_s, :html =&gt; { :method =&gt; :put }) do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;b&gt;Login&lt;/b&gt;&lt;br /&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= @user.login %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;b&gt;First Name&lt;/b&gt;&lt;br /&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= f.text_field :firstname %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        users/show (UsersController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context408');toggle('message408');toggle('full_message408')" >Unescaped model attribute near line 20: User.find(params[:id]).sms_signature<table id='context408' class='context' style='display:none'><caption>app/views/users/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>15</pre>
          </td>
          <td class='context'>
            <pre class='context'>  &lt;b&gt;Signature:&lt;/b&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= text_area_tag 'blah', @user.signature, :size =&gt; '36x10' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;br&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;b&gt;SMS Signature:&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= @user.sms_signature %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'Edit', edit_user_path(@user) %&gt; |</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'Back', users_path %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        workflow/_tasks_and_events
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context476');toggle('message476');toggle('full_message476')" ><span id='message476' style='display:block' >Unescaped model attribute near line 132: Note.find(:all, :conditions =&gt; ([&quot;job_id = ? and job_type = ...</span><span id='full_message476' style='display:none'>Unescaped model attribute near line 132: Note.find(:all, :conditions =&gt; ([&quot;job_id = ? and job_type = ?&quot;, (local job).id, (local job_type)])).size</span><table id='context476' class='context' style='display:none'><caption>app/views/workflow/_tasks_and_events.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>127</pre>
          </td>
          <td class='context'>
            <pre class='context'>                &lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  &lt;td colspan=&quot;2&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>                    &lt;%= &quot;&lt;b&gt;&lt;i&gt;#{job.status}&lt;/i&gt;&lt;/b&gt; | Move Coordinator: &lt;b&gt;#{job.move_coordinator}&lt;/b&gt; | &lt;i&gt;Created by #{job.created_by || 'N/A'} #{job.created_on.strftime(&quot;%m/%d/%y&quot;)}&lt;/i&gt;&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  &lt;td valign=&quot;top&quot; align=&quot;right&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>                    &lt;%= Note.find(:all, :conditions =&gt; [&quot;job_id = ? and job_type = ?&quot;, job.id, job_type]).size %&gt; notes</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;/tbody&gt;&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>137</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context409');toggle('message409');toggle('full_message409')" >Unescaped model attribute near line 7: User.find(params[:user_id]).login<table id='context409' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table width=&quot;100%&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;b&gt;(Dashboard for &lt;font size=&quot;3&quot;&gt;&lt;u&gt;&lt;% if @user.nil? %&gt;all users&lt;% else %&gt;&lt;%= @user.login %&gt;&lt;% end %&gt;&lt;/u&gt;&lt;/font&gt;)&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;b&gt;&lt;font color=&quot;red&quot; size=&quot;5&quot;&gt;&lt;%= @new_leads.size %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;red&quot;&gt;New&lt;/font&gt;, &lt;b&gt;&lt;font color=&quot;blue&quot; size=&quot;5&quot;&gt;&lt;%= @high_leads_total %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;blue&quot;&gt;High&lt;/font&gt;, &lt;b&gt;&lt;font color=&quot;grey&quot; size=&quot;5&quot;&gt;&lt;%= @low_leads_total %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;grey&quot;&gt;Low&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context416');toggle('message416');toggle('full_message416')" ><span id='message416' style='display:block' >Unescaped model attribute near line 56: Lead.find(:all, :conditions =&gt; (&quot;appears_on_dashboard_high_at...</span><span id='full_message416' style='display:none'>Unescaped model attribute near line 56: Lead.find(:all, :conditions =&gt; (&quot;appears_on_dashboard_high_at &lt; #{(Time.now + Configurable.get_config_value(&quot;workflow&quot;, &quot;dashboard_cutoff_hours_in_future&quot;).hours).to_i}&quot;)).size</span><table id='context416' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>51</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;% end %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'> &lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;width: 850px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;b&gt;&lt;font color=&quot;blue&quot; size=&quot;4&quot;&gt;&lt;%= @high_leads_total %&gt; Leads with High Priority Tasks&lt;/b&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to_function '(+/-)', &quot;Element.toggle('high_leads')&quot;, :class =&gt; 'view' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;high_leads&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'leads/lead_with_tasks_header'%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for lead in @high_leads.sort_by{|x| x.appears_on_dashboard_high_at}.reverse %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context419');toggle('message419');toggle('full_message419')" ><span id='message419' style='display:block' >Unescaped model attribute near line 101: Lead.find(:all, :conditions =&gt; (&quot;appears_on_dashboard_low_at...</span><span id='full_message419' style='display:none'>Unescaped model attribute near line 101: Lead.find(:all, :conditions =&gt; (&quot;appears_on_dashboard_low_at &lt; #{(Time.now + Configurable.get_config_value(&quot;workflow&quot;, &quot;dashboard_cutoff_hours_in_future&quot;).hours).to_i}&quot;)).size</span><table id='context419' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>96</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;br/&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;width: 850px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;b&gt;&lt;font color=&quot;#888&quot; size=&quot;4&quot;&gt;&lt;%= @low_leads_total %&gt; Leads with Low Priority Tasks&lt;/b&gt;&lt;/font&gt;&lt;%= link_to_function '(+/-)', &quot;Element.toggle('low_leads')&quot;, :class =&gt; 'view' %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;low_leads&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'leads/lead_with_tasks_header'%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for lead in @low_leads.sort_by{|x| x.appears_on_dashboard_low_at}.reverse %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        email_templates/send_test_email (EmailTemplatesController#send_test_email)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context255');toggle('message255');toggle('full_message255')" >Unescaped parameter value near line 3: params[:id].to_i.to_s<table id='context255' class='context' style='display:none'><caption>app/views/email_templates/send_test_email.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>send test email with template # &lt;%= @template_id.to_s %&gt;&lt;br&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'back to email templates index', email_templates_path %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        job_descriptions/update (JobDescriptionsController#update)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context278');toggle('message278');toggle('full_message278')" >Unescaped parameter value near line 1: params[:desc_fields]<table id='context278' class='context' style='display:none'><caption>app/views/job_descriptions/update.rhtml</caption>        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= @job_desc_up %&gt;</pre>
          </td>
        </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        jobs/list (JobsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context285');toggle('message285');toggle('full_message285')" >Unescaped parameter value near line 13: params[:date]<table id='context285' class='context' style='display:none'><caption>app/views/jobs/list.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>8</pre>
          </td>
          <td class='context'>
            <pre class='context'>    &lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;div class=&quot;task_show_incomplete&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;span style=&quot;margin: 20px;&quot;&gt;showing:&lt;/span&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;span style=&quot;margin: 20px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;font color=&quot;blue&quot;&gt;&lt;%= params[:date] || Time.now.strftime(&quot;%B %d, %Y&quot;) %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;%= params[:job_type] || 'All' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;font color=&quot;blue&quot;&gt;&lt;%= params[:job_status] %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        jobs/list (JobsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context286');toggle('message286');toggle('full_message286')" >Unescaped parameter value near line 14: params[:job_type]<table id='context286' class='context' style='display:none'><caption>app/views/jobs/list.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>      &lt;td valign=&quot;top&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;div class=&quot;task_show_incomplete&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;span style=&quot;margin: 20px;&quot;&gt;showing:&lt;/span&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;span style=&quot;margin: 20px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;font color=&quot;blue&quot;&gt;&lt;%= params[:date] || Time.now.strftime(&quot;%B %d, %Y&quot;) %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;%= params[:job_type] || 'All' %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;font color=&quot;blue&quot;&gt;&lt;%= params[:job_status] %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;td valign=&quot;bottom&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        jobs/list (JobsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context287');toggle('message287');toggle('full_message287')" >Unescaped parameter value near line 15: params[:job_status]<table id='context287' class='context' style='display:none'><caption>app/views/jobs/list.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>10</pre>
          </td>
          <td class='context'>
            <pre class='context'>        &lt;div class=&quot;task_show_incomplete&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;span style=&quot;margin: 20px;&quot;&gt;showing:&lt;/span&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;span style=&quot;margin: 20px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;font color=&quot;blue&quot;&gt;&lt;%= params[:date] || Time.now.strftime(&quot;%B %d, %Y&quot;) %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;%= params[:job_type] || 'All' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;font color=&quot;blue&quot;&gt;&lt;%= params[:job_status] %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;td valign=&quot;bottom&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;div class=&quot;task_show_incomplete&quot; style=&quot;height:36px;&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        layouts/foo
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context435');toggle('message435');toggle('full_message435')" >Unescaped parameter value near line 7: params[:controller]<table id='context435' class='context' style='display:none'><caption>app/views/layouts/foo.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;head&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=UTF-8&quot; /&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;title&gt;&lt;%= params[:controller] %&gt;: &lt;%= controller.action_name %&gt;&lt;/title&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= stylesheet_link_tag 'VD1-8.css' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= javascript_include_tag 'prototype'%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= javascript_include_tag :defaults %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= javascript_include_tag 'webforms2-p' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= javascript_include_tag 'dn_inventory'%&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        layouts/noheader
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context436');toggle('message436');toggle('full_message436')" >Unescaped parameter value near line 7: params[:controller]<table id='context436' class='context' style='display:none'><caption>app/views/layouts/noheader.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>       &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;head&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=UTF-8&quot; /&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;title&gt;&lt;%= params[:controller] %&gt;: &lt;%= controller.action_name %&gt;&lt;/title&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= stylesheet_link_tag 'VD1-1.css' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/head&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;body&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= javascript_include_tag 'prototype'%&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/search (LeadsController#search)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context297');toggle('message297');toggle('full_message297')" >Unescaped parameter value near line 2: params[:search_string]<table id='context297' class='context' style='display:none'><caption>app/views/leads/search.rhtml</caption>        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;h1&gt;&lt;font color=&quot;green&quot;&gt;Search Results: &quot;&lt;%= @search_string %&gt;&quot; (total: &lt;%= @leads.total_entries %&gt;)&lt;/font&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if @date_type != 'two_dates' and @targetfields == 'date'%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	Demand for &lt;%= @single_date %&gt;: &lt;span class=&quot;demand&quot;&gt;&lt;%= Lead.demand_for(Time.parse(@single_date)) %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/search (LeadsController#search)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context298');toggle('message298');toggle('full_message298')" >Unescaped parameter value near line 6: params[:single_date]<table id='context298' class='context' style='display:none'><caption>app/views/leads/search.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;h1&gt;&lt;font color=&quot;green&quot;&gt;Search Results: &quot;&lt;%= @search_string %&gt;&quot; (total: &lt;%= @leads.total_entries %&gt;)&lt;/font&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if @date_type != 'two_dates' and @targetfields == 'date'%&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	Demand for &lt;%= @single_date %&gt;: &lt;span class=&quot;demand&quot;&gt;&lt;%= Lead.demand_for(Time.parse(@single_date)) %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;!-- </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;right&gt;	</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= form_tag :action =&gt; 'search' %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context302');toggle('message302');toggle('full_message302')" >Unescaped parameter value near line 24: params[:update_error_message].to_s<table id='context302' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>20</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;% if @lead.duplicate %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;strong&gt;&lt;font color=&quot;red&quot;&gt;NOTE!  This is a DUPLICATE lead.  You should merge it, or deactivate it, or take other appropriate action.&lt;/font&gt;&lt;/strong&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;font color=&quot;red&quot;&gt;&lt;%= @update_error_message %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table width=&quot;100%&quot; id=&quot;lead_nav_links&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;td align=&quot;left&quot; width=&quot;33%&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='high-confidence'>High</span></td>
    <td>
      
        tasks/index (TasksController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting/">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context396');toggle('message396');toggle('full_message396')" >Unescaped parameter value near line 14: params[:listname]<table id='context396' class='context' style='display:none'><caption>app/views/tasks/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;div class=&quot;task_show_incomplete&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;span style=&quot;margin: 20px;&quot;&gt;showing:&lt;/span&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;span style=&quot;margin: 20px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;font color=&quot;blue&quot;&gt;&lt;%= @listname %&gt;&lt;/font&gt;, </pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>						type: </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;% if @task_flavor == 'all'%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>							all</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>							&lt;%= DnTask.pretty_flavor(@task_flavor) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        extractor_elements/_show_extractor_element
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context424');toggle('message424');toggle('full_message424')" >Unescaped model attribute near line 13: ExtractorElement.fieldnames[ee.fieldname]<table id='context424' class='context' style='display:none'><caption>app/views/extractor_elements/_show_extractor_element.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>8</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;td width=&quot;25px&quot; valign=&quot;top&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;font color=&quot;blue&quot; size=&quot;4&quot;&gt;&lt;%= ee.order %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td width=&quot;150px&quot; valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span class=&quot;label&quot;&gt;extracts&lt;/span&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;b&gt;&lt;%= ExtractorElement.fieldnames[ee.fieldname] %&gt;&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if ee.fieldname == 'inventory' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% unless ee.has_inventory_extractor %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;br/&gt;&lt;span class=&quot;warning&quot; style=&quot;font-size: 10px;&quot;&gt;Warning! You don't have an &lt;b&gt;Inventory Extractor&lt;/b&gt; set yet; this field will extract nothing.&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        extractor_elements/_show_extractor_element
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context425');toggle('message425');toggle('full_message425')" ><span id='message425' style='display:block' >Unescaped model attribute near line 22: ExtractorElement.regex_un_literal(ee.pre_pattern).gsub(&quot; &quot;, &quot;...</span><span id='full_message425' style='display:none'>Unescaped model attribute near line 22: ExtractorElement.regex_un_literal(ee.pre_pattern).gsub(&quot; &quot;, &quot;&amp;nbsp;&quot;)</span><table id='context425' class='context' style='display:none'><caption>app/views/extractor_elements/_show_extractor_element.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>17</pre>
          </td>
          <td class='context'>
            <pre class='context'>				&lt;% end %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td width=&quot;150px&quot; valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span class=&quot;label&quot;&gt;starts extracting after:&lt;/span&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span style=&quot;background-color: white; border: solid thin green;&quot;&gt;&lt;%= ExtractorElement.regex_un_literal(ee.pre_pattern).gsub(' ', '&amp;nbsp;') %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&amp;nbsp;&amp;nbsp;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if ExtractorElement.regex_un_literal(ee.pre_pattern) == ' ' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.pre_pattern).size %&gt; space)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% elsif ExtractorElement.regex_un_literal(ee.pre_pattern).gsub(' ', '') == '' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.pre_pattern).size %&gt; spaces)&lt;/font&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        extractor_elements/_show_extractor_element
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context426');toggle('message426');toggle('full_message426')" >Unescaped model attribute near line 25: ExtractorElement.regex_un_literal(ee.pre_pattern).size<table id='context426' class='context' style='display:none'><caption>app/views/extractor_elements/_show_extractor_element.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>20</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;td width=&quot;150px&quot; valign=&quot;top&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span class=&quot;label&quot;&gt;starts extracting after:&lt;/span&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span style=&quot;background-color: white; border: solid thin green;&quot;&gt;&lt;%= ExtractorElement.regex_un_literal(ee.pre_pattern).gsub(' ', '&amp;nbsp;') %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&amp;nbsp;&amp;nbsp;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if ExtractorElement.regex_un_literal(ee.pre_pattern) == ' ' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.pre_pattern).size %&gt; space)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% elsif ExtractorElement.regex_un_literal(ee.pre_pattern).gsub(' ', '') == '' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.pre_pattern).size %&gt; spaces)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td width=&quot;270px&quot; valign=&quot;top&quot;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        extractor_elements/_show_extractor_element
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context427');toggle('message427');toggle('full_message427')" >Unescaped model attribute near line 27: ExtractorElement.regex_un_literal(ee.pre_pattern).size<table id='context427' class='context' style='display:none'><caption>app/views/extractor_elements/_show_extractor_element.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>22</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;span style=&quot;background-color: white; border: solid thin green;&quot;&gt;&lt;%= ExtractorElement.regex_un_literal(ee.pre_pattern).gsub(' ', '&amp;nbsp;') %&gt;&lt;/span&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&amp;nbsp;&amp;nbsp;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if ExtractorElement.regex_un_literal(ee.pre_pattern) == ' ' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.pre_pattern).size %&gt; space)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% elsif ExtractorElement.regex_un_literal(ee.pre_pattern).gsub(' ', '') == '' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.pre_pattern).size %&gt; spaces)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td width=&quot;270px&quot; valign=&quot;top&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span class=&quot;label&quot;&gt;stops extracting before:&lt;/span&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if ee.post_pattern == ExtractorElement.til_end_of_line %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        extractor_elements/_show_extractor_element
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context428');toggle('message428');toggle('full_message428')" ><span id='message428' style='display:block' >Unescaped model attribute near line 37: ExtractorElement.regex_un_literal(ee.post_pattern).gsub(&quot; &quot;, ...</span><span id='full_message428' style='display:none'>Unescaped model attribute near line 37: ExtractorElement.regex_un_literal(ee.post_pattern).gsub(&quot; &quot;, &quot;&amp;nbsp;&quot;)</span><table id='context428' class='context' style='display:none'><caption>app/views/extractor_elements/_show_extractor_element.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;% if ee.post_pattern == ExtractorElement.til_end_of_line %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(end of line)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% elsif ee.post_pattern == ExtractorElement.til_double_linebreak %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(double linebreak)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;span style=&quot;background-color: white; border: solid thin green;&quot;&gt;&lt;%= ExtractorElement.regex_un_literal(ee.post_pattern).gsub(' ', '&amp;nbsp;') %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% end %&gt;&amp;nbsp;&amp;nbsp;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if ExtractorElement.regex_un_literal(ee.post_pattern) == ' ' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.post_pattern).size %&gt; space)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% elsif ExtractorElement.regex_un_literal(ee.post_pattern).gsub(' ', '') == '' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.post_pattern).size %&gt; spaces)&lt;/font&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        extractor_elements/_show_extractor_element
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context429');toggle('message429');toggle('full_message429')" >Unescaped model attribute near line 40: ExtractorElement.regex_un_literal(ee.post_pattern).size<table id='context429' class='context' style='display:none'><caption>app/views/extractor_elements/_show_extractor_element.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>35</pre>
          </td>
          <td class='context'>
            <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(double linebreak)&lt;/font&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;span style=&quot;background-color: white; border: solid thin green;&quot;&gt;&lt;%= ExtractorElement.regex_un_literal(ee.post_pattern).gsub(' ', '&amp;nbsp;') %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% end %&gt;&amp;nbsp;&amp;nbsp;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if ExtractorElement.regex_un_literal(ee.post_pattern) == ' ' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.post_pattern).size %&gt; space)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% elsif ExtractorElement.regex_un_literal(ee.post_pattern).gsub(' ', '') == '' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.post_pattern).size %&gt; spaces)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td width=&quot;30px&quot; valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        extractor_elements/_show_extractor_element
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context430');toggle('message430');toggle('full_message430')" >Unescaped model attribute near line 42: ExtractorElement.regex_un_literal(ee.post_pattern).size<table id='context430' class='context' style='display:none'><caption>app/views/extractor_elements/_show_extractor_element.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>37</pre>
          </td>
          <td class='context'>
            <pre class='context'>				&lt;span style=&quot;background-color: white; border: solid thin green;&quot;&gt;&lt;%= ExtractorElement.regex_un_literal(ee.post_pattern).gsub(' ', '&amp;nbsp;') %&gt;&lt;/span&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% end %&gt;&amp;nbsp;&amp;nbsp;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% if ExtractorElement.regex_un_literal(ee.post_pattern) == ' ' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.post_pattern).size %&gt; space)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% elsif ExtractorElement.regex_un_literal(ee.post_pattern).gsub(' ', '') == '' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;font color=&quot;green&quot;&gt;(&lt;%= ExtractorElement.regex_un_literal(ee.post_pattern).size %&gt; spaces)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td width=&quot;30px&quot; valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= link_to_remote 'edit', {:url =&gt; {:controller =&gt; 'extractor_elements', :action =&gt; 'edit', :id =&gt; ee.id, :container_div_id =&gt; container_div_id, :collection_div_id =&gt; collection_div_id, :extractor_id =&gt; ee.extractor_id}, :update =&gt; {:success =&gt; container_div_id, :failure =&gt; 'errors'}}, {:class =&gt; 'object_options'} %&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= link_to 'destroy', {:controller =&gt; 'extractor_elements', :action =&gt; 'destroy2', :id =&gt; ee.id, :extractor_id =&gt; ee.extractor_id}, :class =&gt; 'object_options', :confirm =&gt; &quot;are you sure?&quot; %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        jobs/list (JobsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context284');toggle('message284');toggle('full_message284')" >Unescaped model attribute near line 3: Configurable.hash_to_string(params)<table id='context284' class='context' style='display:none'><caption>app/views/jobs/list.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div style=&quot;display: none;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;pre&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>params = &lt;%= Configurable.hash_to_string(params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/pre&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;background-color: lightgrey; border: solid thin black; width: auto; margin: 10px; height:&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;table callpadding=&quot;0&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_interface
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context437');toggle('message437');toggle('full_message437')" >Unescaped model attribute near line 59: Lead.status_color_codes[&quot;Booked&quot;]<table id='context437' class='context' style='display:none'><caption>app/views/leads/_interface.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>54</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;%= form_tag :controller =&gt; 'events', :action =&gt; 'status_change'%&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= hidden_field_tag :lead_id, lead.id %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;span class=&quot;label&quot;&gt;new status:&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;select name=&quot;new_status&quot; id=&quot;new_status&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;nothing&quot;&gt;&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Booked&quot; id=&quot;new_status_Booked&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Booked'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Booked' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>						Booked</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_interface
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context438');toggle('message438');toggle('full_message438')" >Unescaped model attribute near line 62: Lead.status_color_codes[&quot;Inactive&quot;]<table id='context438' class='context' style='display:none'><caption>app/views/leads/_interface.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>				&lt;select name=&quot;new_status&quot; id=&quot;new_status&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;nothing&quot;&gt;&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Booked&quot; id=&quot;new_status_Booked&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Booked'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Booked' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>						Booked</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Postponed&quot; id=&quot;new_status_Postponed&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Postponed'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Postponed' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Postponed&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/select&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_interface
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context439');toggle('message439');toggle('full_message439')" >Unescaped model attribute near line 63: Lead.status_color_codes[&quot;Successfully Contacted&quot;]<table id='context439' class='context' style='display:none'><caption>app/views/leads/_interface.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>58</pre>
          </td>
          <td class='context'>
            <pre class='context'>					&lt;option value=&quot;nothing&quot;&gt;&lt;/option&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Booked&quot; id=&quot;new_status_Booked&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Booked'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Booked' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>						Booked</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Postponed&quot; id=&quot;new_status_Postponed&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Postponed'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Postponed' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Postponed&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/select&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= submit_tag 'save' %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_interface
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context440');toggle('message440');toggle('full_message440')" >Unescaped model attribute near line 64: Lead.status_color_codes[&quot;Re Attempting Contact&quot;]<table id='context440' class='context' style='display:none'><caption>app/views/leads/_interface.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>59</pre>
          </td>
          <td class='context'>
            <pre class='context'>					&lt;option value=&quot;Booked&quot; id=&quot;new_status_Booked&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Booked'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Booked' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>						Booked</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Postponed&quot; id=&quot;new_status_Postponed&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Postponed'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Postponed' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Postponed&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/select&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= submit_tag 'save' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= end_form_tag %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_interface
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context441');toggle('message441');toggle('full_message441')" >Unescaped model attribute near line 65: Lead.status_color_codes[&quot;Postponed&quot;]<table id='context441' class='context' style='display:none'><caption>app/views/leads/_interface.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>60</pre>
          </td>
          <td class='context'>
            <pre class='context'>						Booked</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Postponed&quot; id=&quot;new_status_Postponed&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Postponed'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Postponed' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Postponed&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/select&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= submit_tag 'save' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= end_form_tag %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_lead_attributes_form_vertical
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context442');toggle('message442');toggle('full_message442')" >Unescaped model attribute near line 38: Lead.status_color_codes[&quot;Booked&quot;]<table id='context442' class='context' style='display:none'><caption>app/views/leads/_lead_attributes_form_vertical.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>33</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;%= form_tag :controller =&gt; 'events', :action =&gt; 'status_change'%&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= hidden_field_tag :lead_id, lead.id %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>				New Status:</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;select name=&quot;new_status&quot; id=&quot;new_status&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;nothing&quot;&gt;&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Booked&quot; id=&quot;new_status_Booked&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Booked'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Booked' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>						Booked</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_lead_attributes_form_vertical
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context443');toggle('message443');toggle('full_message443')" >Unescaped model attribute near line 41: Lead.status_color_codes[&quot;Inactive&quot;]<table id='context443' class='context' style='display:none'><caption>app/views/leads/_lead_attributes_form_vertical.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>36</pre>
          </td>
          <td class='context'>
            <pre class='context'>				&lt;select name=&quot;new_status&quot; id=&quot;new_status&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;nothing&quot;&gt;&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Booked&quot; id=&quot;new_status_Booked&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Booked'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Booked' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>						Booked</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Postponed&quot; id=&quot;new_status_Postponed&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Postponed'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Postponed' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Postponed&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/select&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_lead_attributes_form_vertical
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context444');toggle('message444');toggle('full_message444')" >Unescaped model attribute near line 42: Lead.status_color_codes[&quot;Successfully Contacted&quot;]<table id='context444' class='context' style='display:none'><caption>app/views/leads/_lead_attributes_form_vertical.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>37</pre>
          </td>
          <td class='context'>
            <pre class='context'>					&lt;option value=&quot;nothing&quot;&gt;&lt;/option&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Booked&quot; id=&quot;new_status_Booked&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Booked'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Booked' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>						Booked</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Postponed&quot; id=&quot;new_status_Postponed&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Postponed'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Postponed' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Postponed&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/select&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= submit_tag 'save' %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_lead_attributes_form_vertical
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context445');toggle('message445');toggle('full_message445')" >Unescaped model attribute near line 43: Lead.status_color_codes[&quot;Re Attempting Contact&quot;]<table id='context445' class='context' style='display:none'><caption>app/views/leads/_lead_attributes_form_vertical.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>					&lt;option value=&quot;Booked&quot; id=&quot;new_status_Booked&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Booked'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Booked' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>						Booked</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Postponed&quot; id=&quot;new_status_Postponed&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Postponed'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Postponed' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Postponed&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/select&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= submit_tag 'save' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= end_form_tag %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        leads/_lead_attributes_form_vertical
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context446');toggle('message446');toggle('full_message446')" >Unescaped model attribute near line 44: Lead.status_color_codes[&quot;Postponed&quot;]<table id='context446' class='context' style='display:none'><caption>app/views/leads/_lead_attributes_form_vertical.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>						Booked</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Inactive&quot; id=&quot;new_status_Inactive&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Inactive'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Inactive' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Inactive&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Successfully Contacted&quot; id=&quot;new_status_Successfully Contacted&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Successfully Contacted'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Successfully Contacted' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Successfully&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Re Attempting Contact&quot; id=&quot;new_status_Attempting Contact&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Re Attempting Contact'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Re Attempting Contact' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Re Attempting&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;option value=&quot;Postponed&quot; id=&quot;new_status_Postponed&quot; style=&quot;color: &lt;%= Lead.status_color_codes['Postponed'] %&gt;; font-weight: bold;&quot; &lt;%= lead.status == 'Postponed' ? 'selected=&quot;selected&quot;' : '' %&gt;&gt;Postponed&lt;/option&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/select&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= submit_tag 'save' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= end_form_tag %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        quote_template_selectors/test (QuoteTemplateSelectorsController#test)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context339');toggle('message339');toggle('full_message339')" ><span id='message339' style='display:block' >Unescaped model attribute near line 71: QuoteTemplateSelector.first_matching_qts_for_lead((local lead...</span><span id='full_message339' style='display:none'>Unescaped model attribute near line 71: QuoteTemplateSelector.first_matching_qts_for_lead((local lead)).hierarchy_order</span><table id='context339' class='context' style='display:none'><caption>app/views/quote_template_selectors/test.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>66</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;center&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% qts = QuoteTemplateSelector.first_matching_qts_for_lead(lead) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% if qts %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>					(&lt;%= qts.hierarchy_order %&gt;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;%= qts.name %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>					none match</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/condition&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        quote_template_selectors/test (QuoteTemplateSelectorsController#test)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context340');toggle('message340');toggle('full_message340')" ><span id='message340' style='display:block' >Unescaped model attribute near line 72: QuoteTemplateSelector.first_matching_qts_for_lead((local lead...</span><span id='full_message340' style='display:none'>Unescaped model attribute near line 72: QuoteTemplateSelector.first_matching_qts_for_lead((local lead)).name</span><table id='context340' class='context' style='display:none'><caption>app/views/quote_template_selectors/test.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>67</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;center&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% qts = QuoteTemplateSelector.first_matching_qts_for_lead(lead) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% if qts %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>					(&lt;%= qts.hierarchy_order %&gt;)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;%= qts.name %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>					none match</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/condition&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        quote_template_selectors/test (QuoteTemplateSelectorsController#test)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context341');toggle('message341');toggle('full_message341')" ><span id='message341' style='display:block' >Unescaped model attribute near line 80: QuoteTemplateSelector.first_matching_qts_for_lead((local lead...</span><span id='full_message341' style='display:none'>Unescaped model attribute near line 80: QuoteTemplateSelector.first_matching_qts_for_lead((local lead)).email_template.name</span><table id='context341' class='context' style='display:none'><caption>app/views/quote_template_selectors/test.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>75</pre>
          </td>
          <td class='context'>
            <pre class='context'>				&lt;% end %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/condition&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% if qts %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;%= qts.email_template.name %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>					default initial quote template</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        quotes/_form
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context449');toggle('message449');toggle('full_message449')" >Unescaped model attribute near line 9: Lead.demand_for(quote.smart_work_date)<table id='context449' class='context' style='display:none'><caption>app/views/quotes/_form.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>			Work Date:&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= link_to_function &quot;match move date&quot;, &quot;set_quote_work_date_to_lead_move_date()&quot;, :class =&gt; 'navigation', :style =&gt; 'font-size: 9px; margin: 0;' %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;%= calendar_date_select_tag('quote[work_date]', pretty_date(quote.smart_work_date), :size =&gt; 16) %&gt;&amp;nbsp;&amp;nbsp;&lt;span class=&quot;demand&quot;&gt;&lt;%= Lead.demand_for(quote.smart_work_date) %&gt;&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        reports/users_events (ReportsController#users_events)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context373');toggle('message373');toggle('full_message373')" ><span id='message373' style='display:block' >Unescaped model attribute near line 14: User.user_events_hash_for((local user), Time.parse(params[&quot;st...</span><span id='full_message373' style='display:none'>Unescaped model attribute near line 14: User.user_events_hash_for((local user), Time.parse(params[&quot;start_date&quot;]), Time.parse(params[&quot;end_date&quot;]))[&quot;count&quot;].to_s</span><table id='context373' class='context' style='display:none'><caption>app/views/reports/users_events.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;% for user in @users %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% hash = User.user_events_hash_for(user, @time1, @time2) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div id=&quot;user_&lt;%= user.id.to_s %&gt;_minimized&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= link_to_function &quot;(+/-)&quot;, &quot;Element.hide('user_#{user.id}_minimized'); Element.show('user_#{user.id}'); return false;&quot;, :class =&gt; 'view' %&gt; &lt;%= user.firstname %&gt;: &lt;%= hash['count'].to_s %&gt; events</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div id=&quot;user_&lt;%= user.id.to_s %&gt;&quot; style=&quot;display: none;&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        reports/users_events (ReportsController#users_events)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context374');toggle('message374');toggle('full_message374')" ><span id='message374' style='display:block' >Unescaped model attribute near line 25: User.user_events_hash_for((local user), Time.parse(params[&quot;st...</span><span id='full_message374' style='display:none'>Unescaped model attribute near line 25: User.user_events_hash_for((local user), Time.parse(params[&quot;start_date&quot;]), Time.parse(params[&quot;end_date&quot;]))[&quot;count&quot;].to_s</span><table id='context374' class='context' style='display:none'><caption>app/views/reports/users_events.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>22</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;table width=&quot;800px&quot; border=&quot;1&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td colspan=&quot;3&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;h2&gt;&lt;%= link_to_function &quot;(+/-)&quot;, &quot;Element.hide('user_#{user.id}'); Element.show('user_#{user.id}_minimized'); return false;&quot;, :class =&gt; 'view' %&gt; &lt;%= user.firstname %&gt;:  &lt;%= hash['count'].to_s %&gt; events&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td width=&quot;200px&quot; valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        reports/users_statuses (ReportsController#users_statuses)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context380');toggle('message380');toggle('full_message380')" >Unescaped model attribute near line 30: Lead.status_color_codes[(local s)]<table id='context380' class='context' style='display:none'><caption>app/views/reports/users_statuses.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>25</pre>
          </td>
          <td class='context'>
            <pre class='context'>				&lt;h2&gt;&lt;%= link_to_function &quot;(+/-)&quot;, &quot;Element.hide('user_#{user.id}'); Element.show('user_#{user.id}_minimized'); return false;&quot;, :class =&gt; 'view' %&gt; &lt;%= user.firstname %&gt;:&lt;/h2&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;	</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% for s in @statuses %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td align=&quot;right&quot;&gt;&lt;font color=&quot;&lt;%= Lead.status_color_codes[s] %&gt;&quot;&gt;&lt;b&gt;&lt;%= s %&gt;&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td align=&quot;right&quot; width=&quot;40px&quot;&gt;&lt;font color=&quot;&lt;%= Lead.status_color_codes[s] %&gt;&quot;&gt;&lt;b&gt;&lt;%= d['datum'][s] %&gt;&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        reports/users_statuses (ReportsController#users_statuses)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context381');toggle('message381');toggle('full_message381')" >Unescaped model attribute near line 31: Lead.status_color_codes[(local s)]<table id='context381' class='context' style='display:none'><caption>app/views/reports/users_statuses.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>26</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;	</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% for s in @statuses %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td align=&quot;right&quot;&gt;&lt;font color=&quot;&lt;%= Lead.status_color_codes[s] %&gt;&quot;&gt;&lt;b&gt;&lt;%= s %&gt;&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td align=&quot;right&quot; width=&quot;40px&quot;&gt;&lt;font color=&quot;&lt;%= Lead.status_color_codes[s] %&gt;&quot;&gt;&lt;b&gt;&lt;%= d['datum'][s] %&gt;&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;br&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        signatures/_show_signature
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context455');toggle('message455');toggle('full_message455')" ><span id='message455' style='display:block' >Unescaped model attribute near line 10: ExtractorElement.regex_un_literal(signature.fingerprint1.to_s...</span><span id='full_message455' style='display:none'>Unescaped model attribute near line 10: ExtractorElement.regex_un_literal(signature.fingerprint1.to_s)</span><table id='context455' class='context' style='display:none'><caption>app/views/signatures/_show_signature.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>6</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;signature&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 1:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint1.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 2:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint2.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        signatures/_show_signature
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context456');toggle('message456');toggle('full_message456')" ><span id='message456' style='display:block' >Unescaped model attribute near line 13: ExtractorElement.regex_un_literal(signature.fingerprint2.to_s...</span><span id='full_message456' style='display:none'>Unescaped model attribute near line 13: ExtractorElement.regex_un_literal(signature.fingerprint2.to_s)</span><table id='context456' class='context' style='display:none'><caption>app/views/signatures/_show_signature.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>8</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 1:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint1.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 2:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint2.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint3.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 4:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        signatures/_show_signature
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context457');toggle('message457');toggle('full_message457')" ><span id='message457' style='display:block' >Unescaped model attribute near line 16: ExtractorElement.regex_un_literal(signature.fingerprint3.to_s...</span><span id='full_message457' style='display:none'>Unescaped model attribute near line 16: ExtractorElement.regex_un_literal(signature.fingerprint3.to_s)</span><table id='context457' class='context' style='display:none'><caption>app/views/signatures/_show_signature.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>11</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 2:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint2.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint3.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 4:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint4.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        signatures/_show_signature
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context458');toggle('message458');toggle('full_message458')" ><span id='message458' style='display:block' >Unescaped model attribute near line 19: ExtractorElement.regex_un_literal(signature.fingerprint4.to_s...</span><span id='full_message458' style='display:none'>Unescaped model attribute near line 19: ExtractorElement.regex_un_literal(signature.fingerprint4.to_s)</span><table id='context458' class='context' style='display:none'><caption>app/views/signatures/_show_signature.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>14</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint3.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 4:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= ExtractorElement.regex_un_literal(signature.fingerprint4.to_s) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        task_templates/_task_template
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context465');toggle('message465');toggle('full_message465')" >Unescaped model attribute near line 9: DnTask.pretty_flavor(tt.task_flavor)<table id='context465' class='context' style='display:none'><caption>app/views/task_templates/_task_template.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;!-- expects:  index --&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td width=&quot;100px&quot;&gt;&lt;span class=&quot;label&quot;&gt;type of task&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= DnTask.pretty_flavor(tt.task_flavor) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td align=&quot;right&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= link_to_remote 'edit', :url =&gt; {:controller =&gt; 'task_templates', :action =&gt; 'edit', :task_template_id =&gt; tt.id}, :update =&gt; {:success =&gt; &quot;task_template_#{tt.id}&quot;, :failure =&gt; 'errors'}, :class =&gt; 'view' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        tasks/index (TasksController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context395');toggle('message395');toggle('full_message395')" >Unescaped model attribute near line 4: Configurable.hash_to_string(params)<table id='context395' class='context' style='display:none'><caption>app/views/tasks/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div style=&quot;display: none;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;pre&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>params = &lt;%= Configurable.hash_to_string(params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/pre&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;background-color: lightgrey; border: solid thin black; width: 850px; margin: 10px; height:&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table callpadding=&quot;0&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        tasks/index (TasksController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context397');toggle('message397');toggle('full_message397')" ><span id='message397' style='display:block' >Unescaped model attribute near line 19: DnTask.pretty_flavor((((&quot;all&quot; or params[:task_flavor]) or nil...</span><span id='full_message397' style='display:none'>Unescaped model attribute near line 19: DnTask.pretty_flavor((((&quot;all&quot; or params[:task_flavor]) or nil) or params[:task_flavor].nil? ? (&quot;all&quot;) : (params[:task_flavor])))</span><table id='context397' class='context' style='display:none'><caption>app/views/tasks/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>14</pre>
          </td>
          <td class='context'>
            <pre class='context'>						&lt;font color=&quot;blue&quot;&gt;&lt;%= @listname %&gt;&lt;/font&gt;, </pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>						type: </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;% if @task_flavor == 'all'%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>							all</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>							&lt;%= DnTask.pretty_flavor(@task_flavor) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;%end%&gt;, </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>						&lt;font color=&quot;blue&quot;&gt;user: &lt;%= @assigned_to_user_name %&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context410');toggle('message410');toggle('full_message410')" >Unescaped model attribute near line 10: Lead.new_leads.size<table id='context410' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;b&gt;(Dashboard for &lt;font size=&quot;3&quot;&gt;&lt;u&gt;&lt;% if @user.nil? %&gt;all users&lt;% else %&gt;&lt;%= @user.login %&gt;&lt;% end %&gt;&lt;/u&gt;&lt;/font&gt;)&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;b&gt;&lt;font color=&quot;red&quot; size=&quot;5&quot;&gt;&lt;%= @new_leads.size %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;red&quot;&gt;New&lt;/font&gt;, &lt;b&gt;&lt;font color=&quot;blue&quot; size=&quot;5&quot;&gt;&lt;%= @high_leads_total %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;blue&quot;&gt;High&lt;/font&gt;, &lt;b&gt;&lt;font color=&quot;grey&quot; size=&quot;5&quot;&gt;&lt;%= @low_leads_total %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;grey&quot;&gt;Low&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;div style=&quot;width: 100%; align: right;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= form_tag &quot;/dashboard&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>					See Dashboard For: &lt;%= select_tag &quot;user_id&quot;, options_for_select(User.find(:all).map{|x| [x.firstname, x.id]}, session[:user].id) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context413');toggle('message413');toggle('full_message413')" >Unescaped model attribute near line 34: Lead.new_leads.size<table id='context413' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>29</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;/div&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% counter = 0 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;width: 850px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;b&gt;&lt;font color=&quot;red&quot; size=&quot;4&quot;&gt;&lt;%= @new_leads.size %&gt; New Leads&lt;/b&gt;&lt;/font&gt;&lt;%= link_to_function '(+/-)', &quot;Element.toggle('new_leads')&quot;, :class =&gt; 'view' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;new_leads&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'leads/lead_with_tasks_header'%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for lead in @new_leads.sort_by{|x| x.smart_email_date}.reverse %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% if @checkout_ids.include?(lead.id) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        conditions/test (ConditionsController#test)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context480');toggle('message480');toggle('full_message480')" ><span id='message480' style='display:block' >Unsafe model attribute in link_to href near line 13: link_to(&quot;back to this QTS&quot;, ((&quot;/quote_template_s...</span><span id='full_message480' style='display:none'>Unsafe model attribute in link_to href near line 13: link_to(&quot;back to this QTS&quot;, ((&quot;/quote_template_selectors/&quot; + <span class="user_input">Condition.find(params[:condition_id])</span>.conditionable_id.to_s) + &quot;;edit&quot;))</span><table id='context480' class='context' style='display:none'><caption>app/views/conditions/test.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div id=&quot;errors&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;&lt;!-- id=&quot;errors&quot; --&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'back to this QTS', '/quote_template_selectors/'+ @condition.conditionable_id.to_s+';edit' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table border=&quot;1&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;name&lt;/th&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='med-confidence'>Medium</span></td>
    <td>
      
        users/edit (UsersController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/link_to_href">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context481');toggle('message481');toggle('full_message481')" ><span id='message481' style='display:block' >Unsafe model attribute in link_to href near line 41: link_to(&quot;Show&quot;, (&quot;/users/show/&quot; + User.find(para...</span><span id='full_message481' style='display:none'>Unsafe model attribute in link_to href near line 41: link_to(&quot;Show&quot;, (&quot;/users/show/&quot; + <span class="user_input">User.find(params[:id])</span>.id.to_s))</span><table id='context481' class='context' style='display:none'><caption>app/views/users/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>36</pre>
          </td>
          <td class='context'>
            <pre class='context'>  &lt;p&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= submit_tag &quot;Update&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'Show', '/users/show/'+@user.id.to_s %&gt; |</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'Back', users_path %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        configurables/edit (ConfigurablesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context238');toggle('message238');toggle('full_message238')" ><span id='message238' style='display:block' >Unescaped model attribute near line 1: <span class="user_input">Configurable.find(params[:id]).name</span>.humanize.split(&quot; &quot;).map do...</span><span id='full_message238' style='display:none'>Unescaped model attribute near line 1: <span class="user_input">Configurable.find(params[:id]).name</span>.humanize.split(&quot; &quot;).map do  (local x).capitalize  end.join(&quot; &quot;)</span><table id='context238' class='context' style='display:none'><caption>app/views/configurables/edit.rhtml</caption>        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;center&gt;&lt;h1&gt;Configuration for &lt;font color=&quot;blue&quot;&gt;&lt;%= @configurable.name.humanize.split(' ').map{|x| x.capitalize}.join(' ') %&gt;&lt;/font&gt;&lt;/h1&gt;&lt;/center&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :configurable %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @partialpath %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        configurables/edit (ConfigurablesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context239');toggle('message239');toggle('full_message239')" ><span id='message239' style='display:block' >Unescaped model attribute near line 49: render_partial((&quot;form_for_#{Configurable.find(params[:id]).na...</span><span id='full_message239' style='display:none'>Unescaped model attribute near line 49: render_partial((&quot;form_for_#{<span class="user_input">Configurable.find(params[:id]).name</span>}&quot; or nil), &quot;f&quot; =&gt; (FormBuilder.new), &quot;configurable&quot; =&gt; (Configurable.find(params[:id])))</span><table id='context239' class='context' style='display:none'><caption>app/views/configurables/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>44</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;% form_for(:configurable, :url =&gt; configurable_path(@configurable), :html =&gt; {:method =&gt; :put}) do |f| %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;h3&gt;DESCRIPTION:&lt;/h3&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= text_area_tag 'configurable_description', @configurable.description, :rows =&gt; 4, :cols =&gt; 60 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;hr thickness=&quot;3px&quot; color=&quot;black&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial @form_partial, 'f' =&gt; f, 'configurable' =&gt; @configurable %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= submit_tag 'save' %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        confirmation_letter_templates/as_html (ConfirmationLetterTemplatesController#as_html)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context240');toggle('message240');toggle('full_message240')" ><span id='message240' style='display:block' >Unescaped model attribute near line 5: render_partial(&quot;confirmation_letter_templates/show_as_html&quot;, &quot;...</span><span id='full_message240' style='display:none'>Unescaped model attribute near line 5: render_partial(&quot;confirmation_letter_templates/show_as_html&quot;, &quot;email_template&quot; =&gt; (<span class="user_input">ConfirmationLetterTemplate.find(params[:id])</span>))</span><table id='context240' class='context' style='display:none'><caption>app/views/confirmation_letter_templates/as_html.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div style=&quot;width: 700px; border: solid thick black;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'confirmation_letter_templates/show_as_html', 'email_template' =&gt; @email_template %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        confirmation_letter_templates/edit (ConfirmationLetterTemplatesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context241');toggle('message241');toggle('full_message241')" ><span id='message241' style='display:block' >Unescaped model attribute near line 19: render_partial(&quot;confirmation_letter_templates/email_template_...</span><span id='full_message241' style='display:none'>Unescaped model attribute near line 19: render_partial(&quot;confirmation_letter_templates/email_template_form&quot;, &quot;email_template&quot; =&gt; (<span class="user_input">ConfirmationLetterTemplate.find(params[:id])</span>), &quot;form_url&quot; =&gt; (((&quot;/confirmation_letter_templates/&quot; + <span class="user_input">ConfirmationLetterTemplate.find(params[:id])</span>.id.to_s) + &quot;;update&quot;)), &quot;commit_string&quot; =&gt; &quot;Save&quot;)</span><table id='context241' class='context' style='display:none'><caption>app/views/confirmation_letter_templates/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>14</pre>
          </td>
          <td class='context'>
            <pre class='context'>  &lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;div class=&quot;config_edit&quot; style=&quot;width: 900px; float: none;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;%= render_partial 'confirmation_letter_templates/email_template_form',</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>          'email_template' =&gt; @email_template,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>          'form_url' =&gt; form_url,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>          'commit_string' =&gt; commit_string</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>      %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        confirmation_letter_templates/new (ConfirmationLetterTemplatesController#create)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context242');toggle('message242');toggle('full_message242')" ><span id='message242' style='display:block' >Unescaped model attribute near line 12: render_partial(&quot;confirmation_letter_templates/email_template_...</span><span id='full_message242' style='display:none'>Unescaped model attribute near line 12: render_partial(&quot;confirmation_letter_templates/email_template_form&quot;, &quot;email_template&quot; =&gt; (<span class="user_input">ConfirmationLetterTemplate.new(params[:email_template])</span>), &quot;form_url&quot; =&gt; (@form_url), &quot;commit_string&quot; =&gt; (@commit_string))</span><table id='context242' class='context' style='display:none'><caption>app/views/confirmation_letter_templates/new.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>7</pre>
          </td>
          <td class='context'>
            <pre class='context'>  &lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;div class=&quot;config_edit&quot; style=&quot;width: 800px; float: none;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;%= render_partial 'confirmation_letter_templates/email_template_form',</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>          'email_template' =&gt; @email_template,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>          'form_url' =&gt; @form_url,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>          'commit_string' =&gt; @commit_string</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>      %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        dn_confirmation_letters/manual_preview (DnConfirmationLettersController#manual_update)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context244');toggle('message244');toggle('full_message244')" ><span id='message244' style='display:block' >Unescaped model attribute near line 9: render_partial(&quot;preview&quot;, &quot;tmail&quot; =&gt; (DnConfirmationLetter.fin...</span><span id='full_message244' style='display:none'>Unescaped model attribute near line 9: render_partial(&quot;preview&quot;, &quot;tmail&quot; =&gt; (<span class="user_input">DnConfirmationLetter.find(params[:dn_email_id]).to_tmail</span>))</span><table id='context244' class='context' style='display:none'><caption>app/views/dn_confirmation_letters/manual_preview.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;br&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;dn_email&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= render_partial 'preview', 'tmail' =&gt; @dn_email.to_tmail %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;center&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        dn_confirmation_letters/outbox_preview (DnConfirmationLettersController#outbox_preview)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context245');toggle('message245');toggle('full_message245')" ><span id='message245' style='display:block' >Unescaped model attribute near line 7: render_partial(&quot;dn_confirmation_letters/preview&quot;, &quot;tmail&quot; =&gt; (...</span><span id='full_message245' style='display:none'>Unescaped model attribute near line 7: render_partial(&quot;dn_confirmation_letters/preview&quot;, &quot;tmail&quot; =&gt; (<span class="user_input">DnConfirmationLetter.find(params[:dn_confirmation_letter_id]).to_tmail</span>))</span><table id='context245' class='context' style='display:none'><caption>app/views/dn_confirmation_letters/outbox_preview.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= link_to &quot;&lt;-- to lead: #{@dn_confirmation_letter.lead.fullname}&quot;, &quot;/leads/#{@dn_confirmation_letter.lead_id};show&quot;, :class =&gt; 'navigation' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h3&gt;WARNING!  Email may be sent while you are previewing it.  You must click &quot;edit&quot; to temporarily lock it from sending.&lt;/h3&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;dn_email&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= render_partial 'dn_confirmation_letters/preview', 'tmail' =&gt; @dn_confirmation_letter.to_tmail %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;center&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;td width=&quot;200px&quot; align=&quot;center&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        dn_confirmation_letters/view_sent (DnConfirmationLettersController#view_sent)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context246');toggle('message246');toggle('full_message246')" ><span id='message246' style='display:block' >Unescaped model attribute near line 9: render_partial(&quot;dn_confirmation_letters/preview&quot;, &quot;tmail&quot; =&gt; (...</span><span id='full_message246' style='display:none'>Unescaped model attribute near line 9: render_partial(&quot;dn_confirmation_letters/preview&quot;, &quot;tmail&quot; =&gt; (<span class="user_input">DnConfirmationLetter.find(params[:id]).to_tmail</span>))</span><table id='context246' class='context' style='display:none'><caption>app/views/dn_confirmation_letters/view_sent.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;br/&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;dn_confirmation_letter&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= render_partial &quot;dn_confirmation_letters/preview&quot;, 'tmail' =&gt; @dn_confirmation_letter.to_tmail %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        dn_emails/manual_preview (DnEmailsController#manual_update)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context247');toggle('message247');toggle('full_message247')" ><span id='message247' style='display:block' >Unescaped model attribute near line 9: render_partial(&quot;preview&quot;, &quot;tmail&quot; =&gt; (DnEmail.find(params[:dn_...</span><span id='full_message247' style='display:none'>Unescaped model attribute near line 9: render_partial(&quot;preview&quot;, &quot;tmail&quot; =&gt; (<span class="user_input">DnEmail.find(params[:dn_email_id]).to_tmail</span>))</span><table id='context247' class='context' style='display:none'><caption>app/views/dn_emails/manual_preview.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;br&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;dn_email&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'preview', 'tmail' =&gt; @dn_email.to_tmail %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;center&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        dn_emails/outbox_preview (DnEmailsController#outbox_preview)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context248');toggle('message248');toggle('full_message248')" ><span id='message248' style='display:block' >Unescaped model attribute near line 7: render_partial(&quot;dn_emails/preview&quot;, &quot;tmail&quot; =&gt; (DnEmail.find(p...</span><span id='full_message248' style='display:none'>Unescaped model attribute near line 7: render_partial(&quot;dn_emails/preview&quot;, &quot;tmail&quot; =&gt; (<span class="user_input">DnEmail.find(params[:dn_email_id]).to_tmail</span>))</span><table id='context248' class='context' style='display:none'><caption>app/views/dn_emails/outbox_preview.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= link_to &quot;&lt;-- to lead: #{@dn_email.lead.fullname}&quot;, &quot;/leads/#{@dn_email.lead_id};show&quot;, :class =&gt; 'navigation' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h3&gt;WARNING!  Email may be sent while you are previewing it.  You must click &quot;edit&quot; to temporarily lock it from sending.&lt;/h3&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;dn_email&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'dn_emails/preview', 'tmail' =&gt; @dn_email.to_tmail %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;center&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td width=&quot;200px&quot; align=&quot;center&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        dn_emails/view_received (DnEmailsController#view_received)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context249');toggle('message249');toggle('full_message249')" ><span id='message249' style='display:block' >Unescaped model attribute near line 10: render_partial(&quot;dn_emails/preview&quot;, &quot;tmail&quot; =&gt; (DnEmail.find(...</span><span id='full_message249' style='display:none'>Unescaped model attribute near line 10: render_partial(&quot;dn_emails/preview&quot;, &quot;tmail&quot; =&gt; (<span class="user_input">DnEmail.find(params[:id]).to_tmail</span>))</span><table id='context249' class='context' style='display:none'><caption>app/views/dn_emails/view_received.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;br/&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;dn_email&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial &quot;dn_emails/preview&quot;, 'tmail' =&gt; @dn_email.to_tmail %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        dn_emails/view_sent (DnEmailsController#view_sent)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context250');toggle('message250');toggle('full_message250')" ><span id='message250' style='display:block' >Unescaped model attribute near line 9: render_partial(&quot;dn_emails/preview&quot;, &quot;tmail&quot; =&gt; (DnEmail.find(p...</span><span id='full_message250' style='display:none'>Unescaped model attribute near line 9: render_partial(&quot;dn_emails/preview&quot;, &quot;tmail&quot; =&gt; (<span class="user_input">DnEmail.find(params[:id]).to_tmail</span>))</span><table id='context250' class='context' style='display:none'><caption>app/views/dn_emails/view_sent.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;br/&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;dn_email&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial &quot;dn_emails/preview&quot;, 'tmail' =&gt; @dn_email.to_tmail %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        email_templates/_email_template_as_minitable
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context422');toggle('message422');toggle('full_message422')" ><span id='message422' style='display:block' >Unescaped model attribute near line 42: email_template.attachment_ids.map do  EmailAttachment.find((l...</span><span id='full_message422' style='display:none'>Unescaped model attribute near line 42: email_template.attachment_ids.map do  <span class="user_input">EmailAttachment.find((local x)).original_filename</span>  end.join(&quot;, &quot;)</span><table id='context422' class='context' style='display:none'><caption>app/views/email_templates/_email_template_as_minitable.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>37</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot; padding=&quot;10px&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;font color=&quot;grey&quot; size=&quot;1&quot;&gt;attachments:&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= email_template.attachment_ids.map{|x| EmailAttachment.find(x).original_filename }.join(', ') %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot; padding=&quot;10px&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;font color=&quot;grey&quot; size=&quot;1&quot;&gt;default outcomes: &lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= email_template.default_outcomes %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        email_templates/as_html (EmailTemplatesController#as_html)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context251');toggle('message251');toggle('full_message251')" ><span id='message251' style='display:block' >Unescaped model attribute near line 5: render_partial(&quot;email_templates/show_as_html&quot;, &quot;email_template...</span><span id='full_message251' style='display:none'>Unescaped model attribute near line 5: render_partial(&quot;email_templates/show_as_html&quot;, &quot;email_template&quot; =&gt; (<span class="user_input">EmailTemplate.find(params[:id])</span>))</span><table id='context251' class='context' style='display:none'><caption>app/views/email_templates/as_html.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div style=&quot;width: 700px; border: solid thick black;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'email_templates/show_as_html', 'email_template' =&gt; @email_template %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        email_templates/edit (EmailTemplatesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context252');toggle('message252');toggle('full_message252')" ><span id='message252' style='display:block' >Unescaped model attribute near line 19: render_partial(&quot;email_templates/email_template_form&quot;, &quot;email_...</span><span id='full_message252' style='display:none'>Unescaped model attribute near line 19: render_partial(&quot;email_templates/email_template_form&quot;, &quot;email_template&quot; =&gt; (<span class="user_input">EmailTemplate.find(params[:id])</span>), &quot;form_url&quot; =&gt; (((&quot;/email_templates/&quot; + <span class="user_input">EmailTemplate.find(params[:id])</span>.id.to_s) + &quot;;update&quot;)), &quot;commit_string&quot; =&gt; &quot;Save&quot;)</span><table id='context252' class='context' style='display:none'><caption>app/views/email_templates/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>14</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt; </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;div class=&quot;config_edit&quot; style=&quot;width: 900px; float: none;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= render_partial 'email_templates/email_template_form', </pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>					'email_template' =&gt; @email_template, </pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>					'form_url' =&gt; form_url, </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>					'commit_string' =&gt; commit_string </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>				%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        email_templates/new (EmailTemplatesController#create)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context253');toggle('message253');toggle('full_message253')" ><span id='message253' style='display:block' >Unescaped model attribute near line 12: render_partial(&quot;email_templates/email_template_form&quot;, &quot;email_...</span><span id='full_message253' style='display:none'>Unescaped model attribute near line 12: render_partial(&quot;email_templates/email_template_form&quot;, &quot;email_template&quot; =&gt; (<span class="user_input">EmailTemplate.new(params[:email_template])</span>), &quot;form_url&quot; =&gt; (@form_url), &quot;commit_string&quot; =&gt; (@commit_string))</span><table id='context253' class='context' style='display:none'><caption>app/views/email_templates/new.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>7</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt; </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;div class=&quot;config_edit&quot; style=&quot;width: 800px; float: none;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= render_partial 'email_templates/email_template_form', </pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>					'email_template' =&gt; @email_template, </pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>					'form_url' =&gt; @form_url, </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>					'commit_string' =&gt; @commit_string </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>				%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        email_templates/review_manual_email (EmailTemplatesController#review_manual_email)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context254');toggle('message254');toggle('full_message254')" ><span id='message254' style='display:block' >Unescaped model attribute near line 14: render_partial(&quot;email_templates/sendable_email_form&quot;, &quot;my_act...</span><span id='full_message254' style='display:none'>Unescaped model attribute near line 14: render_partial(&quot;email_templates/sendable_email_form&quot;, &quot;my_action&quot; =&gt; &quot;post_review&quot;, &quot;my_controller&quot; =&gt; &quot;email_templates&quot;, &quot;lead&quot; =&gt; (<span class="user_input">Lead.find(params[:lead_id])</span>), &quot;email_template&quot; =&gt; (EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]]))), &quot;already_checked&quot; =&gt; (EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).default_attachments.to_s.split(&quot;,&quot;).map do  (local x).to_i  end), &quot;user&quot; =&gt; (User.find(params[:user_id])), &quot;quote&quot; =&gt; (Quote.find(params[:quote_id])), &quot;bodyhash&quot; =&gt; ((EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).get_bodyhash(<span class="user_input">Lead.find(params[:lead_id])</span>, Quote.find(params[:quote_id]), User.find(params[:user_id])) or session[:pending_bodyhash])), &quot;subject&quot; =&gt; ((params[:subject] or EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).get_subject(<span class="user_input">Lead.find(params[:lead_id])</span>, Quote.find(params[:quote_id]), User.find(params[:user_id]), (EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).get_bodyhash(<span class="user_input">Lead.find(params[:lead_id])</span>, Quote.find(params[:quote_id]), User.find(params[:user_id])) or session[:pending_bodyhash])))), &quot;to&quot; =&gt; (((params[:to] or EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).get_bodyhash(<span class="user_input">Lead.find(params[:lead_id])</span>, Quote.find(params[:quote_id]), User.find(params[:user_id]))[&quot;to&quot;]) or <span class="user_input">Lead.find(params[:lead_id])</span>.contact_email)), &quot;cc&quot; =&gt; (((params[:cc] or EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).get_bodyhash(<span class="user_input">Lead.find(params[:lead_id])</span>, Quote.find(params[:quote_id]), User.find(params[:user_id]))[&quot;cc&quot;]) or <span class="user_input">Lead.find(params[:lead_id])</span>.contact_email_cc)), &quot;bcc&quot; =&gt; (((params[:bcc] or EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).get_bodyhash(<span class="user_input">Lead.find(params[:lead_id])</span>, Quote.find(params[:quote_id]), User.find(params[:user_id]))[&quot;bcc&quot;]) or <span class="user_input">Lead.find(params[:lead_id])</span>.contact_email_bcc)), &quot;include_preview_send&quot; =&gt; (true), &quot;outcomes_string&quot; =&gt; ((params[:outcomes_string] or EmailTemplate.find((params[:email_template_id] or params[:etid][params[:etid_key]])).default_outcomes)))</span><table id='context254' class='context' style='display:none'><caption>app/views/email_templates/review_manual_email.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div style=&quot;width: 900px;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'email_templates/sendable_email_form',</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'my_action' =&gt; 'post_review',</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'my_controller' =&gt; 'email_templates',</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'lead' =&gt; @lead,</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'email_template' =&gt; @email_template,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'already_checked' =&gt; @email_template.default_attachments.to_s.split(',').map{|x| x.to_i},</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'user' =&gt; @user,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'quote' =&gt; @quote,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'bodyhash' =&gt; @bodyhash,</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        extra_stops/_trip
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context423');toggle('message423');toggle('full_message423')" ><span id='message423' style='display:block' >Unescaped model attribute near line 10: VApplicationHelper.seconds_to_timestring(PointToPoint.time_in...</span><span id='full_message423' style='display:none'>Unescaped model attribute near line 10: VApplicationHelper.seconds_to_timestring(<span class="user_input">PointToPoint.time_in_seconds(tripp[0], tripp[1])</span>)</span><table id='context423' class='context' style='display:none'><caption>app/views/extra_stops/_trip.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;%= image_tag 'triparrow.jpg', :size =&gt; '15x25' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;middle&quot; nowrap&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;div class=&quot;trip_duration&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;% raise &quot;trip is nil&quot; if tripp.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;span class=&quot;view_button&quot;&gt;&lt;% if PointToPoint.time_in_seconds(tripp[0], tripp[1]).nil? %&gt;???&lt;% else %&gt;&lt;%= VApplicationHelper.seconds_to_timestring(PointToPoint.time_in_seconds(tripp[0], tripp[1])) %&gt;&lt;% end %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        extractors/edit (ExtractorsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context266');toggle('message266');toggle('full_message266')" ><span id='message266' style='display:block' >Unescaped model attribute near line 83: render_partial(&quot;extractor_elements/collection&quot;, &quot;set&quot; =&gt; (Ext...</span><span id='full_message266' style='display:none'>Unescaped model attribute near line 83: render_partial(&quot;extractor_elements/collection&quot;, &quot;set&quot; =&gt; (<span class="user_input">Extractor.find(params[:id]).extractor_elements</span>), &quot;collection_div_id&quot; =&gt; &quot;extractor_elements&quot;)</span><table id='context266' class='context' style='display:none'><caption>app/views/extractors/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>79</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;br&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div id=&quot;extractor_elements&quot; style=&quot;margin: auto; background-color: white; width: 720px; padding: 10px; border: solid 1px; border-color: #000 #666 #666 #000;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'extractor_elements/collection', 'set' =&gt; @extractor.extractor_elements, 'collection_div_id' =&gt; 'extractor_elements' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        hourly_rates/batch_edit (HourlyRatesController#batch_edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context269');toggle('message269');toggle('full_message269')" ><span id='message269' style='display:block' >Unescaped model attribute near line 25: render_partial(&quot;hourly_rates/batch_form&quot;, &quot;hourly_rates&quot; =&gt; (...</span><span id='full_message269' style='display:none'>Unescaped model attribute near line 25: render_partial(&quot;hourly_rates/batch_form&quot;, &quot;hourly_rates&quot; =&gt; (<span class="user_input">HourlyRate.find(:all, :conditions =&gt; ([&quot;move_date &gt;= ? and move_date &lt;= ? and service_location_id = ?&quot;, Time.parse(params[:date_range][:start_date]), Time.parse(params[:date_range][:end_date]), ServiceLocation.find((params[:date_range][:service_location_id] or ServiceLocation.find(:first).id)).id]), :order =&gt; &quot;move_date ASC&quot;).slice!(0, (HourlyRate.find(:all, :conditions =&gt; ([&quot;move_date &gt;= ? and move_date &lt;= ? and service_location_id = ?&quot;, Time.parse(params[:date_range][:start_date]), Time.parse(params[:date_range][:end_date]), ServiceLocation.find((params[:date_range][:service_location_id] or ServiceLocation.find(:first).id)).id]), :order =&gt; &quot;move_date ASC&quot;).size.to_f / 2).floor)</span>), &quot;unsaved_errors&quot; =&gt; ({}), &quot;leads&quot; =&gt; (@leads))</span><table id='context269' class='context' style='display:none'><caption>app/views/hourly_rates/batch_edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>20</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;span class=&quot;instructions2&quot;&gt;when you're done ... &lt;/span&gt;&lt;%= submit_tag 'Save All'%&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial 'hourly_rates/batch_form', 'hourly_rates' =&gt; @hourly_rates_1, 'unsaved_errors' =&gt; @unsaved_errors, 'leads' =&gt; @leads %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial 'hourly_rates/batch_form', 'hourly_rates' =&gt; @hourly_rates_2, 'unsaved_errors' =&gt; @unsaved_errors, 'leads' =&gt; @leads %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        hourly_rates/batch_edit (HourlyRatesController#batch_edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context270');toggle('message270');toggle('full_message270')" ><span id='message270' style='display:block' >Unescaped model attribute near line 28: render_partial(&quot;hourly_rates/batch_form&quot;, &quot;hourly_rates&quot; =&gt; (...</span><span id='full_message270' style='display:none'>Unescaped model attribute near line 28: render_partial(&quot;hourly_rates/batch_form&quot;, &quot;hourly_rates&quot; =&gt; (<span class="user_input">HourlyRate.find(:all, :conditions =&gt; ([&quot;move_date &gt;= ? and move_date &lt;= ? and service_location_id = ?&quot;, Time.parse(params[:date_range][:start_date]), Time.parse(params[:date_range][:end_date]), ServiceLocation.find((params[:date_range][:service_location_id] or ServiceLocation.find(:first).id)).id]), :order =&gt; &quot;move_date ASC&quot;)</span>), &quot;unsaved_errors&quot; =&gt; ({}), &quot;leads&quot; =&gt; (@leads))</span><table id='context270' class='context' style='display:none'><caption>app/views/hourly_rates/batch_edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>23</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial 'hourly_rates/batch_form', 'hourly_rates' =&gt; @hourly_rates_1, 'unsaved_errors' =&gt; @unsaved_errors, 'leads' =&gt; @leads %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial 'hourly_rates/batch_form', 'hourly_rates' =&gt; @hourly_rates_2, 'unsaved_errors' =&gt; @unsaved_errors, 'leads' =&gt; @leads %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td colspan=&quot;2&quot; align=&quot;right&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span class=&quot;instructions2&quot;&gt;when you're done ...&lt;/span&gt;&lt;%= submit_tag 'Save All'%&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        import_jobs/_csv_import_form
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context431');toggle('message431');toggle('full_message431')" ><span id='message431' style='display:block' >Unescaped model attribute near line 17: (local f).select(&quot;source_string&quot;, LeadCompany.find(:all).sort...</span><span id='full_message431' style='display:none'>Unescaped model attribute near line 17: (local f).select(&quot;source_string&quot;, <span class="user_input">LeadCompany.find(:all).sort_by</span> do  (local c).name  end.map do  [(local c).name, (local c).name]  end.concat([[&quot;manually created&quot;, &quot;manually created&quot;]]), :selected =&gt; &quot;manually created&quot;)</span><table id='context431' class='context' style='display:none'><caption>app/views/import_jobs/_csv_import_form.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>12</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;td&gt;&lt;%= file_field_tag :csv_file %&gt;&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;these leads come from:&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;	</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= f.select 'source_string', LeadCompany.find(:all).sort_by{|c| c.name}.map{|c| [c.name, c.name]}.concat([['manually created', 'manually created']]), :selected =&gt; 'manually created'%&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td colspan=&quot;2&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= submit_tag 'import' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        inventories/_form
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context432');toggle('message432');toggle('full_message432')" ><span id='message432' style='display:block' >Unescaped model attribute near line 60: render_partial(&quot;inventory_line_items/form&quot;, &quot;ili&quot; =&gt; (Invento...</span><span id='full_message432' style='display:none'>Unescaped model attribute near line 60: render_partial(&quot;inventory_line_items/form&quot;, &quot;ili&quot; =&gt; (<span class="user_input">InventoryLineItem.new</span>), &quot;index&quot; =&gt; ((local index)), &quot;items&quot; =&gt; ((local items)), &quot;rooms&quot; =&gt; ((local rooms)))</span><table id='context432' class='context' style='display:none'><caption>app/views/inventories/_form.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>55</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;% index += 1 %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% total_pounds += ili.pounds.to_f * ili.quantity.to_f %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% total_cuft += ili.cubic_feet.to_f * ili.quantity.to_f %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if inventory.inventory_line_items.size == 0 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'inventory_line_items/form', 'ili' =&gt; InventoryLineItem.new, 'index' =&gt; index, 'items' =&gt; items, 'rooms' =&gt; rooms %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;&lt;!-- id=&quot;inventory_form&quot; --&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= f.hidden_field :lead_id %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        inventories/edit (InventoriesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context272');toggle('message272');toggle('full_message272')" ><span id='message272' style='display:block' >Unescaped model attribute near line 6: render_partial(&quot;inventories/form&quot;, &quot;inventory&quot; =&gt; ((((Inventor...</span><span id='full_message272' style='display:none'>Unescaped model attribute near line 6: render_partial(&quot;inventories/form&quot;, &quot;inventory&quot; =&gt; ((((<span class="user_input">Inventory.find(:first, :conditions =&gt; ([&quot;lead_id = ? and purpose is null&quot;, params[:lead_id]]))</span> or Inventory.new(:lead_id =&gt; (params[:lead_id]))) or Inventory.find(:first, :conditions =&gt; ([&quot;purpose = ? and purpose_type = ?&quot;, params[:job_type_id], params[:job_type]]))) or Inventory.new(:lead_id =&gt; (params[:lead_id]), :purpose =&gt; (params[:job_type_id]), :purpose_type =&gt; (params[:job_type])))))</span><table id='context272' class='context' style='display:none'><caption>app/views/inventories/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= error_messages_for :inventory %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:inventory, :url =&gt; inventory_path(@inventory), :html =&gt; { :method =&gt; :put }) do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'inventories/form', 'inventory' =&gt; @inventory %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= submit_tag &quot;Update&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        inventory_extractors/edit (InventoryExtractorsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context274');toggle('message274');toggle('full_message274')" ><span id='message274' style='display:block' >Unescaped model attribute near line 14: render_partial(&quot;inventory_extractors/form&quot;, &quot;inventory_extrac...</span><span id='full_message274' style='display:none'>Unescaped model attribute near line 14: render_partial(&quot;inventory_extractors/form&quot;, &quot;inventory_extractor&quot; =&gt; (<span class="user_input">InventoryExtractor.find(params[:id])</span>), &quot;f&quot; =&gt; (FormBuilder.new))</span><table id='context274' class='context' style='display:none'><caption>app/views/inventory_extractors/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>11</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;inventory_extractor&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:inventory_extractor, :url =&gt; inventory_extractor_path(@inventory_extractor), :html =&gt; { :method =&gt; :put }) do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'inventory_extractors/form', 'inventory_extractor' =&gt; @inventory_extractor, 'f' =&gt; f %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>	    &lt;%= submit_tag &quot;Save&quot; %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        inventory_items/edit (InventoryItemsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context275');toggle('message275');toggle('full_message275')" ><span id='message275' style='display:block' >Unescaped model attribute near line 7: render_partial(&quot;inventory_items/form&quot;, &quot;f&quot; =&gt; (FormBuilder.new...</span><span id='full_message275' style='display:none'>Unescaped model attribute near line 7: render_partial(&quot;inventory_items/form&quot;, &quot;f&quot; =&gt; (FormBuilder.new), &quot;inventory_item&quot; =&gt; (<span class="user_input">InventoryItem.find(params[:id])</span>))</span><table id='context275' class='context' style='display:none'><caption>app/views/inventory_items/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= error_messages_for :inventory_item %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:inventory_item, :url =&gt; inventory_item_path(@inventory_item), :html =&gt; { :method =&gt; :put }) do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'inventory_items/form', 'f' =&gt; f, 'inventory_item' =&gt; @inventory_item %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= submit_tag &quot;Save&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        inventory_items/index (InventoryItemsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context276');toggle('message276');toggle('full_message276')" >Unescaped model attribute near line 3: <span class="user_input">InventoryItem.find(:all).sort_by</span> do  (local x).name  end.size<table id='context276' class='context' style='display:none'><caption>app/views/inventory_items/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= link_to 'go to Rooms', rooms_path, :class =&gt; 'navigation' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h1&gt;&lt;%= @inventory_items.size %&gt; Inventory Items&lt;/h1&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;span class=&quot;label&quot;&gt;Yes, this interface is ugly, but it works&lt;/span&gt;&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'New Inventory Item', new_inventory_item_path %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr width=&quot;500px&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table border=&quot;1&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        inventory_items/new (InventoryItemsController#new)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context277');toggle('message277');toggle('full_message277')" ><span id='message277' style='display:block' >Unescaped model attribute near line 7: render_partial(&quot;inventory_items/form&quot;, &quot;f&quot; =&gt; (FormBuilder.new...</span><span id='full_message277' style='display:none'>Unescaped model attribute near line 7: render_partial(&quot;inventory_items/form&quot;, &quot;f&quot; =&gt; (FormBuilder.new), &quot;inventory_item&quot; =&gt; (<span class="user_input">InventoryItem.new</span>))</span><table id='context277' class='context' style='display:none'><caption>app/views/inventory_items/new.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= error_messages_for :inventory_item %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:inventory_item, :url =&gt; inventory_items_path) do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'inventory_items/form', 'f' =&gt; f, 'inventory_item' =&gt; @inventory_item %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= submit_tag &quot;Create&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        job_references/csv
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context433');toggle('message433');toggle('full_message433')" ><span id='message433' style='display:block' >Unescaped model attribute near line 7: <span class="user_input">JobReference.expected_fields.map</span> do  (local x)[0]  end.join(&quot;,...</span><span id='full_message433' style='display:none'>Unescaped model attribute near line 7: <span class="user_input">JobReference.expected_fields.map</span> do  (local x)[0]  end.join(&quot;,&quot;)</span><table id='context433' class='context' style='display:none'><caption>app/views/job_references/csv.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;instructions&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>	Copy-paste everything below the blue line into a text file (use Notepad, because it adds no extra behind-the-scenes markup).  Save that file with a .csv extension, and you should be golden.  Please make sure not to have any extra, empty lines at the beginning or end of the file before you save.</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr color=&quot;blue&quot; thickness=&quot;5px&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;text-align: left; width: 4000px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= JobReference.expected_fields.map{|x| x[0]}.join(',') %&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for j in JobReference.find(:all) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%=h pretty_date_short(j.move_date) %&gt;,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%=h j.move_type %&gt;,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%=h j.reference_number %&gt;,</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        job_references/edit (JobReferencesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context279');toggle('message279');toggle('full_message279')" ><span id='message279' style='display:block' >Unescaped model attribute near line 6: render_partial(&quot;form&quot;, &quot;f&quot; =&gt; (FormBuilder.new), &quot;jr&quot; =&gt; (JobR...</span><span id='full_message279' style='display:none'>Unescaped model attribute near line 6: render_partial(&quot;form&quot;, &quot;f&quot; =&gt; (FormBuilder.new), &quot;jr&quot; =&gt; (<span class="user_input">JobReference.find(params[:id])</span>))</span><table id='context279' class='context' style='display:none'><caption>app/views/job_references/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;Editing Job Reference&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :job_reference %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:job_reference, :url =&gt; job_reference_path(@job_reference), :html =&gt; { :method =&gt; :put }) do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= render_partial 'form', 'f' =&gt; f, 'jr' =&gt; @job_reference%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= submit_tag &quot;Update&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        job_references/index (JobReferencesController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context280');toggle('message280');toggle('full_message280')" >Unescaped model attribute near line 1: <span class="user_input">JobReference.count</span><table id='context280' class='context' style='display:none'><caption>app/views/job_references/index.rhtml</caption>        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;&lt;font color=&quot;blue&quot;&gt;Job References (&lt;%= @count %&gt; total), page &lt;%= @page %&gt;&lt;/font&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'New job_reference', new_job_reference_path %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        job_references/new (JobReferencesController#create)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context281');toggle('message281');toggle('full_message281')" ><span id='message281' style='display:block' >Unescaped model attribute near line 6: render_partial(&quot;form&quot;, &quot;f&quot; =&gt; (FormBuilder.new), &quot;jr&quot; =&gt; (JobR...</span><span id='full_message281' style='display:none'>Unescaped model attribute near line 6: render_partial(&quot;form&quot;, &quot;f&quot; =&gt; (FormBuilder.new), &quot;jr&quot; =&gt; (<span class="user_input">JobReference.new(params[:job_reference])</span>))</span><table id='context281' class='context' style='display:none'><caption>app/views/job_references/new.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;New Job Reference&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :job_reference %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:job_reference, :url =&gt; job_references_path) do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= render_partial 'form', 'f' =&gt; f, 'jr' =&gt; @job_reference%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= submit_tag &quot;Update&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        jobs/edit (JobsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context283');toggle('message283');toggle('full_message283')" ><span id='message283' style='display:block' >Unescaped model attribute near line 1: (((&quot; JOB ID &quot; + <span class="user_input">Job.find(1)</span>.id.to_s) + &quot; Job Date &quot;) + Job.fin...</span><span id='full_message283' style='display:none'>Unescaped model attribute near line 1: (((&quot; JOB ID &quot; + <span class="user_input">Job.find(1)</span>.id.to_s) + &quot; Job Date &quot;) + <span class="user_input">Job.find(1)</span>.created_on.to_s)</span><table id='context283' class='context' style='display:none'><caption>app/views/jobs/edit.rhtml</caption>        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt; Job Details &lt;%= &quot; JOB ID &quot; + @job.id.to_s + &quot; Job Date &quot; + @job.created_on.to_s%&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for :job,  @job, :url =&gt; {:action =&gt; &quot;update&quot;, :id =&gt; @job.id } do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;p&gt;Id: &lt;%= f.text_field :id %&gt;&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'> &lt;p&gt;Name: &lt;%= f.text_field :first_name %&gt;&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;% for stop in @job.job_extra_stops %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>     &lt;% fields_for &quot;job[job_extra_stop_attributes][]&quot;, stop do |stop_form| %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        layouts/_header
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context434');toggle('message434');toggle('full_message434')" ><span id='message434' style='display:block' >Unescaped model attribute near line 65: render_partial(&quot;users/checkout_status&quot;, :user =&gt; (User.find(s...</span><span id='full_message434' style='display:none'>Unescaped model attribute near line 65: render_partial(&quot;users/checkout_status&quot;, :user =&gt; (<span class="user_input">User.find(session[:user].id)</span>))</span><table id='context434' class='context' style='display:none'><caption>app/views/layouts/_header.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>60</pre>
          </td>
          <td class='context'>
            <pre class='context'>            &lt;td align=&quot;right&quot; bgcolor=&quot;lightgreen&quot; valign=&quot;top&quot; cellpadding=&quot;5px&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% if session[:user].nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;div id=&quot;checkout_status_container&quot; style=&quot;margin: 0 5px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  &lt;%= render_partial 'users/checkout_status', :user =&gt; User.find(session[:user].id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        lead_companies/show (LeadCompaniesController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context291');toggle('message291');toggle('full_message291')" ><span id='message291' style='display:block' >Unescaped model attribute near line 5: render_partial(&quot;undigestible_emails/instructions_and_label&quot;, &quot;...</span><span id='full_message291' style='display:none'>Unescaped model attribute near line 5: render_partial(&quot;undigestible_emails/instructions_and_label&quot;, &quot;instructions&quot; =&gt; &quot;A Lead Company may send emails of multiple formats, hence you can give it multiple Microformats.  Each microformat consists of an extractor and a signature.  First create, test, and perfect the signature.  Then move on to the extractor.&quot;, &quot;label&quot; =&gt; ((&quot;lead company: &quot; + <span class="user_input">LeadCompany.find(params[:id], :include =&gt; &quot;microformats&quot;).name</span>)))</span><table id='context291' class='context' style='display:none'><caption>app/views/lead_companies/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= render_partial 'workflow/microformat_editing_menu' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'undigestible_emails/instructions_and_label', 'instructions' =&gt; @instructions, 'label' =&gt; 'lead company: '+@lead_company.name %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div class=&quot;lead_company&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        lead_companies/show (LeadCompaniesController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context292');toggle('message292');toggle('full_message292')" ><span id='message292' style='display:block' >Unescaped model attribute near line 24: render_partial(&quot;microformats/microformat_show&quot;, &quot;microformat&quot;...</span><span id='full_message292' style='display:none'>Unescaped model attribute near line 24: render_partial(&quot;microformats/microformat_show&quot;, &quot;microformat&quot; =&gt; (<span class="user_input">Microformat.new</span>))</span><table id='context292' class='context' style='display:none'><caption>app/views/lead_companies/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>19</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;span class=&quot;label&quot; style=&quot;font-size: 13px;&quot;&gt;microformats:&lt;/span&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if true %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;microformats&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% @microformats.each do |microformat| %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial &quot;microformats/microformat_show&quot;, 'microformat' =&gt; microformat %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/index (LeadsController#batch_operation)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context294');toggle('message294');toggle('full_message294')" ><span id='message294' style='display:block' >Unescaped model attribute near line 46: render_partial(&quot;leads/leads_table_row&quot;, &quot;lead&quot; =&gt; ((local lea...</span><span id='full_message294' style='display:none'>Unescaped model attribute near line 46: render_partial(&quot;leads/leads_table_row&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;counter&quot; =&gt; ((((<span class="user_input">Lead.paginate(:page =&gt; ((params[:page] or 1)), :per_page =&gt; (Configurable.get_hash_by_name(&quot;performance&quot;)[&quot;leads_per_page&quot;]), :conditions =&gt; (&quot;id IN (#{params[:batch_operation][:lead_ids].keys.join(&quot;,&quot;)})&quot;)).current_page</span> - 1) * Lead.paginate(:page =&gt; ((params[:page] or 1)), :per_page =&gt; (Configurable.get_hash_by_name(&quot;performance&quot;)[&quot;leads_per_page&quot;]), :conditions =&gt; (&quot;id IN (#{params[:batch_operation][:lead_ids].keys.join(&quot;,&quot;)})&quot;)).per_page) + 1)), &quot;checkout_initials&quot; =&gt; (User.checkout_lists[1][User.checkout_lists[0].index((local lead).id)]), &quot;hotness_display_threshold&quot; =&gt; (Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]))</span><table id='context294' class='context' style='display:none'><caption>app/views/leads/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>41</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table cellpadding=&quot;2px&quot; border=&quot;1&quot; width=&quot;100%&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'leads/leads_table_headers_row' %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% counter = ((@leads.current_page - 1) * @leads.per_page) + 1 %&gt;  </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for lead in @leads.sort_by{|l| l.smart_email_date_sortable}.reverse %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% if @checkout_ids.include?(lead.id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/leads_table_row', 'lead' =&gt; lead, 'counter' =&gt; counter, 'checkout_initials' =&gt; @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/leads_table_row', 'lead' =&gt; lead, 'counter' =&gt; counter, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% counter += 1%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/index (LeadsController#batch_operation)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context295');toggle('message295');toggle('full_message295')" ><span id='message295' style='display:block' >Unescaped model attribute near line 48: render_partial(&quot;leads/leads_table_row&quot;, &quot;lead&quot; =&gt; ((local lea...</span><span id='full_message295' style='display:none'>Unescaped model attribute near line 48: render_partial(&quot;leads/leads_table_row&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;counter&quot; =&gt; ((((<span class="user_input">Lead.paginate(:page =&gt; ((params[:page] or 1)), :per_page =&gt; (Configurable.get_hash_by_name(&quot;performance&quot;)[&quot;leads_per_page&quot;]), :conditions =&gt; (&quot;id IN (#{params[:batch_operation][:lead_ids].keys.join(&quot;,&quot;)})&quot;)).current_page</span> - 1) * Lead.paginate(:page =&gt; ((params[:page] or 1)), :per_page =&gt; (Configurable.get_hash_by_name(&quot;performance&quot;)[&quot;leads_per_page&quot;]), :conditions =&gt; (&quot;id IN (#{params[:batch_operation][:lead_ids].keys.join(&quot;,&quot;)})&quot;)).per_page) + 1)), &quot;checkout_initials&quot; =&gt; (nil), &quot;hotness_display_threshold&quot; =&gt; (Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]))</span><table id='context295' class='context' style='display:none'><caption>app/views/leads/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>43</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;% counter = ((@leads.current_page - 1) * @leads.per_page) + 1 %&gt;  </pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for lead in @leads.sort_by{|l| l.smart_email_date_sortable}.reverse %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% if @checkout_ids.include?(lead.id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/leads_table_row', 'lead' =&gt; lead, 'counter' =&gt; counter, 'checkout_initials' =&gt; @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/leads_table_row', 'lead' =&gt; lead, 'counter' =&gt; counter, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% counter += 1%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/search (LeadsController#search)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context299');toggle('message299');toggle('full_message299')" ><span id='message299' style='display:block' >Unescaped model attribute near line 45: render_partial(&quot;leads/leads_table_row&quot;, &quot;lead&quot; =&gt; ((local lea...</span><span id='full_message299' style='display:none'>Unescaped model attribute near line 45: render_partial(&quot;leads/leads_table_row&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;counter&quot; =&gt; ((1 + (100 * (<span class="user_input">Lead.search((params[:page] or 1), Configurable.get_hash_by_name(&quot;performance&quot;)[&quot;leads_per_page&quot;], params).current_page</span> - 1)))), &quot;checkout_initials&quot; =&gt; (User.checkout_lists[1][User.checkout_lists[0].index((local lead).id)]), &quot;hotness_display_threshold&quot; =&gt; (Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]))</span><table id='context299' class='context' style='display:none'><caption>app/views/leads/search.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>40</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;%= render_partial 'leads/leads_table_headers_row' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for lead in @leads %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% if @checkout_ids.include?(lead.id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial 'leads/leads_table_row', 'lead' =&gt; lead, 'counter' =&gt; counter, 'checkout_initials' =&gt; @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial 'leads/leads_table_row', 'lead' =&gt; lead, 'counter' =&gt; counter, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% counter += 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/search (LeadsController#search)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context300');toggle('message300');toggle('full_message300')" ><span id='message300' style='display:block' >Unescaped model attribute near line 47: render_partial(&quot;leads/leads_table_row&quot;, &quot;lead&quot; =&gt; ((local lea...</span><span id='full_message300' style='display:none'>Unescaped model attribute near line 47: render_partial(&quot;leads/leads_table_row&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;counter&quot; =&gt; ((1 + (100 * (<span class="user_input">Lead.search((params[:page] or 1), Configurable.get_hash_by_name(&quot;performance&quot;)[&quot;leads_per_page&quot;], params).current_page</span> - 1)))), &quot;checkout_initials&quot; =&gt; (nil), &quot;hotness_display_threshold&quot; =&gt; (Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]))</span><table id='context300' class='context' style='display:none'><caption>app/views/leads/search.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>43</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;% for lead in @leads %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% if @checkout_ids.include?(lead.id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial 'leads/leads_table_row', 'lead' =&gt; lead, 'counter' =&gt; counter, 'checkout_initials' =&gt; @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial 'leads/leads_table_row', 'lead' =&gt; lead, 'counter' =&gt; counter, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% counter += 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context301');toggle('message301');toggle('full_message301')" ><span id='message301' style='display:block' >Unescaped model attribute near line 6: render_partial(&quot;tasks/minimizable_task_show&quot;, &quot;task&quot; =&gt; ((DnTa...</span><span id='full_message301' style='display:none'>Unescaped model attribute near line 6: render_partial(&quot;tasks/minimizable_task_show&quot;, &quot;task&quot; =&gt; ((<span class="user_input">DnTask.find(params[:task_id])</span> or nil)), &quot;container_div_id&quot; =&gt; &quot;task_center&quot;, &quot;mode&quot; =&gt; &quot;open&quot;)</span><table id='context301' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;% # raise &quot;entered show&quot; %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if @task %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;div id=&quot;task_center&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= render_partial 'tasks/minimizable_task_show', 'task' =&gt; @task, 'container_div_id' =&gt; 'task_center', 'mode' =&gt; 'open' %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;errors&quot;&gt;&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% debug = false %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context303');toggle('message303');toggle('full_message303')" ><span id='message303' style='display:block' >Unescaped model attribute near line 65: render_partial(&quot;extra_stops/lead_stops&quot;, &quot;lead&quot; =&gt; ((Lead.fin...</span><span id='full_message303' style='display:none'>Unescaped model attribute near line 65: render_partial(&quot;extra_stops/lead_stops&quot;, &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))))</span><table id='context303' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>63</pre>
          </td>
          <td class='context'>
            <pre class='context'>            &lt;div id=&quot;leads_map_container&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;div id=&quot;lead_stops&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'extra_stops/lead_stops', 'lead' =&gt; @lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= render_partial 'leads/lead_map', 'lead' =&gt; @lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context304');toggle('message304');toggle('full_message304')" ><span id='message304' style='display:block' >Unescaped model attribute near line 67: render_partial(&quot;leads/lead_map&quot;, &quot;lead&quot; =&gt; ((Lead.find(params...</span><span id='full_message304' style='display:none'>Unescaped model attribute near line 67: render_partial(&quot;leads/lead_map&quot;, &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))))</span><table id='context304' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>63</pre>
          </td>
          <td class='context'>
            <pre class='context'>            &lt;div id=&quot;leads_map_container&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;div id=&quot;lead_stops&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'extra_stops/lead_stops', 'lead' =&gt; @lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= render_partial 'leads/lead_map', 'lead' =&gt; @lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context305');toggle('message305');toggle('full_message305')" ><span id='message305' style='display:block' >Unescaped model attribute near line 102: render_partial(&quot;sms_messages/manual_sms_form&quot;, nil, &quot;quote&quot; ...</span><span id='full_message305' style='display:none'>Unescaped model attribute near line 102: render_partial(&quot;sms_messages/manual_sms_form&quot;, nil, &quot;quote&quot; =&gt; ((<span class="user_input">Lead.find(params[:id]).quotes</span>.first or VQuoteHelper.lead_to_quote(Lead.find(params[:id])))), &quot;lead&quot; =&gt; ((Lead.find(params[:id]) or Lead.find(Lead.find(params[:id]).id))), &quot;container_div_id&quot; =&gt; &quot;send_sms_panel&quot;, &quot;quotes&quot; =&gt; (<span class="user_input">Lead.find(params[:id]).quotes</span>))</span><table id='context305' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>97</pre>
          </td>
          <td class='context'>
            <pre class='context'>            &lt;a href=&quot;#&quot; onclick=&quot;Element.toggle('send_sms_container'); return false;&quot; class=&quot;view&quot;&gt;(+/-)&lt;/a&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;div id=&quot;send_sms_container&quot; style=&quot;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;div id=&quot;send_sms_panel&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'sms_messages/manual_sms_form', nil, 'quote' =&gt; @quote, 'lead' =&gt; @lead, 'container_div_id' =&gt; 'send_sms_panel', 'quotes' =&gt; @quotes %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context306');toggle('message306');toggle('full_message306')" ><span id='message306' style='display:block' >Unescaped model attribute near line 118: render_partial(&quot;leads/manual_email_form&quot;, nil, &quot;quote&quot; =&gt; ((...</span><span id='full_message306' style='display:none'>Unescaped model attribute near line 118: render_partial(&quot;leads/manual_email_form&quot;, nil, &quot;quote&quot; =&gt; ((<span class="user_input">Lead.find(params[:id]).quotes</span>.first or VQuoteHelper.lead_to_quote(Lead.find(params[:id])))), &quot;quotes&quot; =&gt; (<span class="user_input">Lead.find(params[:id]).quotes</span>), &quot;lead&quot; =&gt; ((Lead.find(params[:id]) or Lead.find(Lead.find(params[:id]).id))), &quot;stringified_default_task_params&quot; =&gt; (Configurable.hash_to_string(&quot;SendemailTask&quot; =&gt; ({ &quot;task_params&quot; =&gt; ({ &quot;lead_id&quot; =&gt; (Lead.find(params[:id]).id.to_s), &quot;to&quot; =&gt; (Lead.find(params[:id]).contact_email), &quot;quote_id&quot; =&gt; ((<span class="user_input">Lead.find(params[:id]).quotes</span>.first or VQuoteHelper.lead_to_quote(Lead.find(params[:id]))).id) }) }), &quot;PhonecallTask&quot; =&gt; ({ &quot;task_params&quot; =&gt; ({ &quot;lead_id&quot; =&gt; (Lead.find(params[:id]).id.to_s), &quot;first_number&quot; =&gt; (Lead.find(params[:id]).phone1), &quot;second_number&quot; =&gt; (Lead.find(params[:id]).phone2) }) }))))</span><table id='context306' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>114</pre>
          </td>
          <td class='context'>
            <pre class='context'>            &lt;b&gt;send email&lt;/b&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;a href=&quot;#&quot; onclick=&quot;Element.toggle('send_email_container'); return false;&quot; class=&quot;view&quot;&gt;(+/-)&lt;/a&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;div id=&quot;send_email_container&quot; style=&quot;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= render_partial 'leads/manual_email_form', nil, 'quote' =&gt; @quote, 'quotes' =&gt; @quotes, 'lead' =&gt; @lead, 'stringified_default_task_params' =&gt; @stringified_task_params %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>120</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context307');toggle('message307');toggle('full_message307')" ><span id='message307' style='display:block' >Unescaped model attribute near line 135: render_partial(&quot;job_references/mini&quot;, &quot;jr&quot; =&gt; ((Lead.find(pa...</span><span id='full_message307' style='display:none'>Unescaped model attribute near line 135: render_partial(&quot;job_references/mini&quot;, &quot;jr&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id)).reference1), &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))), &quot;index&quot; =&gt; 1)</span><table id='context307' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>130</pre>
          </td>
          <td class='context'>
            <pre class='context'>            &lt;div id=&quot;references_container&quot; style=&quot;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% if @lead.reference_1_id.nil? and @lead.reference_2_id.nil? and @lead.reference_3_id.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;font color=&quot;grey&quot;&gt;(no references)&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% unless @lead.reference_1_id.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'job_references/mini', 'jr' =&gt; @lead.reference1, 'lead' =&gt; @lead, 'index' =&gt; 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>137</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% unless @lead.reference_2_id.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>138</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'job_references/mini', 'jr' =&gt; @lead.reference2, 'lead' =&gt; @lead, 'index' =&gt; 2 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>139</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>140</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% unless @lead.reference_3_id.nil? %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context308');toggle('message308');toggle('full_message308')" ><span id='message308' style='display:block' >Unescaped model attribute near line 138: render_partial(&quot;job_references/mini&quot;, &quot;jr&quot; =&gt; ((Lead.find(pa...</span><span id='full_message308' style='display:none'>Unescaped model attribute near line 138: render_partial(&quot;job_references/mini&quot;, &quot;jr&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id)).reference2), &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))), &quot;index&quot; =&gt; 2)</span><table id='context308' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>133</pre>
          </td>
          <td class='context'>
            <pre class='context'>              &lt;% end %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% unless @lead.reference_1_id.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'job_references/mini', 'jr' =&gt; @lead.reference1, 'lead' =&gt; @lead, 'index' =&gt; 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>137</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% unless @lead.reference_2_id.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>138</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'job_references/mini', 'jr' =&gt; @lead.reference2, 'lead' =&gt; @lead, 'index' =&gt; 2 %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>139</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>140</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% unless @lead.reference_3_id.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>141</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'job_references/mini', 'jr' =&gt; @lead.reference3, 'lead' =&gt; @lead, 'index' =&gt; 3 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>142</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>143</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;br&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context309');toggle('message309');toggle('full_message309')" ><span id='message309' style='display:block' >Unescaped model attribute near line 141: render_partial(&quot;job_references/mini&quot;, &quot;jr&quot; =&gt; ((Lead.find(pa...</span><span id='full_message309' style='display:none'>Unescaped model attribute near line 141: render_partial(&quot;job_references/mini&quot;, &quot;jr&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id)).reference3), &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))), &quot;index&quot; =&gt; 3)</span><table id='context309' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>136</pre>
          </td>
          <td class='context'>
            <pre class='context'>              &lt;% end %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>137</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% unless @lead.reference_2_id.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>138</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'job_references/mini', 'jr' =&gt; @lead.reference2, 'lead' =&gt; @lead, 'index' =&gt; 2 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>139</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>140</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% unless @lead.reference_3_id.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>141</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'job_references/mini', 'jr' =&gt; @lead.reference3, 'lead' =&gt; @lead, 'index' =&gt; 3 %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>142</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>143</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>144</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= button_to 'Update References', :controller =&gt; 'job_references', :action =&gt; 'set_references_for_lead', :lead_id =&gt; @lead.id %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context310');toggle('message310');toggle('full_message310')" ><span id='message310' style='display:block' >Unescaped model attribute near line 158: render_partial(&quot;leads/problem_flags_form&quot;, nil, &quot;lead&quot; =&gt; ((...</span><span id='full_message310' style='display:none'>Unescaped model attribute near line 158: render_partial(&quot;leads/problem_flags_form&quot;, nil, &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))))</span><table id='context310' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>153</pre>
          </td>
          <td class='context'>
            <pre class='context'>        &lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>155</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;b&gt;problem flags&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>156</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;a href=&quot;#&quot; onclick=&quot;Element.toggle('problem_flags_container'); return false;&quot; class=&quot;view&quot;&gt;(+/-)&lt;/a&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>157</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;div id=&quot;problem_flags_container&quot; style=&quot;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>158</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= render_partial 'leads/problem_flags_form', nil, 'lead' =&gt; @lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>160</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>161</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>162</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context311');toggle('message311');toggle('full_message311')" ><span id='message311' style='display:block' >Unescaped model attribute near line 172: render_partial(&quot;leads/merge_form&quot;, nil, &quot;lead&quot; =&gt; ((Lead.fin...</span><span id='full_message311' style='display:none'>Unescaped model attribute near line 172: render_partial(&quot;leads/merge_form&quot;, nil, &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))))</span><table id='context311' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>167</pre>
          </td>
          <td class='context'>
            <pre class='context'>          &lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>168</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>169</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;b&gt;duplicate merge&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>170</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;a href=&quot;#&quot; onclick=&quot;Element.toggle('merge_form_container'); return false;&quot; class=&quot;view&quot;&gt;(+/-)&lt;/a&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>171</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;div id=&quot;merge_form_container&quot; style=&quot;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>172</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;%= render_partial 'leads/merge_form', nil, 'lead' =&gt; @lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>174</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>175</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>176</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>177</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context312');toggle('message312');toggle('full_message312')" ><span id='message312' style='display:block' >Unescaped model attribute near line 183: (<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>....</span><span id='full_message312' style='display:none'>Unescaped model attribute near line 183: (<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id)).service_location.name</span><table id='context312' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>179</pre>
          </td>
          <td class='context'>
            <pre class='context'>        &lt;tr&gt;&lt;td&gt;&lt;hr&gt;&lt;/td&gt;&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>181</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>182</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;b&gt;service location: &lt;%= @lead.service_location.name %&gt;&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>184</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;a href=&quot;#&quot; onclick=&quot;Element.toggle('service_location_form_container'); return false;&quot; class=&quot;view&quot;&gt;(+/-)&lt;/a&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;div id=&quot;service_location_form_container&quot; style=&quot;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= render_partial 'leads/service_area_form', nil, 'lead' =&gt; @lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context313');toggle('message313');toggle('full_message313')" ><span id='message313' style='display:block' >Unescaped model attribute near line 186: render_partial(&quot;leads/service_area_form&quot;, nil, &quot;lead&quot; =&gt; ((L...</span><span id='full_message313' style='display:none'>Unescaped model attribute near line 186: render_partial(&quot;leads/service_area_form&quot;, nil, &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))))</span><table id='context313' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>181</pre>
          </td>
          <td class='context'>
            <pre class='context'>        &lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>182</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;b&gt;service location: &lt;%= @lead.service_location.name %&gt;&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>184</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;a href=&quot;#&quot; onclick=&quot;Element.toggle('service_location_form_container'); return false;&quot; class=&quot;view&quot;&gt;(+/-)&lt;/a&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;div id=&quot;service_location_form_container&quot; style=&quot;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= render_partial 'leads/service_area_form', nil, 'lead' =&gt; @lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>189</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>190</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context314');toggle('message314');toggle('full_message314')" ><span id='message314' style='display:block' >Unescaped model attribute near line 206: render_partial(&quot;leads/lead_and_quote&quot;, nil, &quot;lead&quot; =&gt; ((Lead...</span><span id='full_message314' style='display:none'>Unescaped model attribute near line 206: render_partial(&quot;leads/lead_and_quote&quot;, nil, &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))), &quot;old_attributes_stringified&quot; =&gt; (Configurable.hash_to_string(<span class="user_input">Lead.find(params[:id])</span>.attributes)), &quot;quote&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span>.quotes.first or VQuoteHelper.lead_to_quote(<span class="user_input">Lead.find(params[:id])</span>))), &quot;quotes&quot; =&gt; (<span class="user_input">Lead.find(params[:id])</span>.quotes))</span><table id='context314' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>201</pre>
          </td>
          <td class='context'>
            <pre class='context'>      &lt;table id=&quot;leads_show_left_column&quot; style=&quot;margin: 0;&quot; border=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>203</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>204</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>206</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;%= render_partial 'leads/lead_and_quote', nil, 'lead' =&gt; @lead, 'old_attributes_stringified' =&gt; @old_attributes_stringified, 'quote' =&gt; @quote, 'quotes' =&gt; @quotes %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>209</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>210</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>211</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;%= render_partial 'leads/lead_inventory' -%&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context315');toggle('message315');toggle('full_message315')" ><span id='message315' style='display:block' >Unescaped model attribute near line 216: render_partial(&quot;workflow/tasks_events_multiform&quot;, &quot;lead&quot; =&gt; ...</span><span id='full_message315' style='display:none'>Unescaped model attribute near line 216: render_partial(&quot;workflow/tasks_events_multiform&quot;, &quot;lead&quot; =&gt; ((<span class="user_input">Lead.find(params[:id])</span> or Lead.find(<span class="user_input">Lead.find(params[:id])</span>.id))), &quot;event&quot; =&gt; ((Event.new({ :lead_id =&gt; (<span class="user_input">Lead.find(params[:id])</span>.id) }, nil) or session[:pending_event])))</span><table id='context315' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>211</pre>
          </td>
          <td class='context'>
            <pre class='context'>        &lt;%= render_partial 'leads/lead_inventory' -%&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>212</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>213</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>215</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;div style=&quot;width: 660px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>216</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= render_partial 'workflow/tasks_events_multiform', 'lead' =&gt; @lead, 'event' =&gt; @event_for_form %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>217</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>218</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>219</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>221</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        leads/show (LeadsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context316');toggle('message316');toggle('full_message316')" ><span id='message316' style='display:block' >Unescaped model attribute near line 225: render_partial(&quot;workflow/tasks_and_events&quot;, &quot;objects&quot; =&gt; (Le...</span><span id='full_message316' style='display:none'>Unescaped model attribute near line 225: render_partial(&quot;workflow/tasks_and_events&quot;, &quot;objects&quot; =&gt; (<span class="user_input">Lead.find(params[:id]).tasks</span>.select do  (local x).status.!=(&quot;complete&quot;)  end.concat(Lead.find(params[:id]).events).concat(Job.find(:all, :conditions =&gt; ([&quot;lead_id = ?&quot;, Lead.find(params[:id]).id])).concat(FixedpriceJob.find(:all, :conditions =&gt; ([&quot;lead_id = ?&quot;, Lead.find(params[:id]).id]))).concat(MiscJob.find(:all, :conditions =&gt; ([&quot;lead_id = ?&quot;, Lead.find(params[:id]).id])))).sort_by do  if ((local x).class == Event) then   (local x).created_on else   if ((local x).class == DnTask) then     (local x).start_time   else     (local x).move_date.to_time   end end  end.reverse), &quot;lead&quot; =&gt; ((Lead.find(params[:id]) or Lead.find(Lead.find(params[:id]).id))))</span><table id='context316' class='context' style='display:none'><caption>app/views/leads/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>221</pre>
          </td>
          <td class='context'>
            <pre class='context'>        &lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>222</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>223</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;table border=&quot;0&quot; cellpadding=&quot;0px&quot; cellspacing=&quot;0&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>224</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= render_partial 'workflow/tasks_and_events',</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>225</pre>
            </td>
            <td class='context'>
              <pre class='context'>                'objects' =&gt; @tasks_and_events,</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>226</pre>
            </td>
            <td class='context'>
              <pre class='context'>                'lead' =&gt; @lead %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>227</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>228</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>229</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        quotes/show_driving_timer
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context450');toggle('message450');toggle('full_message450')" ><span id='message450' style='display:block' >Unescaped model attribute near line 4: render_partial(&quot;quotes/driving_timer&quot;, &quot;lead&quot; =&gt; (Lead.find(:f...</span><span id='full_message450' style='display:none'>Unescaped model attribute near line 4: render_partial(&quot;quotes/driving_timer&quot;, &quot;lead&quot; =&gt; (<span class="user_input">Lead.find(:first)</span>))</span><table id='context450' class='context' style='display:none'><caption>app/views/quotes/show_driving_timer.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= render_partial 'quotes/driving_timer', 'lead' =&gt; Lead.find(:first) %&gt;</pre>
          </td>
        </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/all_companies_report (ReportsController#all_companies_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context342');toggle('message342');toggle('full_message342')" >Unescaped parameter value near line 4: pretty_date(Time.parse(<span class="user_input">params[&quot;start_date&quot;]</span>))<table id='context342' class='context' style='display:none'><caption>app/views/reports/all_companies_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h2&gt;Report on all companies&lt;/h2&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @cached %&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>note:  showing &lt;b&gt;leads received&lt;/b&gt; within &lt;%= pretty_date(@time1) %&gt; through &lt;%= pretty_date(@time2)%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table border=&quot;1px&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/all_companies_report (ReportsController#all_companies_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context343');toggle('message343');toggle('full_message343')" ><span id='message343' style='display:block' >Unescaped parameter value near line 11: sortable_th_link(&quot;total leads&quot;, &quot;reports&quot;, &quot;all_companies_rep...</span><span id='full_message343' style='display:none'>Unescaped parameter value near line 11: sortable_th_link(&quot;total leads&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, &quot;total leads&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total leads&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context343' class='context' style='display:none'><caption>app/views/reports/all_companies_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>7</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table border=&quot;1px&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('total leads', 'reports', 'all_companies_report', 'total leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('local', 'reports', 'all_companies_report', 'local', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('long-distance', 'reports', 'all_companies_report', 'long distance', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('duplicates', 'reports', 'all_companies_report', 'duplicates', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('unacceptable info', 'reports', 'all_companies_report', 'unacceptable info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('incomplete info', 'reports', 'all_companies_report', 'incomplete info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/all_companies_report (ReportsController#all_companies_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context344');toggle('message344');toggle('full_message344')" ><span id='message344' style='display:block' >Unescaped parameter value near line 12: sortable_th_link(&quot;local&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, ...</span><span id='full_message344' style='display:none'>Unescaped parameter value near line 12: sortable_th_link(&quot;local&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, &quot;local&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total leads&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context344' class='context' style='display:none'><caption>app/views/reports/all_companies_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>7</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table border=&quot;1px&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('total leads', 'reports', 'all_companies_report', 'total leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('local', 'reports', 'all_companies_report', 'local', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('long-distance', 'reports', 'all_companies_report', 'long distance', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('duplicates', 'reports', 'all_companies_report', 'duplicates', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('unacceptable info', 'reports', 'all_companies_report', 'unacceptable info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('incomplete info', 'reports', 'all_companies_report', 'incomplete info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('Booked Moves', 'reports', 'all_companies_report', 'booked moves', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/all_companies_report (ReportsController#all_companies_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context345');toggle('message345');toggle('full_message345')" ><span id='message345' style='display:block' >Unescaped parameter value near line 13: sortable_th_link(&quot;long-distance&quot;, &quot;reports&quot;, &quot;all_companies_r...</span><span id='full_message345' style='display:none'>Unescaped parameter value near line 13: sortable_th_link(&quot;long-distance&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, &quot;long distance&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total leads&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context345' class='context' style='display:none'><caption>app/views/reports/all_companies_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('total leads', 'reports', 'all_companies_report', 'total leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('local', 'reports', 'all_companies_report', 'local', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('long-distance', 'reports', 'all_companies_report', 'long distance', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('duplicates', 'reports', 'all_companies_report', 'duplicates', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('unacceptable info', 'reports', 'all_companies_report', 'unacceptable info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('incomplete info', 'reports', 'all_companies_report', 'incomplete info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('Booked Moves', 'reports', 'all_companies_report', 'booked moves', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'all_companies_report', 'booked moves percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/all_companies_report (ReportsController#all_companies_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context346');toggle('message346');toggle('full_message346')" ><span id='message346' style='display:block' >Unescaped parameter value near line 14: sortable_th_link(&quot;duplicates&quot;, &quot;reports&quot;, &quot;all_companies_repo...</span><span id='full_message346' style='display:none'>Unescaped parameter value near line 14: sortable_th_link(&quot;duplicates&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, &quot;duplicates&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total leads&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context346' class='context' style='display:none'><caption>app/views/reports/all_companies_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('total leads', 'reports', 'all_companies_report', 'total leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('local', 'reports', 'all_companies_report', 'local', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('long-distance', 'reports', 'all_companies_report', 'long distance', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('duplicates', 'reports', 'all_companies_report', 'duplicates', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('unacceptable info', 'reports', 'all_companies_report', 'unacceptable info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('incomplete info', 'reports', 'all_companies_report', 'incomplete info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('Booked Moves', 'reports', 'all_companies_report', 'booked moves', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'all_companies_report', 'booked moves percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/all_companies_report (ReportsController#all_companies_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context347');toggle('message347');toggle('full_message347')" ><span id='message347' style='display:block' >Unescaped parameter value near line 15: sortable_th_link(&quot;unacceptable info&quot;, &quot;reports&quot;, &quot;all_compani...</span><span id='full_message347' style='display:none'>Unescaped parameter value near line 15: sortable_th_link(&quot;unacceptable info&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, &quot;unacceptable info&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total leads&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context347' class='context' style='display:none'><caption>app/views/reports/all_companies_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>10</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th&gt;&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('total leads', 'reports', 'all_companies_report', 'total leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('local', 'reports', 'all_companies_report', 'local', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('long-distance', 'reports', 'all_companies_report', 'long distance', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('duplicates', 'reports', 'all_companies_report', 'duplicates', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('unacceptable info', 'reports', 'all_companies_report', 'unacceptable info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('incomplete info', 'reports', 'all_companies_report', 'incomplete info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('Booked Moves', 'reports', 'all_companies_report', 'booked moves', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'all_companies_report', 'booked moves percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/all_companies_report (ReportsController#all_companies_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context348');toggle('message348');toggle('full_message348')" ><span id='message348' style='display:block' >Unescaped parameter value near line 16: sortable_th_link(&quot;incomplete info&quot;, &quot;reports&quot;, &quot;all_companies...</span><span id='full_message348' style='display:none'>Unescaped parameter value near line 16: sortable_th_link(&quot;incomplete info&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, &quot;incomplete info&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total leads&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context348' class='context' style='display:none'><caption>app/views/reports/all_companies_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>11</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('total leads', 'reports', 'all_companies_report', 'total leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('local', 'reports', 'all_companies_report', 'local', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('long-distance', 'reports', 'all_companies_report', 'long distance', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('duplicates', 'reports', 'all_companies_report', 'duplicates', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('unacceptable info', 'reports', 'all_companies_report', 'unacceptable info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('incomplete info', 'reports', 'all_companies_report', 'incomplete info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('Booked Moves', 'reports', 'all_companies_report', 'booked moves', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'all_companies_report', 'booked moves percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/all_companies_report (ReportsController#all_companies_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context349');toggle('message349');toggle('full_message349')" ><span id='message349' style='display:block' >Unescaped parameter value near line 17: sortable_th_link(&quot;Booked Moves&quot;, &quot;reports&quot;, &quot;all_companies_re...</span><span id='full_message349' style='display:none'>Unescaped parameter value near line 17: sortable_th_link(&quot;Booked Moves&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, &quot;booked moves&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total leads&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context349' class='context' style='display:none'><caption>app/views/reports/all_companies_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>12</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('local', 'reports', 'all_companies_report', 'local', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('long-distance', 'reports', 'all_companies_report', 'long distance', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('duplicates', 'reports', 'all_companies_report', 'duplicates', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('unacceptable info', 'reports', 'all_companies_report', 'unacceptable info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('incomplete info', 'reports', 'all_companies_report', 'incomplete info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('Booked Moves', 'reports', 'all_companies_report', 'booked moves', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'all_companies_report', 'booked moves percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for datum in @data %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/all_companies_report (ReportsController#all_companies_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context350');toggle('message350');toggle('full_message350')" ><span id='message350' style='display:block' >Unescaped parameter value near line 18: sortable_th_link(&quot;%&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, &quot;boo...</span><span id='full_message350' style='display:none'>Unescaped parameter value near line 18: sortable_th_link(&quot;%&quot;, &quot;reports&quot;, &quot;all_companies_report&quot;, &quot;booked moves percent&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total leads&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context350' class='context' style='display:none'><caption>app/views/reports/all_companies_report.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>13</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('long-distance', 'reports', 'all_companies_report', 'long distance', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('duplicates', 'reports', 'all_companies_report', 'duplicates', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('unacceptable info', 'reports', 'all_companies_report', 'unacceptable info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('incomplete info', 'reports', 'all_companies_report', 'incomplete info', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('Booked Moves', 'reports', 'all_companies_report', 'booked moves', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'all_companies_report', 'booked moves percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for datum in @data %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/emails_to_lead_companies (ReportsController#emails_to_lead_companies)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context351');toggle('message351');toggle('full_message351')" >Unescaped parameter value near line 4: pretty_date(Time.parse(<span class="user_input">params[&quot;start_date&quot;]</span>))<table id='context351' class='context' style='display:none'><caption>app/views/reports/emails_to_lead_companies.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h2&gt;Report on emails sent to lead companies&lt;/h2&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @cached %&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>note:  showing &lt;b&gt;events recorded&lt;/b&gt; within &lt;%= pretty_date(@time1) %&gt; through &lt;%= pretty_date(@time2)%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table border=&quot;1px&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('lead company', 'reports', 'emails_to_lead_companies', 'lead company', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/emails_to_lead_companies (ReportsController#emails_to_lead_companies)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context352');toggle('message352');toggle('full_message352')" ><span id='message352' style='display:block' >Unescaped parameter value near line 9: sortable_th_link(&quot;lead company&quot;, &quot;reports&quot;, &quot;emails_to_lead_co...</span><span id='full_message352' style='display:none'>Unescaped parameter value near line 9: sortable_th_link(&quot;lead company&quot;, &quot;reports&quot;, &quot;emails_to_lead_companies&quot;, &quot;lead company&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;lead company&quot;), (params[:sort_reverse] or &quot;no&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context352' class='context' style='display:none'><caption>app/views/reports/emails_to_lead_companies.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>note:  showing &lt;b&gt;events recorded&lt;/b&gt; within &lt;%= pretty_date(@time1) %&gt; through &lt;%= pretty_date(@time2)%&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table border=&quot;1px&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('lead company', 'reports', 'emails_to_lead_companies', 'lead company', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('emails sent', 'reports', 'emails_to_lead_companies', 'emails sent', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/emails_to_lead_companies (ReportsController#emails_to_lead_companies)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context353');toggle('message353');toggle('full_message353')" ><span id='message353' style='display:block' >Unescaped parameter value near line 10: sortable_th_link(&quot;emails sent&quot;, &quot;reports&quot;, &quot;emails_to_lead_co...</span><span id='full_message353' style='display:none'>Unescaped parameter value near line 10: sortable_th_link(&quot;emails sent&quot;, &quot;reports&quot;, &quot;emails_to_lead_companies&quot;, &quot;emails sent&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;lead company&quot;), (params[:sort_reverse] or &quot;no&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context353' class='context' style='display:none'><caption>app/views/reports/emails_to_lead_companies.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>6</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table border=&quot;1px&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('lead company', 'reports', 'emails_to_lead_companies', 'lead company', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('emails sent', 'reports', 'emails_to_lead_companies', 'emails sent', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for datum in @data %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/event_log (ReportsController#event_log)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context354');toggle('message354');toggle('full_message354')" >Unescaped parameter value near line 5: pretty_date(Time.parse(<span class="user_input">params[&quot;start_date&quot;]</span>))<table id='context354' class='context' style='display:none'><caption>app/views/reports/event_log.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;!-- assumes events sorted by date, lowest first --&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if @events[0] == nil %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	no events in that date range: &lt;%= pretty_date(@time1) %&gt; to &lt;%= pretty_date(@time2) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% current_date = time_to_date(@events[0].created_on)  %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/event_log (ReportsController#event_log)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context355');toggle('message355');toggle('full_message355')" ><span id='message355' style='display:block' >Unescaped model attribute near line 34: pretty_date(time_to_date((Event.find(:all, :conditions =&gt; ([&quot;...</span><span id='full_message355' style='display:none'>Unescaped model attribute near line 34: pretty_date(time_to_date((<span class="user_input">Event.find(:all, :conditions =&gt; ([&quot;created_on &gt;= ? and created_on &lt; ?&quot;, ((Time.parse(params[&quot;start_date&quot;]).year.to_s + (Time.parse(params[&quot;start_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).month.to_s))) + (Time.parse(params[&quot;start_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).mday.to_s))), ((Time.parse(params[&quot;end_date&quot;]).year.to_s + (Time.parse(params[&quot;end_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).month.to_s))) + (Time.parse(params[&quot;end_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).mday.to_s)))])).sort_by</span> do  (local x).created_on  end or Event.find(:all, :conditions =&gt; ([&quot;created_on &gt;= ? and created_on &lt; ? and initiator_id = ?&quot;, ((Time.parse(params[&quot;start_date&quot;]).year.to_s + (Time.parse(params[&quot;start_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).month.to_s))) + (Time.parse(params[&quot;start_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).mday.to_s))), ((Time.parse(params[&quot;end_date&quot;]).year.to_s + (Time.parse(params[&quot;end_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).month.to_s))) + (Time.parse(params[&quot;end_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).mday.to_s))), params[:user_id]])).sort_by do  (local x).created_on  end)[0].created_on))</span><table id='context355' class='context' style='display:none'><caption>app/views/reports/event_log.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>31</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;event_log_day&quot; style=&quot;display: none;&quot; id=&quot;event_log_day_A_&lt;%= counter.to_s %&gt;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;a href=&quot;#&quot; onclick=&quot;Element.toggle('&lt;%= 'event_log_day_A_'+counter.to_s %&gt;'); Element.toggle('&lt;%= 'event_log_day_B_'+counter.to_s %&gt;');&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= pretty_date(current_date) %&gt; (&lt;%= this_days_events.size %&gt; events)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/a&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div class=&quot;event_log_day&quot; id=&quot;event_log_day_B_&lt;%= counter.to_s %&gt;&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/event_log (ReportsController#event_log)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context356');toggle('message356');toggle('full_message356')" ><span id='message356' style='display:block' >Unescaped model attribute near line 41: pretty_date(time_to_date((Event.find(:all, :conditions =&gt; ([&quot;...</span><span id='full_message356' style='display:none'>Unescaped model attribute near line 41: pretty_date(time_to_date((<span class="user_input">Event.find(:all, :conditions =&gt; ([&quot;created_on &gt;= ? and created_on &lt; ?&quot;, ((Time.parse(params[&quot;start_date&quot;]).year.to_s + (Time.parse(params[&quot;start_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).month.to_s))) + (Time.parse(params[&quot;start_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).mday.to_s))), ((Time.parse(params[&quot;end_date&quot;]).year.to_s + (Time.parse(params[&quot;end_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).month.to_s))) + (Time.parse(params[&quot;end_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).mday.to_s)))])).sort_by</span> do  (local x).created_on  end or Event.find(:all, :conditions =&gt; ([&quot;created_on &gt;= ? and created_on &lt; ? and initiator_id = ?&quot;, ((Time.parse(params[&quot;start_date&quot;]).year.to_s + (Time.parse(params[&quot;start_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).month.to_s))) + (Time.parse(params[&quot;start_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;start_date&quot;]).mday.to_s))), ((Time.parse(params[&quot;end_date&quot;]).year.to_s + (Time.parse(params[&quot;end_date&quot;]).month.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).month.to_s))) + (Time.parse(params[&quot;end_date&quot;]).mday.to_s or (&quot;0&quot; + Time.parse(params[&quot;end_date&quot;]).mday.to_s))), params[:user_id]])).sort_by do  (local x).created_on  end)[0].created_on))</span><table id='context356' class='context' style='display:none'><caption>app/views/reports/event_log.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>37</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;/div&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div class=&quot;event_log_day&quot; id=&quot;event_log_day_B_&lt;%= counter.to_s %&gt;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;font size=&quot;5&quot;&gt;&lt;b&gt;&lt;%= pretty_date(current_date) %&gt; &lt;/font&gt;&lt;font size=&quot;4&quot;&gt;(&lt;%= this_days_events.size %&gt; events)&lt;/b&gt;&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;a href=&quot;#&quot; onclick=&quot;Element.toggle('&lt;%= 'event_log_day_A_'+counter.to_s %&gt;'); Element.toggle('&lt;%= 'event_log_day_B_'+counter.to_s %&gt;');&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>		(+/-)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/a&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;br&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context357');toggle('message357');toggle('full_message357')" >Unescaped parameter value near line 5: pretty_date(Time.parse(<span class="user_input">params[&quot;start_date&quot;]</span>))<table id='context357' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h2&gt;Number of jobs by location&lt;/h2&gt;</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @cached %&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>note:  showing all records with &lt;b&gt;move date&lt;/b&gt; within &lt;%= pretty_date(@time1) %&gt; through &lt;%= pretty_date(@time2)%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table cellpadding=&quot;5px&quot; border=&quot;1&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th colspan=&quot;2&quot;&gt;Origin&lt;/th&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context358');toggle('message358');toggle('full_message358')" ><span id='message358' style='display:block' >Unescaped parameter value near line 15: sortable_th_link(&quot;City&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;locatio...</span><span id='full_message358' style='display:none'>Unescaped parameter value near line 15: sortable_th_link(&quot;City&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;location&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context358' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>10</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th colspan=&quot;2&quot;&gt;Origin&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th colspan=&quot;2&quot;&gt;Destination&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th colspan=&quot;2&quot;&gt;Both&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('City', 'reports', 'job_locations', 'location', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'orig_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'orig_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'orig_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context359');toggle('message359');toggle('full_message359')" ><span id='message359' style='display:block' >Unescaped parameter value near line 17: sortable_th_link(&quot;leads&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;orig_l...</span><span id='full_message359' style='display:none'>Unescaped parameter value near line 17: sortable_th_link(&quot;leads&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;orig_leads&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context359' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>12</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th colspan=&quot;2&quot;&gt;Both&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('City', 'reports', 'job_locations', 'location', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'orig_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'orig_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'orig_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'dest_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context360');toggle('message360');toggle('full_message360')" ><span id='message360' style='display:block' >Unescaped parameter value near line 19: sortable_th_link(&quot;booked&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;orig_...</span><span id='full_message360' style='display:none'>Unescaped parameter value near line 19: sortable_th_link(&quot;booked&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;orig_booked&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context360' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>14</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('City', 'reports', 'job_locations', 'location', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'orig_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'orig_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'orig_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'dest_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'dest_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context361');toggle('message361');toggle('full_message361')" ><span id='message361' style='display:block' >Unescaped parameter value near line 20: sortable_th_link(&quot;%&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;orig_booke...</span><span id='full_message361' style='display:none'>Unescaped parameter value near line 20: sortable_th_link(&quot;%&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;orig_booked_percent&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context361' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>15</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th&gt;&lt;%= sortable_th_link('City', 'reports', 'job_locations', 'location', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'orig_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'orig_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'orig_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'dest_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'dest_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'dest_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context362');toggle('message362');toggle('full_message362')" ><span id='message362' style='display:block' >Unescaped parameter value near line 22: sortable_th_link(&quot;leads&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;dest_l...</span><span id='full_message362' style='display:none'>Unescaped parameter value near line 22: sortable_th_link(&quot;leads&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;dest_leads&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context362' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>17</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'orig_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'orig_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'orig_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'dest_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'dest_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'dest_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'total_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context363');toggle('message363');toggle('full_message363')" ><span id='message363' style='display:block' >Unescaped parameter value near line 24: sortable_th_link(&quot;booked&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;dest_...</span><span id='full_message363' style='display:none'>Unescaped parameter value near line 24: sortable_th_link(&quot;booked&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;dest_booked&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context363' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>19</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'orig_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'orig_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'dest_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'dest_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'dest_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'total_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'total_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context364');toggle('message364');toggle('full_message364')" ><span id='message364' style='display:block' >Unescaped parameter value near line 25: sortable_th_link(&quot;%&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;dest_booke...</span><span id='full_message364' style='display:none'>Unescaped parameter value near line 25: sortable_th_link(&quot;%&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;dest_booked_percent&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context364' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>20</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'orig_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'dest_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'dest_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'dest_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'total_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'total_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'total_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context365');toggle('message365');toggle('full_message365')" ><span id='message365' style='display:block' >Unescaped parameter value near line 27: sortable_th_link(&quot;leads&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;total_...</span><span id='full_message365' style='display:none'>Unescaped parameter value near line 27: sortable_th_link(&quot;leads&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;total_leads&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context365' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>22</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'dest_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'dest_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'dest_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'total_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'total_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'total_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context366');toggle('message366');toggle('full_message366')" ><span id='message366' style='display:block' >Unescaped parameter value near line 29: sortable_th_link(&quot;booked&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;total...</span><span id='full_message366' style='display:none'>Unescaped parameter value near line 29: sortable_th_link(&quot;booked&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;total_booked&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context366' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>24</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'dest_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'dest_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'total_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'total_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'total_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for datum in @data %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/job_locations (ReportsController#job_locations)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context367');toggle('message367');toggle('full_message367')" ><span id='message367' style='display:block' >Unescaped parameter value near line 30: sortable_th_link(&quot;%&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;total_book...</span><span id='full_message367' style='display:none'>Unescaped parameter value near line 30: sortable_th_link(&quot;%&quot;, &quot;reports&quot;, &quot;job_locations&quot;, &quot;total_booked_percent&quot;, (<span class="user_input">params[:sort_by]</span> or &quot;total_booked&quot;), (params[:sort_reverse] or &quot;yes&quot;), &quot;start_date&quot; =&gt; (params[&quot;start_date&quot;]), &quot;end_date&quot; =&gt; (params[&quot;end_date&quot;]))</span><table id='context367' class='context' style='display:none'><caption>app/views/reports/job_locations.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>25</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'dest_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;&lt;%= sortable_th_link('leads', 'reports', 'job_locations', 'total_leads', @sort_by, @sort_reverse, @extra_params) %&gt;&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;&lt;i&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('booked', 'reports', 'job_locations', 'total_booked', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= sortable_th_link('%', 'reports', 'job_locations', 'total_booked_percent', @sort_by, @sort_reverse, @extra_params) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/i&gt;&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for datum in @data %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/jobs_by_crew_size (ReportsController#jobs_by_crew_size)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context368');toggle('message368');toggle('full_message368')" >Unescaped parameter value near line 2: pretty_date(Time.parse(<span class="user_input">params[&quot;start_date&quot;]</span>))<table id='context368' class='context' style='display:none'><caption>app/views/reports/jobs_by_crew_size.rhtml</caption>        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h2&gt;Jobs by Crew Size&lt;/h2&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>period from &lt;%= pretty_date(@time1) %&gt; through &lt;%= pretty_date(@time2) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table border=&quot;1&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;&lt;th&gt;crew size&lt;/th&gt;&lt;th&gt;leads&lt;/th&gt;&lt;th&gt;&lt;font color=&quot;green&quot;&gt;booked&lt;/font&gt;&lt;/th&gt;&lt;/tr&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/lead_company_report (ReportsController#lead_company_report)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context370');toggle('message370');toggle('full_message370')" >Unescaped parameter value near line 2: pretty_date(Time.parse(<span class="user_input">params[&quot;start_date&quot;]</span>))<table id='context370' class='context' style='display:none'><caption>app/views/reports/lead_company_report.rhtml</caption>        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h2&gt;Company Report for &lt;%= @company.name %&gt;&lt;/h2&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>period:  &lt;%= pretty_date(@time1) %&gt; through &lt;%= pretty_date(@time2) %&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;table border=&quot;1px&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/users_events (ReportsController#users_events)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context372');toggle('message372');toggle('full_message372')" >Unescaped parameter value near line 2: pretty_date(Time.parse(<span class="user_input">params[&quot;start_date&quot;]</span>))<table id='context372' class='context' style='display:none'><caption>app/views/reports/users_events.rhtml</caption>        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h2&gt;Event Counts per User&lt;/h2&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>period:  &lt;b&gt;&lt;%= pretty_date(@time1) %&gt;&lt;/b&gt; through &lt;b&gt;&lt;%= pretty_date(@time2) %&gt;&lt;/b&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;width: 800px; text-align: left;&quot;&gt;	</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        reports/users_statuses (ReportsController#users_statuses)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context375');toggle('message375');toggle('full_message375')" >Unescaped parameter value near line 5: pretty_date(Time.parse(<span class="user_input">params[&quot;start_date&quot;]</span>))<table id='context375' class='context' style='display:none'><caption>app/views/reports/users_statuses.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h2&gt;Statuses Set by Users&lt;/h2&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>(any given lead is only counted once)&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @cached %&gt;&lt;br/&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>note:  counting all leads with &lt;b&gt;status change&lt;/b&gt; between &lt;%= pretty_date(@time1) %&gt; and &lt;%= pretty_date(@time2)%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div style=&quot;text-align: left; margin: 50px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for d in @data %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        sent_emails/show (SentEmailsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context383');toggle('message383');toggle('full_message383')" ><span id='message383' style='display:block' >Unescaped model attribute near line 13: render_partial(&quot;sent_emails/sent_email_show&quot;, &quot;sent_email&quot; =&gt;...</span><span id='full_message383' style='display:none'>Unescaped model attribute near line 13: render_partial(&quot;sent_emails/sent_email_show&quot;, &quot;sent_email&quot; =&gt; (<span class="user_input">SentEmail.find(params[:id])</span>))</span><table id='context383' class='context' style='display:none'><caption>app/views/sent_emails/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>10</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div style=&quot;width: 800px; margin: auto;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'sent_emails/sent_email_show', 'sent_email' =&gt; @sent_email %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;center&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        service_locations/edit (ServiceLocationsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context385');toggle('message385');toggle('full_message385')" ><span id='message385' style='display:block' >Unescaped model attribute near line 5: render_partial(&quot;service_locations/service_locations_javascript...</span><span id='full_message385' style='display:none'>Unescaped model attribute near line 5: render_partial(&quot;service_locations/service_locations_javascript&quot;, &quot;taken_states&quot; =&gt; (<span class="user_input">ServiceLocation.find(:all, :conditions =&gt; ([&quot;id &lt;&gt; ?&quot;, ServiceLocation.find(params[:id]).id])).map</span> do  (local x).service_area  end.flatten))</span><table id='context385' class='context' style='display:none'><caption>app/views/service_locations/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;Editing Service Location: &lt;%= @service_location.name %&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= error_messages_for :service_location %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'service_locations/service_locations_javascript', 'taken_states' =&gt; @taken_states %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:service_location, @service_location, :url =&gt; service_location_path(@service_location), :html =&gt; { :method =&gt; :put }) do |f| %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/_edit_signature
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context451');toggle('message451');toggle('full_message451')" ><span id='message451' style='display:block' >Unescaped model attribute near line 12: (local f).text_field(:fingerprint1, :value =&gt; (ExtractorEleme...</span><span id='full_message451' style='display:none'>Unescaped model attribute near line 12: (local f).text_field(:fingerprint1, :value =&gt; (<span class="user_input">ExtractorElement.regex_un_literal(signature.fingerprint1.to_s)</span>), :size =&gt; 60)</span><table id='context451' class='context' style='display:none'><caption>app/views/signatures/_edit_signature.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>8</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;signature&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 1:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint1, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint1.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 2:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint2, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint2.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/_edit_signature
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context452');toggle('message452');toggle('full_message452')" ><span id='message452' style='display:block' >Unescaped model attribute near line 15: (local f).text_field(:fingerprint2, :value =&gt; (ExtractorEleme...</span><span id='full_message452' style='display:none'>Unescaped model attribute near line 15: (local f).text_field(:fingerprint2, :value =&gt; (<span class="user_input">ExtractorElement.regex_un_literal(signature.fingerprint2.to_s)</span>), :size =&gt; 60)</span><table id='context452' class='context' style='display:none'><caption>app/views/signatures/_edit_signature.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>10</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 1:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint1, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint1.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 2:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint2, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint2.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint3, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint3.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 4:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/_edit_signature
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context453');toggle('message453');toggle('full_message453')" ><span id='message453' style='display:block' >Unescaped model attribute near line 18: (local f).text_field(:fingerprint3, :value =&gt; (ExtractorEleme...</span><span id='full_message453' style='display:none'>Unescaped model attribute near line 18: (local f).text_field(:fingerprint3, :value =&gt; (<span class="user_input">ExtractorElement.regex_un_literal(signature.fingerprint3.to_s)</span>), :size =&gt; 60)</span><table id='context453' class='context' style='display:none'><caption>app/views/signatures/_edit_signature.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>13</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 2:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint2, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint2.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint3, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint3.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 4:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint4, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint4.to_s), :size =&gt; 60 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/_edit_signature
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context454');toggle('message454');toggle('full_message454')" ><span id='message454' style='display:block' >Unescaped model attribute near line 21: (local f).text_field(:fingerprint4, :value =&gt; (ExtractorEleme...</span><span id='full_message454' style='display:none'>Unescaped model attribute near line 21: (local f).text_field(:fingerprint4, :value =&gt; (<span class="user_input">ExtractorElement.regex_un_literal(signature.fingerprint4.to_s)</span>), :size =&gt; 60)</span><table id='context454' class='context' style='display:none'><caption>app/views/signatures/_edit_signature.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>16</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint3, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint3.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 4:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint4, :value =&gt; ExtractorElement.regex_un_literal(signature.fingerprint4.to_s), :size =&gt; 60 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td align=&quot;right&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/edit
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context459');toggle('message459');toggle('full_message459')" ><span id='message459' style='display:block' >Unescaped model attribute near line 38: (local f).text_field(:fingerprint1, :value =&gt; (ExtractorEleme...</span><span id='full_message459' style='display:none'>Unescaped model attribute near line 38: (local f).text_field(:fingerprint1, :value =&gt; (<span class="user_input">ExtractorElement.regex_un_literal(@signature.fingerprint1.to_s)</span>), :size =&gt; 60)</span><table id='context459' class='context' style='display:none'><caption>app/views/signatures/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>34</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;signature&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 1:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint1, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint1.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 2:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint2, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint2.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/edit
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context460');toggle('message460');toggle('full_message460')" ><span id='message460' style='display:block' >Unescaped model attribute near line 41: (local f).text_field(:fingerprint2, :value =&gt; (ExtractorEleme...</span><span id='full_message460' style='display:none'>Unescaped model attribute near line 41: (local f).text_field(:fingerprint2, :value =&gt; (<span class="user_input">ExtractorElement.regex_un_literal(@signature.fingerprint2.to_s)</span>), :size =&gt; 60)</span><table id='context460' class='context' style='display:none'><caption>app/views/signatures/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>36</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 1:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint1, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint1.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 2:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint2, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint2.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint3, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint3.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 4:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/edit
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context461');toggle('message461');toggle('full_message461')" ><span id='message461' style='display:block' >Unescaped model attribute near line 44: (local f).text_field(:fingerprint3, :value =&gt; (ExtractorEleme...</span><span id='full_message461' style='display:none'>Unescaped model attribute near line 44: (local f).text_field(:fingerprint3, :value =&gt; (<span class="user_input">ExtractorElement.regex_un_literal(@signature.fingerprint3.to_s)</span>), :size =&gt; 60)</span><table id='context461' class='context' style='display:none'><caption>app/views/signatures/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 2:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint2, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint2.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint3, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint3.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 4:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint4, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint4.to_s), :size =&gt; 60 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/edit
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context462');toggle('message462');toggle('full_message462')" ><span id='message462' style='display:block' >Unescaped model attribute near line 47: (local f).text_field(:fingerprint4, :value =&gt; (ExtractorEleme...</span><span id='full_message462' style='display:none'>Unescaped model attribute near line 47: (local f).text_field(:fingerprint4, :value =&gt; (<span class="user_input">ExtractorElement.regex_un_literal(@signature.fingerprint4.to_s)</span>), :size =&gt; 60)</span><table id='context462' class='context' style='display:none'><caption>app/views/signatures/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>42</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;/tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 3:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint3, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint3.to_s), :size =&gt; 60  %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Fingerprint 4:&lt;/span&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.text_field :fingerprint4, :value =&gt; ExtractorElement.regex_un_literal(@signature.fingerprint4.to_s), :size =&gt; 60 %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table width=&quot;100%&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;&lt;td align=&quot;right&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/show (SignaturesController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context386');toggle('message386');toggle('full_message386')" ><span id='message386' style='display:block' >Unescaped model attribute near line 8: render_partial(&quot;signatures/show_signature&quot;, &quot;signature&quot; =&gt; (Si...</span><span id='full_message386' style='display:none'>Unescaped model attribute near line 8: render_partial(&quot;signatures/show_signature&quot;, &quot;signature&quot; =&gt; (<span class="user_input">Signature.find(params[:id])</span>))</span><table id='context386' class='context' style='display:none'><caption>app/views/signatures/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;hr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'undigestible_emails/instructions_and_label', 'label' =&gt; 'Signature', 'instructions' =&gt; @instructions %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'signatures/show_signature', 'signature' =&gt; @signature %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        sms_templates/edit
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context463');toggle('message463');toggle('full_message463')" ><span id='message463' style='display:block' >Unescaped model attribute near line 30: (local f).select(:purpose, Event.allowable_attribute_values[&quot;...</span><span id='full_message463' style='display:none'>Unescaped model attribute near line 30: (local f).select(:purpose, <span class="user_input">Event.allowable_attribute_values[&quot;purpose&quot;]</span>)</span><table id='context463' class='context' style='display:none'><caption>app/views/sms_templates/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>26</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;Purpose&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.select :purpose, Event.allowable_attribute_values['purpose'] %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;Outcomes&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        sms_templates/new
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context464');toggle('message464');toggle('full_message464')" ><span id='message464' style='display:block' >Unescaped model attribute near line 31: (local f).select(:purpose, Event.allowable_attribute_values[&quot;...</span><span id='full_message464' style='display:none'>Unescaped model attribute near line 31: (local f).select(:purpose, <span class="user_input">Event.allowable_attribute_values[&quot;purpose&quot;]</span>)</span><table id='context464' class='context' style='display:none'><caption>app/views/sms_templates/new.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>27</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;/td&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;Purpose&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= f.select :purpose, Event.allowable_attribute_values['purpose'] %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;Outcomes&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        task_management_rules/index (TaskManagementRulesController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context389');toggle('message389');toggle('full_message389')" ><span id='message389' style='display:block' >Unescaped model attribute near line 6: render_partial(&quot;task_management_rules/task_management_rule&quot;, &quot;...</span><span id='full_message389' style='display:none'>Unescaped model attribute near line 6: render_partial(&quot;task_management_rules/task_management_rule&quot;, &quot;tmr&quot; =&gt; (<span class="user_input">TaskManagementRule.new</span>), &quot;email_templates&quot; =&gt; (EmailTemplate.find(:all)))</span><table id='context389' class='context' style='display:none'><caption>app/views/task_management_rules/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;Task Management&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h2&gt;current rules&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% @task_management_rules.each do |tmr| %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;div class=&quot;task_management_rule&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'task_management_rules/task_management_rule', 'tmr' =&gt; tmr, 'email_templates' =&gt; @email_templates %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= link_to 'New task_management_rule', new_task_management_rule_path %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        task_templates/index (TaskTemplatesController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context391');toggle('message391');toggle('full_message391')" ><span id='message391' style='display:block' >Unescaped model attribute near line 29: render_partial(&quot;task_templates/list&quot;, &quot;task_templates&quot; =&gt; (Ta...</span><span id='full_message391' style='display:none'>Unescaped model attribute near line 29: render_partial(&quot;task_templates/list&quot;, &quot;task_templates&quot; =&gt; (<span class="user_input">TaskTemplate.find(:all, :conditions =&gt; ([&quot;task_management_rule_id = ?&quot;, params[:task_management_rule_id]]))</span>))</span><table id='context391' class='context' style='display:none'><caption>app/views/task_templates/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>24</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;%= submit_tag 'Create' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;task_templates&quot;&gt;	</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'task_templates/list', 'task_templates' =&gt; @task_templates %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/_edit_SendemailTask
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context466');toggle('message466');toggle('full_message466')" ><span id='message466' style='display:block' >Unescaped model attribute near line 47: render_partial(&quot;quotes/quote_selector&quot;, &quot;input_name&quot; =&gt; &quot;task...</span><span id='full_message466' style='display:none'>Unescaped model attribute near line 47: render_partial(&quot;quotes/quote_selector&quot;, &quot;input_name&quot; =&gt; &quot;task_params[quote_id]&quot;, &quot;selected_id&quot; =&gt; (task.dn_email.quote_id), &quot;quotes&quot; =&gt; (<span class="user_input">Quote.find(:all, :conditions =&gt; ([&quot;lead_id = ?&quot;, task.lead_id])).sort_by</span> do  (local x).created_on  end.reverse))</span><table id='context466' class='context' style='display:none'><caption>app/views/tasks/_edit_SendemailTask.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>43</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Quote&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;div class=&quot;quote_selector_div&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;%= render_partial 'quotes/quote_selector', 'input_name' =&gt; 'task_params[quote_id]', 'selected_id' =&gt; task.dn_email.quote_id, 'quotes' =&gt; Quote.find(:all, :conditions =&gt; [&quot;lead_id = ?&quot;, task.lead_id]).sort_by{|x| x.created_on}.reverse %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Email Template&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= select_tag 'task_params[email_template_id]', </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>					options_for_select(EmailTemplate.find(:all).sort_by{|e| e.order}.map{|e| [e.name.slice(0, 29), e.id.to_s]}, task.dn_email.email_template_id.to_s)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/_edit_SmsTask
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context467');toggle('message467');toggle('full_message467')" ><span id='message467' style='display:block' >Unescaped model attribute near line 61: render_partial(&quot;quotes/quote_selector&quot;, &quot;input_name&quot; =&gt; &quot;task...</span><span id='full_message467' style='display:none'>Unescaped model attribute near line 61: render_partial(&quot;quotes/quote_selector&quot;, &quot;input_name&quot; =&gt; &quot;task_params[quote_id]&quot;, &quot;selected_id&quot; =&gt; (task.parameters[&quot;quote_id&quot;]), &quot;quotes&quot; =&gt; (<span class="user_input">Quote.find(:all, :conditions =&gt; ([&quot;lead_id = ?&quot;, task.lead_id])).sort_by</span> do  (local x).created_on  end.reverse))</span><table id='context467' class='context' style='display:none'><caption>app/views/tasks/_edit_SmsTask.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>56</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size = &quot;1&quot;&gt;&lt;b&gt;Phone&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= select_tag 'task_params[sms_phone]', options_for_select([[task.lead.phone1.to_s, task.lead.phone1.to_s], [task.lead.phone2.to_s, task.lead.phone2.to_s], [task.lead.phone3.to_s, task.lead.phone3.to_s]], task.parameters['sms_phone'])%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Quote&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;div class=&quot;quote_selector_div&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;%= render_partial 'quotes/quote_selector', 'input_name' =&gt; 'task_params[quote_id]', 'selected_id' =&gt; task.parameters['quote_id'], 'quotes' =&gt; Quote.find(:all, :conditions =&gt; [&quot;lead_id = ?&quot;, task.lead_id]).sort_by{|x| x.created_on}.reverse %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;SMS Template&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= select_tag 'task_params[sms_template_id]', </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>					options_for_select(SmsTemplate.find(:all).sort_by{|e| e.order}.map{|e| [e.name.slice(0, 29), e.id.to_s]}, task.parameters['sms_template_id'].to_s)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/_new_SendemailTask
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context468');toggle('message468');toggle('full_message468')" ><span id='message468' style='display:block' >Unescaped model attribute near line 59: render_partial(&quot;quotes/quote_selector&quot;, &quot;input_name&quot; =&gt; &quot;task...</span><span id='full_message468' style='display:none'>Unescaped model attribute near line 59: render_partial(&quot;quotes/quote_selector&quot;, &quot;input_name&quot; =&gt; &quot;task_params[quote_id]&quot;, &quot;selected_id&quot; =&gt; (task.parameters[&quot;quote_id&quot;]), &quot;quotes&quot; =&gt; (<span class="user_input">Quote.find(:all, :conditions =&gt; ([&quot;lead_id = ?&quot;, task.lead_id])).sort_by</span> do  (local x).created_on  end.reverse))</span><table id='context468' class='context' style='display:none'><caption>app/views/tasks/_new_SendemailTask.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>55</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;table&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Quote&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;div class=&quot;quote_selector_div&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= render_partial 'quotes/quote_selector', 'input_name' =&gt; 'task_params[quote_id]', 'selected_id' =&gt; task.parameters['quote_id'], 'quotes' =&gt; Quote.find(:all, :conditions =&gt; [&quot;lead_id = ?&quot;, task.lead_id]).sort_by{|x| x.created_on}.reverse %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Email Template&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= select_tag 'task_params[email_template_id]', </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>				options_for_select(EmailTemplate.find(:all).sort_by{|e| e.order}.map{|e| [e.name.slice(0, 29), e.id.to_s]}, task.parameters['email_template_id'].to_s)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/_new_SmsTask
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context469');toggle('message469');toggle('full_message469')" ><span id='message469' style='display:block' >Unescaped model attribute near line 56: render_partial(&quot;quotes/quote_selector&quot;, &quot;input_name&quot; =&gt; &quot;task...</span><span id='full_message469' style='display:none'>Unescaped model attribute near line 56: render_partial(&quot;quotes/quote_selector&quot;, &quot;input_name&quot; =&gt; &quot;task_params[quote_id]&quot;, &quot;selected_id&quot; =&gt; (task.parameters[&quot;quote_id&quot;]), &quot;quotes&quot; =&gt; (<span class="user_input">Quote.find(:all, :conditions =&gt; ([&quot;lead_id = ?&quot;, task.lead_id])).sort_by</span> do  (local x).created_on  end.reverse))</span><table id='context469' class='context' style='display:none'><caption>app/views/tasks/_new_SmsTask.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>51</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size = &quot;1&quot;&gt;&lt;b&gt;Phone&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= select_tag 'task_params[sms_phone]', options_for_select([[task.lead.phone1.to_s, task.lead.phone1.to_s], [task.lead.phone2.to_s, task.lead.phone2.to_s], [task.lead.phone3.to_s, task.lead.phone3.to_s]], task.parameters['sms_phone'])%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Quote&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;div class=&quot;quote_selector_div&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= render_partial 'quotes/quote_selector', 'input_name' =&gt; 'task_params[quote_id]', 'selected_id' =&gt; task.parameters['quote_id'], 'quotes' =&gt; Quote.find(:all, :conditions =&gt; [&quot;lead_id = ?&quot;, task.lead_id]).sort_by{|x| x.created_on}.reverse %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;SMS Template&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= select_tag 'task_params[sms_template_id]', </pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>				options_for_select(SmsTemplate.find(:all).sort_by{|e| e.order}.map{|e| [e.name.slice(0, 29), e.id.to_s]}, task.parameters['sms_template_id'].to_s)</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/_task_show_SmsTask
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context471');toggle('message471');toggle('full_message471')" >Unescaped model attribute near line 34: <span class="user_input">Quote.find(task.parameters[&quot;quote_id&quot;])</span><table id='context471' class='context' style='display:none'><caption>app/views/tasks/_task_show_SmsTask.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>29</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Phone&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= task.parameters['sms_phone'] %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Quote&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= quote = Quote.find(task.parameters['quote_id']) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= pretty_datetime_short(quote.created_on)+' $'+quote.smart_price.to_i.to_s %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td valign=&quot;top&quot;&gt;&lt;font color=&quot;blue&quot; size=&quot;1&quot;&gt;&lt;b&gt;Sms Template&lt;/b&gt;&lt;/font&gt;&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= SmsTemplate.find(task.parameters['sms_template_id']).name %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/_task_show_minimized
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context474');toggle('message474');toggle('full_message474')" ><span id='message474' style='display:block' >Unescaped model attribute near line 69: preview(SmsTemplate.find(task.parameters[&quot;sms_template_id&quot;])....</span><span id='full_message474' style='display:none'>Unescaped model attribute near line 69: preview(<span class="user_input">SmsTemplate.find(task.parameters[&quot;sms_template_id&quot;]).name</span>, 40)</span><table id='context474' class='context' style='display:none'><caption>app/views/tasks/_task_show_minimized.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>64</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;div style=&quot;float: left; align: left;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span style=&quot;background-color: lightgrey; color: blue; border: solid thin blue; font-weight: bold; padding: 1px 3px;&quot;&gt;T&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span class=&quot;task_incomplete_due_at&quot;&gt;&lt;%= pretty_datetime_short(task.start_time) %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span class=&quot;user_firstname&quot;&gt;&lt;%= task.assigned_to_user_firstname %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span style=&quot;&quot;&gt;&lt;%= task.parameters['sms_phone'] %&gt;: &lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;span style=&quot;&quot;&gt;&lt;%= preview(SmsTemplate.find(task.parameters['sms_template_id']).name, 40) %&gt;&lt;/span&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;div style=&quot;float: right; align: right;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= link_to_remote 'cancel', :url =&gt; {:controller =&gt; 'tasks', :action =&gt; 'cancel',</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/edit_email_old
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context475');toggle('message475');toggle('full_message475')" ><span id='message475' style='display:block' >Unescaped model attribute near line 39: render_partial(&quot;email_templates/sendable_email_form_fields&quot;, ...</span><span id='full_message475' style='display:none'>Unescaped model attribute near line 39: render_partial(&quot;email_templates/sendable_email_form_fields&quot;, &quot;lead&quot; =&gt; (@task.lead), &quot;email_template&quot; =&gt; (<span class="user_input">EmailTemplate.find(@task.parameters[&quot;email_template_id&quot;])</span>), &quot;user&quot; =&gt; (@task.assigned_to_user), &quot;quote&quot; =&gt; (Quote.find(@task.parameters[&quot;quote_id&quot;])), &quot;subject&quot; =&gt; (@task.parameters[&quot;subject&quot;]), &quot;bodyhash&quot; =&gt; (@task.parameters[&quot;bodyhash&quot;]), &quot;to&quot; =&gt; (@task.parameters[&quot;to&quot;]), &quot;cc&quot; =&gt; (@task.parameters[&quot;cc&quot;]), &quot;bcc&quot; =&gt; (@task.parameters[&quot;bcc&quot;]), &quot;meta_prefix&quot; =&gt; &quot;email_update&quot;, &quot;prefix&quot; =&gt; &quot;manual_bodyhash&quot;, &quot;include_preview_send&quot; =&gt; (false), &quot;already_checked&quot; =&gt; (@task.parameters[&quot;email_attachment_ids&quot;].to_a.map do  (local x).to_i  end))</span><table id='context475' class='context' style='display:none'><caption>app/views/tasks/edit_email_old.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>34</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;%= hidden_field_tag 'task_params[purpose]', @task.parameters['purpose'] %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= hidden_field_tag 'task_params[user_id]', @task.parameters['user_id'] %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'email_templates/sendable_email_form_fields', </pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'lead' =&gt; @task.lead, </pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'email_template' =&gt; EmailTemplate.find(@task.parameters['email_template_id']), </pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'user' =&gt; @task.assigned_to_user,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'quote' =&gt; Quote.find(@task.parameters['quote_id']),</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'subject' =&gt; @task.parameters['subject'],</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'bodyhash' =&gt; @task.parameters['bodyhash'],</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'to' =&gt; @task.parameters['to'],</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/email_preview (TasksController#email_preview)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context394');toggle('message394');toggle('full_message394')" ><span id='message394' style='display:block' >Unescaped model attribute near line 4: render_partial(&quot;dn_emails/preview&quot;, &quot;tmail&quot; =&gt; (DnEmail.find(p...</span><span id='full_message394' style='display:none'>Unescaped model attribute near line 4: render_partial(&quot;dn_emails/preview&quot;, &quot;tmail&quot; =&gt; (<span class="user_input">DnEmail.find(params[:dn_email_id]).to_tmail</span>))</span><table id='context394' class='context' style='display:none'><caption>app/views/tasks/email_preview.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div id=&quot;dn_email&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'dn_emails/preview', 'tmail' =&gt; @dn_email.to_tmail %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;center&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td width=&quot;100px&quot; align=&quot;center&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/index (TasksController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context399');toggle('message399');toggle('full_message399')" ><span id='message399' style='display:block' >Unescaped parameter value near line 27: render_partial(&quot;tasks/task_list_form&quot;, &quot;assigned_to_id&quot; =&gt; ((...</span><span id='full_message399' style='display:none'>Unescaped parameter value near line 27: render_partial(&quot;tasks/task_list_form&quot;, &quot;assigned_to_id&quot; =&gt; ((((session[:user].id or if <span class="user_input">params[:assigned_to_id]</span>.nil? then   session[:user].id else   <span class="user_input">params[:assigned_to_id]</span> end) or nil) or if <span class="user_input">params[:assigned_to_id]</span>.nil? then   session[:user].id else   <span class="user_input">params[:assigned_to_id]</span> end)))</span><table id='context399' class='context' style='display:none'><caption>app/views/tasks/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>22</pre>
          </td>
          <td class='context'>
            <pre class='context'>					&lt;/span&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td valign=&quot;bottom&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;div class=&quot;task_show_incomplete&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>					&lt;%= render_partial 'tasks/task_list_form', 'assigned_to_id' =&gt; @assigned_to_id %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/table&gt;	</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/index (TasksController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context400');toggle('message400');toggle('full_message400')" ><span id='message400' style='display:block' >Unescaped model attribute near line 37: render_partial(&quot;tasks/tasks_as_table&quot;, &quot;tasks&quot; =&gt; (DnTask.get...</span><span id='full_message400' style='display:none'>Unescaped model attribute near line 37: render_partial(&quot;tasks/tasks_as_table&quot;, &quot;tasks&quot; =&gt; (<span class="user_input">DnTask.get_tasks_by_listname((((&quot;all tasks&quot; or params[:listname]) or nil.nil? ? (&quot;all tasks&quot;) : (session[:listname1])) or params[:listname].nil? ? (&quot;all tasks&quot;) : (params[:listname])), (params[:page].nil? ? (1) : (params[:page])), &quot;task_flavor&quot; =&gt; ((((&quot;all&quot; or params[:task_flavor]) or nil) or params[:task_flavor].nil? ? (&quot;all&quot;) : (params[:task_flavor]))), &quot;sort_by&quot; =&gt; ((((&quot;start_time&quot; or params[:sort_by].nil? ? (&quot;start_time&quot;) : (params[:sort_by])) or nil) or params[:sort_by].nil? ? (&quot;start_time&quot;) : (params[:sort_by]))), &quot;assigned_to_id&quot; =&gt; ((((session[:user].id or if params[:assigned_to_id].nil? then   session[:user].id else   params[:assigned_to_id] end) or nil) or if params[:assigned_to_id].nil? then   session[:user].id else   params[:assigned_to_id] end)), &quot;sort_style&quot; =&gt; ((((&quot;ASC&quot; or params[:sort_style].nil? ? (&quot;ASC&quot;) : (params[:sort_style])) or nil) or params[:sort_style].nil? ? (&quot;ASC&quot;) : (params[:sort_style]))))</span>), &quot;sort_by&quot; =&gt; ((((&quot;start_time&quot; or params[:sort_by].nil? ? (&quot;start_time&quot;) : (params[:sort_by])) or nil) or params[:sort_by].nil? ? (&quot;start_time&quot;) : (params[:sort_by]))), &quot;reverse&quot; =&gt; ((((&quot;ASC&quot; or params[:sort_style].nil? ? (&quot;ASC&quot;) : (params[:sort_style])) or nil) or params[:sort_style].nil? ? (&quot;ASC&quot;) : (params[:sort_style]))), &quot;task_flavor&quot; =&gt; ((((&quot;all&quot; or params[:task_flavor]) or nil) or params[:task_flavor].nil? ? (&quot;all&quot;) : (params[:task_flavor]))), &quot;assigned_to_id&quot; =&gt; ((((session[:user].id or if params[:assigned_to_id].nil? then   session[:user].id else   params[:assigned_to_id] end) or nil) or if params[:assigned_to_id].nil? then   session[:user].id else   params[:assigned_to_id] end)), &quot;listname&quot; =&gt; ((((&quot;all tasks&quot; or params[:listname]) or nil.nil? ? (&quot;all tasks&quot;) : (session[:listname1])) or params[:listname].nil? ? (&quot;all tasks&quot;) : (params[:listname]))))</span><table id='context400' class='context' style='display:none'><caption>app/views/tasks/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;/div&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'tasks/tasks_as_table', </pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'tasks' =&gt; @tasks,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'sort_by' =&gt; @sort_by,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'reverse' =&gt; @sort_style,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'task_flavor' =&gt; @task_flavor,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'assigned_to_id' =&gt; @assigned_to_id,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'listname' =&gt; @listname</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/tasks_for_lead (TasksController#tasks_for_lead)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context402');toggle('message402');toggle('full_message402')" >Unescaped model attribute near line 4: pretty_date(<span class="user_input">Lead.find(params[:lead_id]).move_date</span>)<table id='context402' class='context' style='display:none'><caption>app/views/tasks/tasks_for_lead.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;h1&gt;Tasks for Lead Number &lt;%= @lead.id.to_s %&gt;: &lt;%= @lead.fullname %&gt;&lt;/h1&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;h2&gt;moving on &lt;%= pretty_date(@lead.move_date) %&gt;&lt;/h2&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'tasks/task_list', </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'my_div_id' =&gt; 'lead_tasks_page_tasks_list',</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'task_list_style' =&gt; 'background-color: red;',</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        tasks/tasks_for_lead (TasksController#tasks_for_lead)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context403');toggle('message403');toggle('full_message403')" ><span id='message403' style='display:block' >Unescaped model attribute near line 13: render_partial(&quot;tasks/task_list&quot;, &quot;my_div_id&quot; =&gt; &quot;lead_tasks_...</span><span id='full_message403' style='display:none'>Unescaped model attribute near line 13: render_partial(&quot;tasks/task_list&quot;, &quot;my_div_id&quot; =&gt; &quot;lead_tasks_page_tasks_list&quot;, &quot;task_list_style&quot; =&gt; &quot;background-color: red;&quot;, &quot;task_list_interior_style&quot; =&gt; &quot;background-color: yellow;&quot;, &quot;flavors_category&quot; =&gt; &quot;category_lead&quot;, &quot;selected_flavor&quot; =&gt; &quot;SendemailTask&quot;, &quot;tasks_divs&quot; =&gt; (<span class="user_input">DnTask.find(:all).select</span> do  ((local t).parameters[&quot;lead_id&quot;].to_i == Lead.find(params[:lead_id]).id)  end.map do  [(local e), get_autoincrement_div_id]  end), &quot;stringified_default_params&quot; =&gt; (Configurable.hash_to_string(&quot;SendemailTask&quot; =&gt; ({ &quot;task_params&quot; =&gt; ({ &quot;lead_id&quot; =&gt; (Lead.find(params[:lead_id]).id.to_s), &quot;to&quot; =&gt; (Lead.find(params[:lead_id]).contact_email), &quot;quote_id&quot; =&gt; (Lead.find(params[:lead_id]).quotes.sort_by do  (local q).id  end.reverse[0].id.to_s), &quot;user_id&quot; =&gt; (session[:user].id.to_s) }) }), &quot;PhonecallTask&quot; =&gt; ({ &quot;task_params&quot; =&gt; ({ &quot;lead_id&quot; =&gt; (Lead.find(params[:lead_id]).id.to_s), &quot;first_number&quot; =&gt; (Lead.find(params[:lead_id]).phone1), &quot;second_number&quot; =&gt; (Lead.find(params[:lead_id]).phone2) }) }))))</span><table id='context403' class='context' style='display:none'><caption>app/views/tasks/tasks_for_lead.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>8</pre>
          </td>
          <td class='context'>
            <pre class='context'>		'my_div_id' =&gt; 'lead_tasks_page_tasks_list',</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'task_list_style' =&gt; 'background-color: red;',</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'task_list_interior_style' =&gt; 'background-color: yellow;',</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'flavors_category' =&gt; 'category_lead',</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'selected_flavor' =&gt; 'SendemailTask',</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'tasks_divs' =&gt; @existing_tasks,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>		'stringified_default_params' =&gt; @stringified_default_params</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>%&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        undigestible_emails/index (UndigestibleEmailsController#index)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context404');toggle('message404');toggle('full_message404')" ><span id='message404' style='display:block' >Unescaped model attribute near line 31: render_partial(&quot;undigestible_emails/list&quot;, &quot;ues&quot; =&gt; (Undigest...</span><span id='full_message404' style='display:none'>Unescaped model attribute near line 31: render_partial(&quot;undigestible_emails/list&quot;, &quot;ues&quot; =&gt; (<span class="user_input">UndigestibleEmail.find(:all, :limit =&gt; 50, :offset =&gt; 0, :order =&gt; &quot;created_on DESC&quot;).sort_by</span> do  (local x).created_on  end.reverse), &quot;next_offset&quot; =&gt; 50, &quot;counter_starts_at&quot; =&gt; 1)</span><table id='context404' class='context' style='display:none'><caption>app/views/undigestible_emails/index.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>26</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= submit_tag 'Define Target Set' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= submit_tag 'Delete' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'undigestible_emails/list', 'ues' =&gt; @undigestible_emails.sort_by{|x| x.created_on}.reverse, 'next_offset' =&gt; 50, 'counter_starts_at' =&gt; 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;font color=&quot;grey&quot; size=&quot;1&quot;&gt;with checked:&lt;/font&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        undigestible_emails/show (UndigestibleEmailsController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context405');toggle('message405');toggle('full_message405')" ><span id='message405' style='display:block' >Unescaped model attribute near line 5: render_partial(&quot;undigestible_emails/undigestible_email&quot;, &quot;ue&quot; ...</span><span id='full_message405' style='display:none'>Unescaped model attribute near line 5: render_partial(&quot;undigestible_emails/undigestible_email&quot;, &quot;ue&quot; =&gt; (<span class="user_input">UndigestibleEmail.find(params[:id])</span>), &quot;suppress_checkbox&quot; =&gt; (true), &quot;counter&quot; =&gt; 1)</span><table id='context405' class='context' style='display:none'><caption>app/views/undigestible_emails/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= link_to 'Back to All Undigestible Emails', undigestible_emails_path %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>showing:&lt;br&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'undigestible_emails/undigestible_email', 'ue' =&gt; @undigestible_email, 'suppress_checkbox' =&gt; true, 'counter' =&gt; 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;hr color=&quot;blue&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% @undigestible_email.predivs %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= @undigestible_email.showable_html.gsub(&quot;\r\n&quot;, &quot;&lt;br&gt;&quot;).gsub(&quot;\n&quot;, &quot;&lt;br&gt;&quot;) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/_tasks_events_multiform
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context477');toggle('message477');toggle('full_message477')" ><span id='message477' style='display:block' >Unescaped model attribute near line 28: render_partial(&quot;tasks/new_SendemailTask&quot;, &quot;task&quot; =&gt; (DnTask.i...</span><span id='full_message477' style='display:none'>Unescaped model attribute near line 28: render_partial(&quot;tasks/new_SendemailTask&quot;, &quot;task&quot; =&gt; (<span class="user_input">DnTask.initialized_SendemailTask(lead, session[:user])</span>), &quot;commit_string&quot; =&gt; &quot;Save&quot;, &quot;container_div_id&quot; =&gt; &quot;email_task_form&quot;, &quot;mode&quot; =&gt; &quot;create&quot;)</span><table id='context477' class='context' style='display:none'><caption>app/views/workflow/_tasks_events_multiform.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>23</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;div style=&quot;height: 300px; margin: 30px;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;font color=&quot;red&quot; weight=&quot;bold&quot;&gt;Must generate at least one quote before you can create email tasks&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'tasks/new_SendemailTask', </pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>			'task' =&gt; DnTask.initialized_SendemailTask(lead, session[:user]), 'commit_string' =&gt; 'Save', 'container_div_id' =&gt; 'email_task_form', 'mode' =&gt; 'create' %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;phone_task_form&quot; style=&quot;display: none;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'tasks/new_PhonecallTask', 'task' =&gt; DnTask.initialized_PhonecallTask(lead, session[:user]), 'commit_string' =&gt; 'Save', 'container_div_id' =&gt; 'phone_task_form' %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/_tasks_events_multiform
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context478');toggle('message478');toggle('full_message478')" ><span id='message478' style='display:block' >Unescaped model attribute near line 33: render_partial(&quot;tasks/new_PhonecallTask&quot;, &quot;task&quot; =&gt; (DnTask.i...</span><span id='full_message478' style='display:none'>Unescaped model attribute near line 33: render_partial(&quot;tasks/new_PhonecallTask&quot;, &quot;task&quot; =&gt; (<span class="user_input">DnTask.initialized_PhonecallTask(lead, session[:user])</span>), &quot;commit_string&quot; =&gt; &quot;Save&quot;, &quot;container_div_id&quot; =&gt; &quot;phone_task_form&quot;)</span><table id='context478' class='context' style='display:none'><caption>app/views/workflow/_tasks_events_multiform.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>28</pre>
          </td>
          <td class='context'>
            <pre class='context'>			'task' =&gt; DnTask.initialized_SendemailTask(lead, session[:user]), 'commit_string' =&gt; 'Save', 'container_div_id' =&gt; 'email_task_form', 'mode' =&gt; 'create' %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;phone_task_form&quot; style=&quot;display: none;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= render_partial 'tasks/new_PhonecallTask', 'task' =&gt; DnTask.initialized_PhonecallTask(lead, session[:user]), 'commit_string' =&gt; 'Save', 'container_div_id' =&gt; 'phone_task_form' %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;sms_task_form&quot; style=&quot;display: none;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% if lead.quotes.size == 0 %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;div style=&quot;height: 300px; margin: 30px;&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/_tasks_events_multiform
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context479');toggle('message479');toggle('full_message479')" ><span id='message479' style='display:block' >Unescaped model attribute near line 43: render_partial(&quot;tasks/new_SmsTask&quot;, &quot;task&quot; =&gt; (DnTask.initial...</span><span id='full_message479' style='display:none'>Unescaped model attribute near line 43: render_partial(&quot;tasks/new_SmsTask&quot;, &quot;task&quot; =&gt; (<span class="user_input">DnTask.initialized_SmsTask(lead, session[:user])</span>), &quot;commit_string&quot; =&gt; &quot;Save&quot;, &quot;container_div_id&quot; =&gt; &quot;sms_task_form&quot;, &quot;mode&quot; =&gt; &quot;create&quot;)</span><table id='context479' class='context' style='display:none'><caption>app/views/workflow/_tasks_events_multiform.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>			&lt;div style=&quot;height: 300px; margin: 30px;&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;font color=&quot;red&quot; weight=&quot;bold&quot;&gt;Must generate at least one quote before you can create email tasks&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;%= render_partial 'tasks/new_SmsTask', </pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>				'task' =&gt; DnTask.initialized_SmsTask(lead, session[:user]), 'commit_string' =&gt; 'Save', 'container_div_id' =&gt; 'sms_task_form', 'mode' =&gt; 'create' %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context411');toggle('message411');toggle('full_message411')" ><span id='message411' style='display:block' >Unescaped model attribute near line 10: Lead.find(:all, :conditions =&gt; (&quot;appears_on_dashboard_high_at...</span><span id='full_message411' style='display:none'>Unescaped model attribute near line 10: <span class="user_input">Lead.find(:all, :conditions =&gt; (&quot;appears_on_dashboard_high_at &lt; #{(Time.now + Configurable.get_config_value(&quot;workflow&quot;, &quot;dashboard_cutoff_hours_in_future&quot;).hours).to_i}&quot;)).size</span></span><table id='context411' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;b&gt;(Dashboard for &lt;font size=&quot;3&quot;&gt;&lt;u&gt;&lt;% if @user.nil? %&gt;all users&lt;% else %&gt;&lt;%= @user.login %&gt;&lt;% end %&gt;&lt;/u&gt;&lt;/font&gt;)&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;b&gt;&lt;font color=&quot;red&quot; size=&quot;5&quot;&gt;&lt;%= @new_leads.size %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;red&quot;&gt;New&lt;/font&gt;, &lt;b&gt;&lt;font color=&quot;blue&quot; size=&quot;5&quot;&gt;&lt;%= @high_leads_total %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;blue&quot;&gt;High&lt;/font&gt;, &lt;b&gt;&lt;font color=&quot;grey&quot; size=&quot;5&quot;&gt;&lt;%= @low_leads_total %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;grey&quot;&gt;Low&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;div style=&quot;width: 100%; align: right;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= form_tag &quot;/dashboard&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>					See Dashboard For: &lt;%= select_tag &quot;user_id&quot;, options_for_select(User.find(:all).map{|x| [x.firstname, x.id]}, session[:user].id) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context412');toggle('message412');toggle('full_message412')" ><span id='message412' style='display:block' >Unescaped model attribute near line 10: Lead.find(:all, :conditions =&gt; (&quot;appears_on_dashboard_low_at ...</span><span id='full_message412' style='display:none'>Unescaped model attribute near line 10: <span class="user_input">Lead.find(:all, :conditions =&gt; (&quot;appears_on_dashboard_low_at &lt; #{(Time.now + Configurable.get_config_value(&quot;workflow&quot;, &quot;dashboard_cutoff_hours_in_future&quot;).hours).to_i}&quot;)).size</span></span><table id='context412' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>	&lt;tr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;b&gt;(Dashboard for &lt;font size=&quot;3&quot;&gt;&lt;u&gt;&lt;% if @user.nil? %&gt;all users&lt;% else %&gt;&lt;%= @user.login %&gt;&lt;% end %&gt;&lt;/u&gt;&lt;/font&gt;)&lt;/b&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;b&gt;&lt;font color=&quot;red&quot; size=&quot;5&quot;&gt;&lt;%= @new_leads.size %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;red&quot;&gt;New&lt;/font&gt;, &lt;b&gt;&lt;font color=&quot;blue&quot; size=&quot;5&quot;&gt;&lt;%= @high_leads_total %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;blue&quot;&gt;High&lt;/font&gt;, &lt;b&gt;&lt;font color=&quot;grey&quot; size=&quot;5&quot;&gt;&lt;%= @low_leads_total %&gt;&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot;grey&quot;&gt;Low&lt;/font&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;div style=&quot;width: 100%; align: right;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;%= form_tag &quot;/dashboard&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>					See Dashboard For: &lt;%= select_tag &quot;user_id&quot;, options_for_select(User.find(:all).map{|x| [x.firstname, x.id]}, session[:user].id) %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context414');toggle('message414');toggle('full_message414')" ><span id='message414' style='display:block' >Unescaped model attribute near line 41: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lea...</span><span id='full_message414' style='display:none'>Unescaped model attribute near line 41: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;lead_counter&quot; =&gt; 0, &quot;tasks_div_display&quot; =&gt; &quot;none&quot;, &quot;tasks&quot; =&gt; ((local lead).tasks.select do  ((local x).status.!=(&quot;complete&quot;) and ((local x).assigned_to_id == <span class="user_input">Configurable.get_config_value(&quot;workflow&quot;, &quot;special_user_id_new&quot;)</span>))  end), &quot;divcolor&quot; =&gt; &quot;#f44&quot;, &quot;checkout_initials&quot; =&gt; (User.checkout_lists[1][User.checkout_lists[0].index((local lead).id)]), &quot;hotness_display_threshold&quot; =&gt; (Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]))</span><table id='context414' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>36</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div id=&quot;new_leads&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;%= render_partial 'leads/lead_with_tasks_header'%&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for lead in @new_leads.sort_by{|x| x.smart_email_date}.reverse %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% if @checkout_ids.include?(lead.id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; 'none', 'tasks' =&gt;  lead.tasks.select{|x| x.status != 'complete' and x.assigned_to_id == @special_user_id_new }, 'divcolor' =&gt; &quot;#f44&quot;, 'checkout_initials' =&gt;  @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; 'none', 'tasks' =&gt; lead.tasks.select{|x| x.status != 'complete' and x.assigned_to_id == @special_user_id_new }, 'divcolor' =&gt; &quot;#f44&quot;, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context415');toggle('message415');toggle('full_message415')" ><span id='message415' style='display:block' >Unescaped model attribute near line 45: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lea...</span><span id='full_message415' style='display:none'>Unescaped model attribute near line 45: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;lead_counter&quot; =&gt; 0, &quot;tasks_div_display&quot; =&gt; &quot;none&quot;, &quot;tasks&quot; =&gt; ((local lead).tasks.select do  ((local x).status.!=(&quot;complete&quot;) and ((local x).assigned_to_id == <span class="user_input">Configurable.get_config_value(&quot;workflow&quot;, &quot;special_user_id_new&quot;)</span>))  end), &quot;divcolor&quot; =&gt; &quot;#f44&quot;, &quot;checkout_initials&quot; =&gt; (nil), &quot;hotness_display_threshold&quot; =&gt; (Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]))</span><table id='context415' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>41</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; 'none', 'tasks' =&gt;  lead.tasks.select{|x| x.status != 'complete' and x.assigned_to_id == @special_user_id_new }, 'divcolor' =&gt; &quot;#f44&quot;, 'checkout_initials' =&gt;  @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; 'none', 'tasks' =&gt; lead.tasks.select{|x| x.status != 'complete' and x.assigned_to_id == @special_user_id_new }, 'divcolor' =&gt; &quot;#f44&quot;, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% counter += 1 %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context417');toggle('message417');toggle('full_message417')" ><span id='message417' style='display:block' >Unescaped model attribute near line 67: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lea...</span><span id='full_message417' style='display:none'>Unescaped model attribute near line 67: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;lead_counter&quot; =&gt; 1, &quot;tasks_div_display&quot; =&gt; &quot;&quot;, &quot;tasks&quot; =&gt; ((local lead).tasks.select do  ((local x).status.!=(&quot;complete&quot;) and (((local x).priority == 2) and (((local x).start_time.to_i &lt; (Time.now + Configurable.get_config_value(&quot;workflow&quot;, &quot;dashboard_cutoff_hours_in_future&quot;).hours).to_i) and ([User.find(params[:user_id]).id, Configurable.get_config_value(&quot;workflow&quot;, &quot;special_user_id_vanessa&quot;)] or User.find(:all).map do  (local x).id  end).include?((local x).assigned_to_id.to_i))))  end), &quot;divcolor&quot; =&gt; &quot;#36f&quot;, &quot;checkout_initials&quot; =&gt; (<span class="user_input">User.checkout_lists[1]</span>[User.checkout_lists[0].index((local lead).id)]), &quot;hotness_display_threshold&quot; =&gt; (Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]), &quot;user_ids&quot; =&gt; (([User.find(params[:user_id]).id, Configurable.get_config_value(&quot;workflow&quot;, &quot;special_user_id_vanessa&quot;)] or User.find(:all).map do  (local x).id  end)))</span><table id='context417' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>62</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;% htasks = lead.tasks.select{|x| x.status != 'complete' and x.priority == 2 and x.start_time.to_i &lt; @cutoff_time and @user_ids.include?(x.assigned_to_id.to_i) } %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>	  &lt;% if !htasks.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% if !htasks[0].nil?%&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;% if @checkout_ids.include?(lead.id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; '', 'tasks' =&gt; htasks, 'divcolor' =&gt; &quot;#36f&quot;, 'checkout_initials' =&gt;  @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold, 'user_ids' =&gt; @user_ids %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; '', 'tasks' =&gt; htasks, 'divcolor' =&gt; &quot;#36f&quot;, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold, 'user_ids' =&gt; @user_ids %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context418');toggle('message418');toggle('full_message418')" ><span id='message418' style='display:block' >Unescaped model attribute near line 71: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lea...</span><span id='full_message418' style='display:none'>Unescaped model attribute near line 71: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;lead_counter&quot; =&gt; 1, &quot;tasks_div_display&quot; =&gt; &quot;&quot;, &quot;tasks&quot; =&gt; ((local lead).tasks.select do  ((local x).status.!=(&quot;complete&quot;) and (((local x).priority == 2) and (((local x).start_time.to_i &lt; (Time.now + Configurable.get_config_value(&quot;workflow&quot;, &quot;dashboard_cutoff_hours_in_future&quot;).hours).to_i) and ([User.find(params[:user_id]).id, Configurable.get_config_value(&quot;workflow&quot;, &quot;special_user_id_vanessa&quot;)] or User.find(:all).map do  (local x).id  end).include?((local x).assigned_to_id.to_i))))  end), &quot;divcolor&quot; =&gt; &quot;#36f&quot;, &quot;checkout_initials&quot; =&gt; (nil), &quot;hotness_display_threshold&quot; =&gt; (<span class="user_input">Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]</span>), &quot;user_ids&quot; =&gt; (([User.find(params[:user_id]).id, Configurable.get_config_value(&quot;workflow&quot;, &quot;special_user_id_vanessa&quot;)] or User.find(:all).map do  (local x).id  end)))</span><table id='context418' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>67</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; '', 'tasks' =&gt; htasks, 'divcolor' =&gt; &quot;#36f&quot;, 'checkout_initials' =&gt;  @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold, 'user_ids' =&gt; @user_ids %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; '', 'tasks' =&gt; htasks, 'divcolor' =&gt; &quot;#36f&quot;, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold, 'user_ids' =&gt; @user_ids %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% counter += 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context420');toggle('message420');toggle('full_message420')" ><span id='message420' style='display:block' >Unescaped model attribute near line 109: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local le...</span><span id='full_message420' style='display:none'>Unescaped model attribute near line 109: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;lead_counter&quot; =&gt; ((1 or 2)), &quot;tasks_div_display&quot; =&gt; &quot;none&quot;, &quot;tasks&quot; =&gt; (nil), &quot;divcolor&quot; =&gt; &quot;#999&quot;, &quot;checkout_initials&quot; =&gt; (<span class="user_input">User.checkout_lists[1]</span>[User.checkout_lists[0].index((local lead).id)]), &quot;hotness_display_threshold&quot; =&gt; (Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]), &quot;type&quot; =&gt; &quot;low&quot;, &quot;param_user_id&quot; =&gt; (params[:user_id]))</span><table id='context420' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>104</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;%= render_partial 'leads/lead_with_tasks_header'%&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% for lead in @low_leads.sort_by{|x| x.appears_on_dashboard_low_at}.reverse %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% if @checkout_ids.include?(lead.id) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; 'none', 'tasks' =&gt; nil, 'divcolor' =&gt; &quot;#999&quot;, 'checkout_initials' =&gt;  @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold, 'type' =&gt; 'low', 'param_user_id' =&gt; @param_user_id %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; 'none', 'tasks' =&gt; nil, 'divcolor' =&gt; &quot;#999&quot;, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold, 'type' =&gt; 'low', 'param_user_id' =&gt; @param_user_id %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        workflow/dashboard (WorkflowController#dashboard)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross Site Scripting</a></td>
    <td><div class='warning_message' onClick="toggle('context421');toggle('message421');toggle('full_message421')" ><span id='message421' style='display:block' >Unescaped model attribute near line 113: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local le...</span><span id='full_message421' style='display:none'>Unescaped model attribute near line 113: render_partial(&quot;leads/lead_with_tasks&quot;, &quot;lead&quot; =&gt; ((local lead)), &quot;lead_counter&quot; =&gt; ((1 or 2)), &quot;tasks_div_display&quot; =&gt; &quot;none&quot;, &quot;tasks&quot; =&gt; (nil), &quot;divcolor&quot; =&gt; &quot;#999&quot;, &quot;checkout_initials&quot; =&gt; (nil), &quot;hotness_display_threshold&quot; =&gt; (<span class="user_input">Configurable.get_hash_by_name(&quot;workflow&quot;)[&quot;hotness_display_threshold&quot;]</span>), &quot;type&quot; =&gt; &quot;low&quot;, &quot;param_user_id&quot; =&gt; (params[:user_id]))</span><table id='context421' class='context' style='display:none'><caption>app/views/workflow/dashboard.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>109</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; 'none', 'tasks' =&gt; nil, 'divcolor' =&gt; &quot;#999&quot;, 'checkout_initials' =&gt;  @checkout_initials[@checkout_ids.index(lead.id)], 'hotness_display_threshold' =&gt; @hotness_display_threshold, 'type' =&gt; 'low', 'param_user_id' =&gt; @param_user_id %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;%= render_partial 'leads/lead_with_tasks', 'lead' =&gt; lead, 'lead_counter' =&gt; counter, 'tasks_div_display' =&gt; 'none', 'tasks' =&gt; nil, 'divcolor' =&gt; &quot;#999&quot;, 'checkout_initials' =&gt; nil, 'hotness_display_threshold' =&gt; @hotness_display_threshold, 'type' =&gt; 'low', 'param_user_id' =&gt; @param_user_id %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>117</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% counter += 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        lead_companies/show (LeadCompaniesController#show)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
    <td><div class='warning_message' onClick="toggle('context482');toggle('message482');toggle('full_message482')" ><span id='message482' style='display:block' >Unprotected mass assignment near line 32: Microformat.new(:lead_company_id =&gt; (LeadCompany.find(param...</span><span id='full_message482' style='display:none'>Unprotected mass assignment near line 32: Microformat.new(:lead_company_id =&gt; (<span class="user_input">LeadCompany.find(params[:id], :include =&gt; &quot;microformats&quot;).id</span>))</span><table id='context482' class='context' style='display:none'><caption>app/views/lead_companies/show.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>27</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;% end %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>Create new microformat: </pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% @microformat = Microformat.new(:lead_company_id =&gt; @lead_company.id ) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% form_for(:microformat, :url =&gt; microformats_path) do |f| %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;%= f.hidden_field :lead_company_id %&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        conditions/test
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context488');toggle('message488');toggle('full_message488')" ><span id='message488' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 27: Lead.fin...</span><span id='full_message488' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 27: Lead.find(:all, :limit =&gt; 100, :order =&gt; &quot;created_on DESC&quot;)</span><table id='context488' class='context' style='display:none'><caption>app/views/conditions/test.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>22</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th&gt;origin&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;destination&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;condition matches?&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for lead in Lead.find(:all, :limit =&gt; 100, :order =&gt; &quot;created_on DESC&quot;) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= lead.fullname %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= lead.id %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= pretty_date(lead.move_date) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        conditions/test (ConditionsController#test)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context483');toggle('message483');toggle('full_message483')" ><span id='message483' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 27: Lead.fin...</span><span id='full_message483' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 27: Lead.find(:all, :limit =&gt; 100, :order =&gt; &quot;created_on DESC&quot;)</span><table id='context483' class='context' style='display:none'><caption>app/views/conditions/test.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>22</pre>
          </td>
          <td class='context'>
            <pre class='context'>		&lt;th&gt;origin&lt;/th&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;destination&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;th&gt;condition matches?&lt;/th&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;/tr&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for lead in Lead.find(:all, :limit =&gt; 100, :order =&gt; &quot;created_on DESC&quot;) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= lead.fullname %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= lead.id %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= pretty_date(lead.move_date) %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        extractors/edit
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context489');toggle('message489');toggle('full_message489')" ><span id='message489' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 98: DnEmail....</span><span id='full_message489' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 98: DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 5)</span><table id='context489' class='context' style='display:none'><caption>app/views/extractors/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>94</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;/div&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;undigestible_target_set&quot; style=&quot;display: none; width: 850px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for x in DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 5) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td&gt;&lt;%= render_partial 'dn_emails/dn_email_in_received', 'dne' =&gt; x %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        extractors/edit (ExtractorsController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context484');toggle('message484');toggle('full_message484')" ><span id='message484' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 98: DnEmail....</span><span id='full_message484' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 98: DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 5)</span><table id='context484' class='context' style='display:none'><caption>app/views/extractors/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>94</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;/div&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;undigestible_target_set&quot; style=&quot;display: none; width: 850px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for x in DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 5) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td&gt;&lt;%= render_partial 'dn_emails/dn_email_in_received', 'dne' =&gt; x %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        extractors/edit (ExtractorsController#update)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context485');toggle('message485');toggle('full_message485')" ><span id='message485' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 98: DnEmail....</span><span id='full_message485' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 98: DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 5)</span><table id='context485' class='context' style='display:none'><caption>app/views/extractors/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>94</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;/div&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;undigestible_target_set&quot; style=&quot;display: none; width: 850px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for x in DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 5) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;table&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td&gt;&lt;%= render_partial 'dn_emails/dn_email_in_received', 'dne' =&gt; x %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>				&lt;td valign=&quot;top&quot;&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/edit
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context490');toggle('message490');toggle('full_message490')" ><span id='message490' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 66: DnEmail....</span><span id='full_message490' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 66: DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 100)</span><table id='context490' class='context' style='display:none'><caption>app/views/signatures/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>61</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;/div&gt;&lt;!-- id = signature_edit --&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;undigestible_target_set&quot; style=&quot;display: none; width: 850px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for x in DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 100) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;table&gt;&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= render_partial 'dn_emails/dn_email_in_received', 'dne' =&gt; x %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/edit (SignaturesController#edit)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context486');toggle('message486');toggle('full_message486')" ><span id='message486' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 66: DnEmail....</span><span id='full_message486' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 66: DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 100)</span><table id='context486' class='context' style='display:none'><caption>app/views/signatures/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>61</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;/div&gt;&lt;!-- id = signature_edit --&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;undigestible_target_set&quot; style=&quot;display: none; width: 850px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for x in DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 100) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;table&gt;&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= render_partial 'dn_emails/dn_email_in_received', 'dne' =&gt; x %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

  <tr>
    <td><span class='weak-confidence'>Weak</span></td>
    <td>
      
        signatures/edit (SignaturesController#update)
      
    </td>
    <td><a href="http://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
    <td><div class='warning_message' onClick="toggle('context487');toggle('message487');toggle('full_message487')" ><span id='message487' style='display:block' >Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 66: DnEmail....</span><span id='full_message487' style='display:none'>Upgrade to Rails &gt;= 2.1.2 to escape :limit and :offset. Possible SQL injection near line 66: DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 100)</span><table id='context487' class='context' style='display:none'><caption>app/views/signatures/edit.rhtml</caption>        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>61</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;/div&gt;&lt;!-- id = signature_edit --&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;div id=&quot;undigestible_target_set&quot; style=&quot;display: none; width: 850px;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;hr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>	&lt;% for x in DnEmail.find(:all, :conditions =&gt; &quot;is_in_target_set = 1&quot;, :limit =&gt; 100) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;table&gt;&lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>			&lt;td&gt;&lt;%= render_partial 'dn_emails/dn_email_in_received', 'dne' =&gt; x %&gt;&lt;/td&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>		&lt;/tr&gt;&lt;/table&gt;</pre>
            </td>
          </tr>
</table></div></td>
  </tr>

</table>
</body></html>